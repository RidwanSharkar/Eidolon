(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{2022:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(1574)}])},1574:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>eg});var n=r(4848),o=r(8875),s=r(3968),i=r(6540),a=r(9437),l=r(4797);function c(){let e=(0,i.useRef)(null),t=(0,i.useRef)(null),r=new a.ShaderMaterial({uniforms:{time:{value:0},scale:{value:20},elevation:{value:.2},groundScale:{value:.1}},vertexShader:"\n      varying vec2 vUv;\n      varying vec3 vNormal;\n      \n      void main() {\n        vUv = uv;\n        vNormal = normal;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n      }\n    ",fragmentShader:"\n      uniform float time;\n      uniform float scale;\n      uniform float elevation;\n      uniform float groundScale;\n      \n      varying vec2 vUv;\n      varying vec3 vNormal;\n      \n      // Simplex noise function\n      vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }\n      vec2 mod289(vec2 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }\n      vec3 permute(vec3 x) { return mod289(((x*34.0)+1.0)*x); }\n      \n      float snoise(vec2 v) {\n        const vec4 C = vec4(0.211324865405187,\n                           0.366025403784439,\n                          -0.577350269189626,\n                           0.024390243902439);\n        vec2 i  = floor(v + dot(v, C.yy) );\n        vec2 x0 = v -   i + dot(i, C.xx);\n        vec2 i1;\n        i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n        vec4 x12 = x0.xyxy + C.xxzz;\n        x12.xy -= i1;\n        i = mod289(i);\n        vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n                         + i.x + vec3(0.0, i1.x, 1.0 ));\n        vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n        m = m*m ;\n        m = m*m ;\n        vec3 x = 2.0 * fract(p * C.www) - 1.0;\n        vec3 h = abs(x) - 0.5;\n        vec3 ox = floor(x + 0.5);\n        vec3 a0 = x - ox;\n        m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n        vec3 g;\n        g.x  = a0.x  * x0.x  + h.x  * x0.y;\n        g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n        return 130.0 * dot(m, g);\n      }\n      \n      void main() {\n        // Create large distinct patches\n        vec2 groundUv = vUv * groundScale;\n        float groundPattern = snoise(groundUv);\n        \n        // Create snow texture for detail\n        vec2 uv = vUv * scale;\n        float n = snoise(uv) * 0.5;\n        n += snoise(uv * 2.0) * 0.25;\n        n += snoise(uv * 4.0) * 0.125;\n        n += snoise(uv * 8.0) * 0.0625;\n        \n        // Sparkle effect\n        float sparkle = pow(max(0.0, snoise(uv * 20.0 + time * 0.1)), 20.0) * 0.3;\n        \n        // Create blight glow spots\n        float blightSpots = pow(max(0.0, snoise(uv * 8.0 + time * 0.05)), 8.0) * 0.15;\n        \n        // Colors\n        vec3 snowColor = vec3(0.92, 0.93, 0.95);\n        vec3 blightColor = vec3(0.25, 0.22, 0.20); // Slightly browner tone, was (0.15, 0.13, 0.12)\n        vec3 glowColor = vec3(0.3, 0.8, 0.2); // Keeping the same sickly green glow\n        \n        // Create sharp transitions between snow and ground\n        float blend = smoothstep(0.0, 0.1, groundPattern);\n        vec3 finalColor = mix(snowColor, blightColor, blend);\n        \n        // Add green glow spots only to blighted areas\n        float blightAmount = blend;\n        finalColor += glowColor * blightSpots * blightAmount;\n        \n        // Add snow effects only to snow areas\n        float snowAmount = 1.0 - blend;\n        float shadow = smoothstep(-1.0, 1.0, n) * 0.2;\n        finalColor = mix(finalColor, finalColor * 1.15, shadow * snowAmount);\n        finalColor += vec3(sparkle * snowAmount);\n        \n        gl_FragColor = vec4(finalColor, 1.0);\n      }\n    ",side:a.DoubleSide});(0,l.F)(e=>{let{clock:t}=e;r.uniforms.time.value=t.getElapsedTime()});let o=new a.Shape;for(let e=0;e<8;e++){let t=e/8*Math.PI*2,r=50*Math.cos(t),n=50*Math.sin(t);0===e?o.moveTo(r,n):o.lineTo(r,n)}return o.closePath(),(0,i.useEffect)(()=>{if(t.current){let e=new a.Matrix4;for(let r=0;r<200;r++){let n=Math.random()*Math.PI*2,o=45*Math.random(),s=o*Math.cos(n),i=o*Math.sin(n),l=.1+.15*Math.random(),c=Math.random()*Math.PI*2;e.compose(new a.Vector3(s,.01,i),new a.Quaternion().setFromEuler(new a.Euler(.3*Math.random(),c,.3*Math.random())),new a.Vector3(l,l,l)),t.current.setMatrixAt(r,e)}t.current.instanceMatrix.needsUpdate=!0}},[]),(0,n.jsxs)("group",{children:[(0,n.jsxs)("mesh",{ref:e,rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[(0,n.jsx)("shapeGeometry",{args:[o]}),(0,n.jsx)("primitive",{object:r,attach:"material"})]}),(0,n.jsxs)("instancedMesh",{ref:t,args:[void 0,void 0,200],castShadow:!0,receiveShadow:!0,children:[(0,n.jsx)("cylinderGeometry",{args:[.02,.02,.3,4]}),(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.7,metalness:.2,emissive:"#304050",emissiveIntensity:.1})]}),(0,n.jsxs)("mesh",{position:[0,.1,0],rotation:[-Math.PI/2,0,0],children:[(0,n.jsx)("planeGeometry",{args:[100,100]}),(0,n.jsx)("meshStandardMaterial",{transparent:!0,opacity:.4,color:"#b8c6db",fog:!0,depthWrite:!1,blending:a.AdditiveBlending})]}),(0,n.jsx)("pointLight",{position:[0,.1,0],color:"#304050",intensity:.5,distance:10,decay:2})]})}let h=e=>{let{position:t,scale:r=1,isInteractive:o=!1,health:s=100}=e,a=(0,i.useRef)(null);return((0,i.useEffect)(()=>{if(o&&s<=0&&a.current){var e;null===(e=a.current.parent)||void 0===e||e.remove(a.current)}},[s,o]),o&&s<=0)?null:(0,n.jsxs)("group",{name:"mountain",position:t,scale:r,children:[(0,n.jsxs)("mesh",{ref:a,castShadow:!0,receiveShadow:!0,children:[(0,n.jsx)("coneGeometry",{args:[23,35,6]}),(0,n.jsx)("meshStandardMaterial",{color:"#2a2a2a",metalness:.1,roughness:.9,emissive:"#222222"})]}),(0,n.jsxs)("mesh",{position:[-4,-5,-2],rotation:[0,.5,.1],castShadow:!0,children:[(0,n.jsx)("coneGeometry",{args:[24,28,5]}),(0,n.jsx)("meshStandardMaterial",{color:"#252525",metalness:.1,roughness:.9})]}),(0,n.jsxs)("mesh",{position:[0,15,0],castShadow:!0,children:[(0,n.jsx)("coneGeometry",{args:[5,8,6]}),(0,n.jsx)("meshStandardMaterial",{color:"#ffffff",metalness:.1,roughness:.6})]}),(0,n.jsxs)("mesh",{position:[-2,10,-1],rotation:[.1,.3,.1],castShadow:!0,children:[(0,n.jsx)("coneGeometry",{args:[3,6,5]}),(0,n.jsx)("meshStandardMaterial",{color:"#f0f0f0",metalness:.1,roughness:.7})]}),(0,n.jsxs)("mesh",{position:[3,5,2],rotation:[.2,-.3,0],castShadow:!0,children:[(0,n.jsx)("coneGeometry",{args:[6,15,4]}),(0,n.jsx)("meshStandardMaterial",{color:"#1f1f1f",metalness:.2,roughness:1})]})]})},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,r=new a.Color(e);return r.r=a.MathUtils.clamp(r.r+(Math.random()-.5)*t,0,1),r.g=a.MathUtils.clamp(r.g+(Math.random()-.5)*t,0,1),r.b=a.MathUtils.clamp(r.b+(Math.random()-.5)*t,0,1),r},u=i.memo(e=>{let{position:t=new a.Vector3(0,2,-5),scale:r=.8,trunkColor:o,leafColor:s}=e,l=(0,i.useMemo)(()=>d(o),[o]),c=(0,i.useMemo)(()=>d(s),[s]),h=.25*r,u=4.2*r,m=1.5*r,f=2*r;return(0,n.jsx)("group",{name:"tree",position:t,scale:r,children:(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[h,1.2*h,u,8]}),(0,n.jsx)("meshStandardMaterial",{color:l,roughness:.8,metalness:.1}),(0,n.jsxs)("mesh",{position:[0,.6*u,0],name:"tree-top",children:[(0,n.jsx)("coneGeometry",{args:[m,f,8]}),(0,n.jsx)("meshStandardMaterial",{color:c,roughness:.8,metalness:.1})]}),(0,n.jsxs)("mesh",{position:[0,.8*u,0],name:"tree-top-2",children:[(0,n.jsx)("coneGeometry",{args:[.7*m,.7*f,8]}),(0,n.jsx)("meshStandardMaterial",{color:c.clone().offsetHSL(0,0,-.1),roughness:.8,metalness:.1})]}),(0,n.jsxs)("mesh",{position:[0,u,0],name:"tree-top-3",children:[(0,n.jsx)("coneGeometry",{args:[.4*m,.4*f,8]}),(0,n.jsx)("meshStandardMaterial",{color:c.clone().offsetHSL(0,0,-.15),roughness:.8,metalness:.1})]})]})})}),m=e=>{let{position:t,scale:r}=e,o=(0,i.useRef)(null);return(0,l.F)(e=>{o.current&&(o.current.position.y=t.y+.05*Math.sin(e.clock.getElapsedTime()))}),(0,n.jsxs)("group",{position:t,scale:r,children:[(0,n.jsxs)("mesh",{ref:o,children:[(0,n.jsx)("cylinderGeometry",{args:[.05,.05,.6,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#d66a95"})]}),(0,n.jsxs)("mesh",{position:[0,.35,0],children:[(0,n.jsx)("coneGeometry",{args:[.2,.3,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#d66a95"})]})]})},f=e=>{let{color:t,size:r,meshRef:o,opacity:s=1}=e,c=(0,i.useRef)(null),h=(0,i.useRef)(new Float32Array(90)),d=(0,i.useRef)(new Float32Array(30)),u=(0,i.useRef)(new Float32Array(30)),m=(0,i.useRef)(!1);return(0,i.useEffect)(()=>{if(o.current&&!m.current){let{x:e,y:t,z:r}=o.current.position;for(let n=0;n<30;n++)h.current[3*n]=e,h.current[3*n+1]=t,h.current[3*n+2]=r,d.current[n]=0,u.current[n]=0;m.current=!0}},[o]),(0,l.F)(()=>{var e;if(!(null===(e=c.current)||void 0===e?void 0:e.parent)||!o.current||!m.current)return;let{x:t,y:n,z:i}=o.current.position;for(let e=29;e>0;e--)h.current[3*e]=h.current[(e-1)*3],h.current[3*e+1]=h.current[(e-1)*3+1],h.current[3*e+2]=h.current[(e-1)*3+2],d.current[e]=.5*Math.pow(1-e/30,2)*s,u.current[e]=.8*r*Math.pow(1-e/30,.5);if(h.current[0]=t,h.current[1]=n,h.current[2]=i,d.current[0]=.6*s,u.current[0]=1.2*r,c.current){let e=c.current.geometry;e.attributes.position.array=h.current,e.attributes.position.needsUpdate=!0,e.attributes.opacity&&(e.attributes.opacity.array=d.current,e.attributes.opacity.needsUpdate=!0),e.attributes.scale&&(e.attributes.scale.array=u.current,e.attributes.scale.needsUpdate=!0)}}),(0,n.jsxs)("points",{ref:c,children:[(0,n.jsxs)("bufferGeometry",{children:[(0,n.jsx)("bufferAttribute",{attach:"attributes-position",count:30,array:h.current,itemSize:3}),(0,n.jsx)("bufferAttribute",{attach:"attributes-opacity",count:30,array:d.current,itemSize:1}),(0,n.jsx)("bufferAttribute",{attach:"attributes-scale",count:30,array:u.current,itemSize:1})]}),(0,n.jsx)("shaderMaterial",{transparent:!0,depthWrite:!1,blending:a.AdditiveBlending,vertexShader:"\n          attribute float opacity;\n          attribute float scale;\n          varying float vOpacity;\n          void main() {\n            vOpacity = opacity;\n            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n            gl_Position = projectionMatrix * mvPosition;\n            gl_PointSize = scale * 20.0 * (300.0 / -mvPosition.z);\n          }\n        ",fragmentShader:"\n          varying float vOpacity;\n          uniform vec3 uColor;\n          void main() {\n            float d = length(gl_PointCoord - vec2(0.5));\n            float strength = smoothstep(0.5, 0.1, d);\n            vec3 glowColor = mix(uColor, vec3(1.0), 0.4);\n            gl_FragColor = vec4(glowColor, vOpacity * strength);\n          }\n        ",uniforms:{uColor:{value:t}}})]})};function p(e){let{position:t,direction:r,onImpact:o}=e,s=(0,i.useRef)(null),c=(0,i.useRef)(new a.Clock),h=(0,i.useRef)(t.clone()),{scene:d}=(0,l.D)(),u=new a.Color("#00ff44"),m=e=>{let t=new a.Raycaster,r=e.clone().sub(h.current).normalize();t.set(h.current,r);let n=d.children.filter(e=>"mountain"===e.name&&e instanceof a.Group||"tree"===e.name&&e instanceof a.Group).flatMap(e=>{let t=[];return e.traverse(e=>{e instanceof a.Mesh&&t.push(e)}),t}),o=t.intersectObjects(n,!0);if(o.length>0){let t=o[0],r=h.current.distanceTo(e);if(t.distance<=r)return console.log("Collision detected:",t.point),!0}return!1};return(0,l.F)((e,t)=>{if(!s.current)return;if(c.current.getElapsedTime()>10){s.current.removeFromParent();return}let n=r.clone().multiplyScalar(.5*t*60),i=h.current.clone().add(n);m(i)?(s.current&&s.current.removeFromParent(),o()):(h.current.copy(i),s.current.position.copy(h.current))}),(0,n.jsxs)("group",{name:"fireball-group",children:[(0,n.jsxs)("mesh",{ref:s,position:h.current,children:[(0,n.jsx)("sphereGeometry",{args:[.3,32,32]}),(0,n.jsx)("meshStandardMaterial",{emissive:u,emissiveIntensity:2,toneMapped:!1}),(0,n.jsx)("pointLight",{color:u,intensity:8,distance:12})]}),(0,n.jsx)(f,{color:u,size:.3,meshRef:s,opacity:1})]})}function x(e){let{isSwinging:t,onSwingComplete:r}=e,o=(0,i.useRef)(null),s=(0,i.useRef)(0);(0,l.F)((e,n)=>{if(t&&o.current){s.current+=7*n;let e=Math.min(s.current/Math.PI,1),t=-1.33+3*Math.sin(e*Math.PI),i=1.25+-1.5*Math.sin(e*Math.PI),a=.75+1.5*Math.cos(e*Math.PI);o.current.position.set(t,i,a);let l=Math.PI/4*Math.sin(e*Math.PI*.7),c=Math.PI/1.5*Math.sin(e*Math.PI),h=Math.PI/4*Math.sin(e*Math.PI*.8);o.current.rotation.set(l,c,h),s.current>=Math.PI&&(s.current=0,o.current.rotation.set(0,0,0),o.current.position.set(-1.33,1.25,.75),r())}else!t&&o.current&&(o.current.rotation.x*=.85,o.current.rotation.y*=.85,o.current.rotation.z*=.85,o.current.position.x+=(-1.33-o.current.position.x)*.2,o.current.position.y+=(1.25-o.current.position.y)*.2,o.current.position.z+=(.75-o.current.position.z)*.2)});let c=()=>{let e=new a.Shape;return e.moveTo(0,0),e.lineTo(.2,.05),e.bezierCurveTo(.7,.2,1.35,.6,1.55,.5),e.lineTo(1.125,1.125),e.bezierCurveTo(.7,.4,.3,.15,.4,.75),e.lineTo(0,0),e},h={steps:1,depth:.02,bevelEnabled:!0,bevelThickness:.01,bevelSize:.01,bevelSegments:3};return(0,n.jsxs)("group",{ref:o,position:[-1.33,1.25,.75],rotation:[0,0,Math.PI],scale:[1.1,1.1,1.1],children:[(0,n.jsxs)("group",{position:[0,-.7,0],rotation:[0,0,-Math.PI],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.035,.05,1.5,12]})," ",(0,n.jsx)("meshStandardMaterial",{color:"#2c1810",roughness:.7})]}),[...Array(8)].map((e,t)=>(0,n.jsxs)("mesh",{position:[0,.8-.3*t,0],children:[" ",(0,n.jsx)("torusGeometry",{args:[.06,.01,8,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#8B4513",metalness:.3,roughness:.7})]},t))]}),(0,n.jsxs)("group",{position:[0,.3,0],rotation:[Math.PI/1,0,Math.PI],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.12,.09,.3,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#2c1810",roughness:.6})]}),(0,n.jsx)("group",{"rotation-x":(0,l.F)(e=>2*e.clock.getElapsedTime()),children:(0,n.jsxs)("mesh",{children:[(0,n.jsx)("torusGeometry",{args:[.15,.01,16,32]}),(0,n.jsx)("meshStandardMaterial",{color:"#39ff14",emissive:"#39ff14",emissiveIntensity:2,transparent:!0,opacity:.7})]})}),(0,n.jsx)("group",{"rotation-x":(0,l.F)(e=>-(2*e.clock.getElapsedTime())),children:(0,n.jsxs)("mesh",{"position-y":.1,children:[(0,n.jsx)("torusGeometry",{args:[.13,.01,16,32]}),(0,n.jsx)("meshStandardMaterial",{color:"#39ff14",emissive:"#39ff14",emissiveIntensity:1.5,transparent:!0,opacity:.5})]})}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.14,.11,.32,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#39ff14",emissive:"#39ff14",emissiveIntensity:1,transparent:!0,opacity:.3})]})]}),(0,n.jsxs)("group",{position:[0,.5,1.3],rotation:[-.9,-Math.PI/2,Math.PI/2],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[c(),h]}),(0,n.jsx)("meshStandardMaterial",{color:"#67f2b9",metalness:.9,roughness:.3})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[c(),{...h,depth:.021}]}),(0,n.jsx)("meshStandardMaterial",{color:"#67f2b9",emissive:"#39ff14",emissiveIntensity:2.5,metalness:.9,roughness:.2,opacity:.7,transparent:!0})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[c(),{...h,depth:.022}]}),(0,n.jsx)("meshStandardMaterial",{color:"#39ff14",emissive:"#39ff14",emissiveIntensity:1.5,metalness:.8,roughness:.1,opacity:.3,transparent:!0})]})]})]})}function g(e){let{isSwinging:t,isSmiting:r,onSwingComplete:o,onSmiteComplete:s}=e,c=(0,i.useRef)(null),h=(0,i.useRef)(0),d=(0,i.useRef)(0),u=[-1.33,.75,.75];(0,l.F)((e,n)=>{if(c.current){if(r){let e,t,r,o,i;d.current+=n*(d.current<Math.PI/2?3:6);let a=Math.min(d.current/Math.PI,1);if(a<.5){let n=2*a;e=-Math.PI/3-n*Math.PI/3,t=n*Math.PI/4,r=u[0]+1.5*n,o=u[1]+1.5*n,i=u[2]-1.5*n}else{let n=(a-.5)*2;e=-2*Math.PI/3+3*n*Math.PI/2,t=Math.PI/4*(1-n),r=u[0]+1.5*(1-n),o=u[1]+(1.5-2*n),i=u[2]-(1.5-3*n)}c.current.position.set(r,o,i),c.current.rotation.set(e,t,0),d.current>=Math.PI&&(d.current=0,c.current.rotation.set(0,0,0),c.current.position.set(...u),s());return}if(t){h.current+=7*n;let e=Math.min(h.current/Math.PI,1),t=u[0]+2.5*Math.sin(e*Math.PI),r=u[1]+-1*Math.sin(e*Math.PI),s=u[2]+2*Math.cos(e*Math.PI);c.current.position.set(t,r,s);let i=Math.PI/3*Math.sin(e*Math.PI*.8),a=Math.sin(e*Math.PI)*Math.PI,l=Math.PI/3*Math.sin(e*Math.PI*.9);c.current.rotation.set(i,a,l),h.current>=Math.PI&&(h.current=0,c.current.rotation.set(0,0,0),c.current.position.set(...u),o())}else t||r||(c.current.rotation.x*=.85,c.current.rotation.y*=.85,c.current.rotation.z*=.85,c.current.position.x+=(u[0]-c.current.position.x)*.2,c.current.position.y+=(u[1]-c.current.position.y)*.2,c.current.position.z+=(u[2]-c.current.position.z)*.2)}});let m=()=>{let e=new a.Shape;return e.moveTo(0,0),e.lineTo(-.2,.12),e.lineTo(-.12,-.12),e.lineTo(0,0),e.lineTo(.2,.12),e.lineTo(.12,-.12),e.lineTo(0,0),e.lineTo(0,.1),e.lineTo(.2,.2),e.quadraticCurveTo(1,.15,1.5,.2),e.quadraticCurveTo(2,.12,2.2,0),e.quadraticCurveTo(2,-.12,1.5,-.2),e.quadraticCurveTo(1,-.15,.2,-.2),e.lineTo(0,-.1),e.lineTo(0,0),e},f={steps:2,depth:.04,bevelEnabled:!0,bevelThickness:.01,bevelSize:.02,bevelSegments:3},p={...f,depth:.05,bevelThickness:.01,bevelSize:.01,bevelOffset:0};return(0,n.jsxs)("group",{ref:c,position:[u[0],u[1],u[2]],rotation:[0,0,Math.PI],scale:[1.1,1.1,1.1],children:[(0,n.jsxs)("group",{position:[0,-.4,0],rotation:[0,0,-Math.PI],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.03,.04,.9,12]}),(0,n.jsx)("meshStandardMaterial",{color:"#2a3b4c",roughness:.7})]}),[...Array(8)].map((e,t)=>(0,n.jsxs)("mesh",{position:[0,.35-.13*t,0],children:[(0,n.jsx)("torusGeometry",{args:[.045,.008,8,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#1a2b3c",metalness:.6,roughness:.4})]},t))]}),(0,n.jsxs)("group",{position:[0,.15,0],rotation:[Math.PI,1.5,Math.PI],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("torusGeometry",{args:[.25,.07,16,32]}),(0,n.jsx)("meshStandardMaterial",{color:"#4a5b6c",metalness:.9,roughness:.1})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[.09,16,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff9900",emissive:"#ff8800",emissiveIntensity:30,transparent:!0,opacity:.95})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[.1,16,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff9900",emissive:"#ff8800",emissiveIntensity:25,transparent:!0,opacity:.8})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[.12,16,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff9900",emissive:"#ff8800",emissiveIntensity:20,transparent:!0,opacity:.6})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[.15,16,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff9900",emissive:"#ff8800",emissiveIntensity:15,transparent:!0,opacity:.4})]}),(0,n.jsx)("pointLight",{color:"#ff8800",intensity:4,distance:1.5,decay:2})]}),(0,n.jsxs)("group",{position:[0,.6,0],rotation:[0,-Math.PI/2,Math.PI/2],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[(()=>{let e=new a.Shape;return e.moveTo(0,0),e.lineTo(-.25,.15),e.lineTo(-.15,-.15),e.lineTo(0,0),e.lineTo(.25,.15),e.lineTo(.15,-.15),e.lineTo(0,0),e.lineTo(0,.12),e.lineTo(.25,.25),e.quadraticCurveTo(1,.2,1.5,.25),e.quadraticCurveTo(2,.15,2.2,0),e.quadraticCurveTo(2,-.15,1.5,-.25),e.quadraticCurveTo(1,-.2,.25,-.25),e.lineTo(0,-.12),e.lineTo(0,0),e})(),f]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8e8ff",metalness:.4,roughness:.1})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[m(),p]}),(0,n.jsx)("meshStandardMaterial",{color:"#ffffff",emissive:"#a0d4ff",emissiveIntensity:4,metalness:.2,roughness:.1,opacity:.8,transparent:!0})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[m(),{...p,depth:.06}]}),(0,n.jsx)("meshStandardMaterial",{color:"#ffffff",emissive:"#c0e0ff",emissiveIntensity:3,metalness:.2,roughness:.1,opacity:.4,transparent:!0})]})]})]})}function j(e){let{parentRef:t}=e,r=(0,i.useRef)([]),o=(0,i.useRef)([]),[s,c]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{if(t.current){let e=t.current.position.clone();o.current=Array(12).fill(0).map(()=>e.clone()),c(!0)}},[t]),(0,l.F)(()=>{if(!t.current||!s)return;let e=t.current.position.clone();o.current.unshift(e),o.current=o.current.slice(0,12),r.current.forEach((e,t)=>{e&&o.current[t]&&(e.position.copy(o.current[t]),e.scale.setScalar(1-t/12*.3),e.material&&e.material instanceof a.MeshBasicMaterial&&(e.material.opacity=(1-t/12)*.3))})}),s)?(0,n.jsx)(n.Fragment,{children:Array.from({length:12}).map((e,t)=>(0,n.jsxs)("mesh",{ref:e=>{e&&(r.current[t]=e)},children:[(0,n.jsx)("sphereGeometry",{args:[.5,32,32]}),(0,n.jsx)("meshBasicMaterial",{color:new a.Color("#39ff14"),transparent:!0,opacity:.3,depthWrite:!1})]},t))}):null}let y=(e,t,r)=>e*(1-r)+t*r;function M(e){let{isSwinging:t,onSwingComplete:r,onLeftSwingStart:o,onRightSwingStart:s,isBowCharging:c}=e,h=(0,i.useRef)(null),d=(0,i.useRef)(0),u=(0,i.useRef)(null),m=(0,i.useRef)(0),f=[-.8,.75,.75],p=[.8,.75,.75],x=(0,i.useRef)(0),g=(0,i.useRef)(!1),j=(0,i.useRef)(0);(0,l.F)((e,n)=>{if(h.current&&u.current){if(c)h.current.position.x+=(-.8-h.current.position.x)*.3,h.current.position.y+=(-.2-h.current.position.y)*.3,h.current.position.z+=(.5-h.current.position.z)*.3,u.current.position.x+=(.8-u.current.position.x)*.3,u.current.position.y+=(-.2-u.current.position.y)*.3,u.current.position.z+=(.5-u.current.position.z)*.3,h.current.rotation.x=y(h.current.rotation.x,1.2*Math.PI,.3),h.current.rotation.z=y(h.current.rotation.z,.15*Math.PI,.3),u.current.rotation.x=y(u.current.rotation.x,1.2*Math.PI,.3),u.current.rotation.z=y(u.current.rotation.z,-(.15*Math.PI),.3),d.current=0,m.current=0,j.current=0,x.current=0,g.current=!1;else if(t){if(0===d.current&&0===m.current&&(g.current=!1),h.current){if(j.current<.15)j.current+=n;else{0===d.current&&o(),d.current+=7*n;let e=Math.min(d.current/Math.PI,1),t=f[0]+1.2*Math.sin(e*Math.PI),r=f[1]+-.3*Math.sin(e*Math.PI*2),s=f[2]+2*Math.sin(e*Math.PI);h.current.position.set(t,r,s);let i=.5*Math.PI*Math.sin(e*Math.PI),a=.3*Math.PI*Math.sin(e*Math.PI),l=.2*Math.PI*Math.sin(e*Math.PI);h.current.rotation.set(i,a,l),d.current>=Math.PI&&(d.current=0,j.current=0,h.current.rotation.set(0,0,0),h.current.position.set(...f))}}if(u.current){0===m.current&&s(),m.current+=7*n;let e=Math.min(m.current/Math.PI,1),t=p[0]-1.2*Math.sin(e*Math.PI),o=p[1]+-.3*Math.sin(e*Math.PI*2),i=p[2]+2*Math.sin(e*Math.PI);u.current.position.set(t,o,i);let a=.5*Math.PI*Math.sin(e*Math.PI),l=-(.3*Math.PI*Math.sin(e*Math.PI)),c=-(.2*Math.PI*Math.sin(e*Math.PI));u.current.rotation.set(a,l,c),m.current>=Math.PI&&(m.current=0,x.current=0,u.current.rotation.set(0,0,0),u.current.position.set(...p),g.current=!0,r())}}else h.current.position.x+=(f[0]-h.current.position.x)*.2,h.current.position.y+=(f[1]-h.current.position.y)*.2,h.current.position.z+=(f[2]-h.current.position.z)*.2,u.current.position.x+=(p[0]-u.current.position.x)*.2,u.current.position.y+=(p[1]-u.current.position.y)*.2,u.current.position.z+=(p[2]-u.current.position.z)*.2,h.current.rotation.x*=.85,h.current.rotation.y*=.85,h.current.rotation.z*=.85,u.current.rotation.x*=.85,u.current.rotation.y*=.85,u.current.rotation.z*=.85,t||(d.current=0,m.current=0,j.current=0,x.current=0,g.current=!1)}});let M=()=>{let e=new a.Shape;return e.moveTo(0,0),e.lineTo(-.15,.1),e.lineTo(-.2,0),e.lineTo(-.2,-.05),e.lineTo(0,0),e.lineTo(.15,.1),e.lineTo(.2,0),e.lineTo(.3,0),e.lineTo(0,0),e.lineTo(0,.05),e.quadraticCurveTo(.3,.15,.5,.2),e.quadraticCurveTo(.7,.25,.9,.15),e.quadraticCurveTo(1,.1,1.1,0),e.quadraticCurveTo(1,-.05,.8,-.1),e.lineTo(.7,-.15),e.lineTo(.65,-.1),e.quadraticCurveTo(.4,-.08,.2,-.05),e.quadraticCurveTo(.1,-.02,0,0),e},v=()=>{let e=new a.Shape;return e.moveTo(0,0),e.lineTo(-.13,.08),e.lineTo(-.18,0),e.lineTo(-.08,-.04),e.lineTo(0,0),e.lineTo(.13,.08),e.lineTo(.18,0),e.lineTo(.08,-.04),e.lineTo(0,0),e.lineTo(0,.04),e.quadraticCurveTo(.28,.13,.48,.18),e.quadraticCurveTo(.68,.23,.88,.13),e.quadraticCurveTo(.98,.08,1.08,0),e.quadraticCurveTo(.98,-.04,.78,-.08),e.lineTo(.68,-.13),e.lineTo(.63,-.08),e.quadraticCurveTo(.38,-.06,.18,-.04),e.quadraticCurveTo(.08,-.02,0,0),e},w={steps:2,depth:.02,bevelEnabled:!0,bevelThickness:.004,bevelSize:.008,bevelSegments:3},S={...w,depth:.025,bevelThickness:.003,bevelSize:.004,bevelOffset:0};return(0,n.jsxs)("group",{position:[0,0,0],rotation:[0,0,0],scale:[.8,.8,.8],children:[(0,n.jsxs)("group",{ref:h,position:[f[0],f[1],f[2]],rotation:[0,0,Math.PI],scale:[1,1,1],children:[(0,n.jsxs)("group",{position:[0,-.2,0],rotation:[0,0,-Math.PI],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.015,.02,.45,12]}),(0,n.jsx)("meshStandardMaterial",{color:"#2a3b4c",roughness:.7})]}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,n.jsxs)("mesh",{position:[0,.175-.065*t,0],children:[(0,n.jsx)("torusGeometry",{args:[.0225,.004,8,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#1a2b3c",metalness:.6,roughness:.4})]},t))]}),(0,n.jsxs)("group",{position:[0,.3,0],rotation:[0,Math.PI/2,Math.PI/2],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[M(),w]}),(0,n.jsx)("meshStandardMaterial",{color:"#0066ff",emissive:"#0088ff",emissiveIntensity:3,metalness:.9,roughness:.2,opacity:.9,transparent:!0})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[v(),S]}),(0,n.jsx)("meshStandardMaterial",{color:"#0044ff",emissive:"#0088ff",emissiveIntensity:15,metalness:.9,roughness:.1,opacity:.95,transparent:!0})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[v(),{...S,depth:.04}]}),(0,n.jsx)("meshStandardMaterial",{color:"#0055ff",emissive:"#0077ff",emissiveIntensity:10,metalness:.8,roughness:.1,opacity:.7,transparent:!0})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[v(),{...S,depth:.06}]}),(0,n.jsx)("meshStandardMaterial",{color:"#0033ff",emissive:"#0066ff",emissiveIntensity:8,metalness:.7,roughness:.1,opacity:.4,transparent:!0})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[v(),{...S,depth:.08}]}),(0,n.jsx)("meshStandardMaterial",{color:"#0022ff",emissive:"#0044ff",emissiveIntensity:6,metalness:.6,roughness:.1,opacity:.2,transparent:!0})]}),(0,n.jsx)("pointLight",{color:"#0088ff",intensity:5,distance:2,decay:2})]})]}),(0,n.jsxs)("group",{ref:u,position:[p[0],p[1],p[2]],rotation:[0,0,Math.PI],scale:[1,1,1],children:[(0,n.jsxs)("group",{position:[0,-.2,0],rotation:[0,0,-Math.PI],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.015,.02,.45,12]}),(0,n.jsx)("meshStandardMaterial",{color:"#2a3b4c",roughness:.7})]}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,n.jsxs)("mesh",{position:[0,.175-.065*t,0],children:[(0,n.jsx)("torusGeometry",{args:[.0225,.004,8,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#1a2b3c",metalness:.6,roughness:.4})]},t))]}),(0,n.jsxs)("group",{position:[0,.3,0],rotation:[0,Math.PI/2,Math.PI/2],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[M(),w]}),(0,n.jsx)("meshStandardMaterial",{color:"#0066ff",emissive:"#0088ff",emissiveIntensity:3,metalness:.9,roughness:.2,opacity:.9,transparent:!0})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[v(),S]}),(0,n.jsx)("meshStandardMaterial",{color:"#0044ff",emissive:"#0088ff",emissiveIntensity:15,metalness:.9,roughness:.1,opacity:.95,transparent:!0})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[v(),{...S,depth:.04}]}),(0,n.jsx)("meshStandardMaterial",{color:"#0055ff",emissive:"#0077ff",emissiveIntensity:10,metalness:.8,roughness:.1,opacity:.7,transparent:!0})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[v(),{...S,depth:.06}]}),(0,n.jsx)("meshStandardMaterial",{color:"#0033ff",emissive:"#0066ff",emissiveIntensity:8,metalness:.7,roughness:.1,opacity:.4,transparent:!0})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[v(),{...S,depth:.08}]}),(0,n.jsx)("meshStandardMaterial",{color:"#0022ff",emissive:"#0044ff",emissiveIntensity:6,metalness:.6,roughness:.1,opacity:.2,transparent:!0})]}),(0,n.jsx)("pointLight",{color:"#0088ff",intensity:5,distance:2,decay:2})]})]})]})}function v(e){let{isSwinging:t,onSwingComplete:r,onLeftSwingStart:o,onRightSwingStart:s}=e,c=(0,i.useRef)(null),h=(0,i.useRef)(0),d=(0,i.useRef)(null),u=(0,i.useRef)(0),m=(0,i.useRef)(0);(0,l.F)((e,n)=>{if(t){if(c.current){0===h.current&&o(),h.current+=7*n;let e=Math.min(h.current/Math.PI,1),t=-1.2+2.5*Math.sin(e*Math.PI),s=.75+-1*Math.sin(e*Math.PI),i=-0+2*Math.cos(e*Math.PI);c.current.position.set(t,s,i);let a=Math.PI/3*Math.sin(e*Math.PI*.8),l=Math.sin(e*Math.PI)*Math.PI,d=Math.PI/3*Math.sin(e*Math.PI*.9);c.current.rotation.set(a,l,d),h.current>=Math.PI&&(h.current=0,c.current.rotation.set(0,0,0),c.current.position.set(-1.2,.75,-0),r())}if(d.current){if(m.current<.1)m.current+=n;else{0===u.current&&s(),u.current+=7*n;let e=Math.min(u.current/Math.PI,1),t=1.2-2.5*Math.sin(e*Math.PI),o=.75+-1*Math.sin(e*Math.PI),i=-0-2*Math.cos(e*Math.PI);d.current.position.set(t,o,i);let a=-Math.PI/3*Math.sin(e*Math.PI*.8),l=-(Math.sin(e*Math.PI)*Math.PI),c=-Math.PI/3*Math.sin(e*Math.PI*.9);d.current.rotation.set(a,l,c),u.current>=Math.PI&&(u.current=0,d.current.rotation.set(0,0,0),d.current.position.set(1.2,.75,-0),r())}}}else m.current=0,c.current&&(c.current.rotation.x*=.85,c.current.rotation.y*=.85,c.current.rotation.z*=.85,c.current.position.x+=(-1.2-c.current.position.x)*.2,c.current.position.y+=(.75-c.current.position.y)*.2,c.current.position.z+=(-0-c.current.position.z)*.2),d.current&&(d.current.rotation.x*=.85,d.current.rotation.y*=.85,d.current.rotation.z*=.85,d.current.position.x+=(1.2-d.current.position.x)*.2,d.current.position.y+=(.75-d.current.position.y)*.2,d.current.position.z+=(-0-d.current.position.z)*.2)});let f=()=>{let e=new a.Shape;return e.moveTo(0,0),e.lineTo(-.15,.09),e.lineTo(-.09,-.09),e.lineTo(0,0),e.lineTo(.15,.09),e.lineTo(.09,-.09),e.lineTo(0,0),e.lineTo(0,.072),e.lineTo(.15,.15),e.quadraticCurveTo(.6,.12,.9,.15),e.quadraticCurveTo(1.2,.09,1.32,0),e.quadraticCurveTo(1.2,-.09,.9,-.15),e.quadraticCurveTo(.6,-.12,.15,-.15),e.lineTo(0,-.072),e.lineTo(0,0),e},p=()=>{let e=new a.Shape;return e.moveTo(0,0),e.lineTo(-.12,.108),e.lineTo(-.072,-.108),e.lineTo(0,0),e.lineTo(.12,.108),e.lineTo(.072,-.108),e.lineTo(0,0),e.lineTo(0,.06),e.lineTo(.12,.12),e.quadraticCurveTo(.6,.09,.9,.12),e.quadraticCurveTo(1.2,.072,1.32,0),e.quadraticCurveTo(1.2,-.072,.9,-.12),e.quadraticCurveTo(.6,-.09,.12,-.12),e.lineTo(0,-.06),e.lineTo(0,0),e},x={steps:2,depth:.024,bevelEnabled:!0,bevelThickness:.006,bevelSize:.012,bevelSegments:2},g={...x,depth:.036,bevelThickness:.006,bevelSize:.006,bevelOffset:0};return(0,n.jsxs)("group",{position:[0,0,0],rotation:[0,0,0],scale:[1,1,1],children:[(0,n.jsxs)("group",{ref:c,position:[-1.2,.75,-0],rotation:[0,0,Math.PI],scale:[1,1,1],children:[(0,n.jsxs)("group",{position:[0,-.2,0],rotation:[0,0,-Math.PI],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.015,.02,.45,12]}),(0,n.jsx)("meshStandardMaterial",{color:"#2a3b4c",roughness:.7})]}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,n.jsxs)("mesh",{position:[0,.175-.065*t,0],children:[(0,n.jsx)("torusGeometry",{args:[.0225,.004,8,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#1a2b3c",metalness:.6,roughness:.4})]},t))]}),(0,n.jsxs)("group",{position:[0,.3,0],rotation:[0,-Math.PI/2,Math.PI/2],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[f(),x]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff1a1a",metalness:.9,roughness:.3})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[p(),g]}),(0,n.jsx)("meshStandardMaterial",{color:"#ffffff",emissive:"#ff0000",emissiveIntensity:5,metalness:.2,roughness:.1,opacity:.8,transparent:!0})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[p(),{...g,depth:.06}]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff3333",emissive:"#ff0000",emissiveIntensity:4,metalness:.2,roughness:.1,opacity:.4,transparent:!0})]})]})]}),(0,n.jsxs)("group",{ref:d,position:[1.2,.75,-0],rotation:[0,0,Math.PI],scale:[1,1,1],children:[(0,n.jsxs)("group",{position:[0,-.2,0],rotation:[0,0,-Math.PI],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.015,.02,.45,12]}),(0,n.jsx)("meshStandardMaterial",{color:"#2a3b4c",roughness:.7})]}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,n.jsxs)("mesh",{position:[0,.175-.065*t,0],children:[(0,n.jsx)("torusGeometry",{args:[.0225,.004,8,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#1a2b3c",metalness:.6,roughness:.4})]},t))]}),(0,n.jsxs)("group",{position:[0,.3,0],rotation:[0,-Math.PI/2,Math.PI/2],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[f(),x]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff1a1a",metalness:.9,roughness:.3})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[p(),g]}),(0,n.jsx)("meshStandardMaterial",{color:"#ffffff",emissive:"#ff0000",emissiveIntensity:5,metalness:.2,roughness:.1,opacity:.8,transparent:!0})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("extrudeGeometry",{args:[p(),{...g,depth:.06}]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff3333",emissive:"#ff0000",emissiveIntensity:4,metalness:.2,roughness:.1,opacity:.4,transparent:!0})]})]})]})]})}function w(e){let{children:t,position:r=[0,0,0],lockX:o=!1,lockY:s=!1,lockZ:c=!1}=e,h=(0,i.useRef)(null);return(0,l.F)(e=>{let{camera:t}=e;if(!h.current)return;let r=h.current.position,n=t.position,i=new a.Vector3().subVectors(n,r),l=h.current.rotation.clone();s||(l.y=Math.atan2(i.x,i.z)),o||(l.x=Math.atan2(-i.y,Math.sqrt(i.x*i.x+i.z*i.z))),c||(l.z=0),h.current.rotation.set(l.x,l.y,l.z)}),(0,n.jsx)("group",{ref:h,position:r,children:t})}function S(e){let{position:t,onComplete:r}=e,o=(0,i.useRef)(null),s=(0,i.useRef)(0),a=(0,i.useRef)(0);return(0,l.F)((e,t)=>{if(!o.current)return;if(a.current<.25){a.current+=t;return}s.current+=t;let n=Math.min(s.current/1,1);if(n<1){o.current.position.y=40*(1-n);let e=n<.9?1:1-(n-.9)/.1;o.current.scale.set(e,e,e)}else r()}),(0,n.jsxs)("group",{ref:o,position:[t.x,25,t.z],visible:a.current>=.25,children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.35,.35,20,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff6600",emissive:"#ff4400",emissiveIntensity:15,transparent:!0,opacity:.95})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.7,.7,20,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff6600",emissive:"#ff4400",emissiveIntensity:10,transparent:!0,opacity:.7})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[1,1,20,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff8800",emissive:"#ff6600",emissiveIntensity:8,transparent:!0,opacity:.4})]}),[void 0,void 0,void 0].map((e,t)=>(0,n.jsxs)("mesh",{rotation:[0,t*Math.PI/1.5,0],children:[(0,n.jsx)("torusGeometry",{args:[1.2,.08,8,32]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff6600",emissive:"#ff4400",emissiveIntensity:8,transparent:!0,opacity:.3})]},t)),[...Array(8)].map((e,t)=>(0,n.jsxs)("mesh",{position:[1*Math.cos(t*Math.PI/4),(t-4)*2,1*Math.sin(t*Math.PI/4)],children:[(0,n.jsx)("sphereGeometry",{args:[.15,8,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff6600",emissive:"#ff4400",emissiveIntensity:12,transparent:!0,opacity:.6})]},t)),(0,n.jsx)("pointLight",{position:[0,-10,0],color:"#ff4400",intensity:25,distance:12}),(0,n.jsx)("pointLight",{position:[0,0,0],color:"#ff6600",intensity:15,distance:6})]})}var P=r(2027);function b(e){let{damage:t,position:r,isCritical:o=!1,isLightning:s=!1,onComplete:a}=e,c=(0,i.useRef)(null),h=(0,i.useRef)(Date.now()),d=r.y+3.5,{camera:u}=(0,l.D)(),m=Date.now()%1e3/1e3,f=.3*Math.sin(m*Math.PI*2),p=.2*Math.cos(m*Math.PI*2);return(0,l.F)(()=>{if(!c.current)return;let e=(Date.now()-h.current)/1e3;if(e>=1.5){a();return}c.current.quaternion.copy(u.quaternion);let t=e/1.5,n=d+1.2*(1-Math.pow(1-t,3)),o=r.x+f;c.current.position.set(o,n+p,r.z),c.current.material.opacity=Math.min(1,3*(1-t))}),(0,n.jsx)(P.E,{ref:c,position:[r.x,d,r.z],fontSize:.5,color:o?"#ff0000":s?"#ffff00":"#ffffff",anchorX:"center",anchorY:"middle",outlineWidth:.1,outlineColor:"#000000","material-transparent":!0,"material-depthTest":!1,children:t})}var I=function(e){return e.SCYTHE="scythe",e.SWORD="sword",e.SABRES="sabres",e.SABRES2="sabres2",e}({});let C={[I.SWORD]:{normal:14,special:25},[I.SCYTHE]:{normal:10,special:16},[I.SABRES]:{normal:7,special:40},[I.SABRES2]:{normal:12,special:40}};function T(e){let{position:t,direction:r,chargeProgress:o,isCharging:s,onRelease:c}=e,h=(0,i.useRef)(null),d=(0,i.useRef)(s),u=(0,i.useRef)(null);return(0,i.useEffect)(()=>{if(h.current){let e=Math.atan2(r.x,r.z);h.current.rotation.set(0,e,0)}},[r]),(0,l.F)(()=>{!d.current&&s&&(u.current=Date.now()),d.current&&!s&&(c(Math.min((u.current?(Date.now()-u.current)/1e3:0)/2,1)),u.current=null),d.current=s}),(0,n.jsxs)("group",{ref:h,position:t.toArray(),children:[(0,n.jsxs)("mesh",{rotation:[Math.PI/2,0,0],children:[(0,n.jsx)("tubeGeometry",{args:[new a.CubicBezierCurve3(new a.Vector3(-.8,0,0),new a.Vector3(-.85,.3,0),new a.Vector3(.85,.3,0),new a.Vector3(.8,0,0)),64,.02,8,!1]}),(0,n.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:2,transparent:!0,opacity:.8})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("tubeGeometry",{args:[(e=>{let t=2*e;return new a.CubicBezierCurve3(new a.Vector3(-.8,0,0),new a.Vector3(0,-.1,-t),new a.Vector3(0,.1,-t),new a.Vector3(.8,0,0))})(o),32,.005,8,!1]}),(0,n.jsx)("meshStandardMaterial",{color:"#ffffff",emissive:"#ffffff",emissiveIntensity:4,transparent:!0,opacity:.6})]}),(0,n.jsxs)("group",{children:[(0,n.jsxs)("mesh",{position:[-.3,0,.32],rotation:[Math.PI/2,0,Math.PI/6],children:[(0,n.jsx)("boxGeometry",{args:[.6,.02,.05]}),(0,n.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:2,transparent:!0,opacity:.8})]}),(0,n.jsxs)("mesh",{position:[.3,0,.32],rotation:[Math.PI/2,0,-Math.PI/6],children:[(0,n.jsx)("boxGeometry",{args:[.6,.02,.05]}),(0,n.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:2,transparent:!0,opacity:.8})]})]}),s&&(0,n.jsxs)("group",{position:[0,0,.8-2*o],rotation:[Math.PI/2,0,0],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.01,.01,.7,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:3,transparent:!0,opacity:.9})]}),(0,n.jsxs)("mesh",{position:[0,.35,0],children:[(0,n.jsx)("coneGeometry",{args:[.03,.1,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:3,transparent:!0,opacity:.9})]})]}),s&&(0,n.jsxs)("mesh",{rotation:[Math.PI/2,0,0],children:[(0,n.jsx)("tubeGeometry",{args:[new a.LineCurve3(new a.Vector3(0,0,0),new a.Vector3(0,0,10)),64,.01,8,!1]}),(0,n.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:1,transparent:!0,opacity:.3*o})]})]})}function k(e){let{collectedBones:t,isLeftWing:r}=e,o=(0,i.useRef)(null),s=[{pos:new a.Vector3(r?-.3:.3,.4,0),rot:new a.Euler(0,0,r?-Math.PI/6:Math.PI/6),scale:1.4},{pos:new a.Vector3(r?-.6:.6,.5,0),rot:new a.Euler(0,0,r?-Math.PI/4:Math.PI/4),scale:1.3},{pos:new a.Vector3(r?-.8:.8,.7,0),rot:new a.Euler(0,0,r?-Math.PI/2.5:Math.PI/2.5),scale:1},{pos:new a.Vector3(r?-1.1:1.1,.8,.1),rot:new a.Euler(.1,0,r?-Math.PI/2.2:Math.PI/2.2),scale:.9},{pos:new a.Vector3(r?-1.4:1.4,.9,.2),rot:new a.Euler(.2,0,r?-Math.PI/2:Math.PI/2),scale:.8}],l=()=>(0,n.jsxs)("group",{children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.02,.015,.4,4]})," ",(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,n.jsxs)("mesh",{position:new a.Vector3(0,.2,0),rotation:new a.Euler(0,0,Math.PI/6),children:[(0,n.jsx)("sphereGeometry",{args:[.035,4,4]})," ",(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]}),(0,n.jsxs)("mesh",{position:new a.Vector3(0,-.2,0),rotation:new a.Euler(0,0,-Math.PI/6),children:[(0,n.jsx)("sphereGeometry",{args:[.03,4,4]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]});return(0,n.jsx)("group",{ref:o,rotation:new a.Euler(0,Math.PI,0),position:new a.Vector3(0,-.3,0),children:s.slice(0,Math.min(15,t)).map((e,t)=>(0,n.jsx)("group",{position:e.pos,rotation:e.rot,scale:e.scale,children:l()},"bone-".concat(t)))})}I.SCYTHE,I.SWORD,I.SABRES,I.SABRES2;let R=()=>(0,n.jsxs)("group",{rotation:[Math.PI/3,0,0],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.02,.015,.2,4]}),(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,n.jsxs)("mesh",{position:new a.Vector3(0,.1,0),rotation:new a.Euler(0,0,Math.PI/6),children:[(0,n.jsx)("sphereGeometry",{args:[.025,4,4]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]}),(0,n.jsxs)("mesh",{position:new a.Vector3(0,-.1,0),rotation:new a.Euler(0,0,-Math.PI/6),children:[(0,n.jsx)("sphereGeometry",{args:[.02,4,4]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]});function _(e){let{parentRef:t}=e,r=(0,i.useRef)([]),o=(0,i.useRef)(null);return(0,l.F)(()=>{if(!t.current||!o.current)return;let e=t.current.position;o.current.position.set(e.x,0,e.z),r.current.forEach((e,t)=>{let r=t/12*Math.PI*2+.001*Date.now(),n=.55*Math.cos(r),o=.55*Math.sin(r),s=.08*Math.sin(.002*Date.now()+t);e.position.set(n,s+.1,o),e.rotation.y=r+Math.PI/2})}),(0,n.jsx)("group",{ref:o,children:Array.from({length:12}).map((e,t)=>(0,n.jsx)("mesh",{ref:e=>{e&&(r.current[t]=e)},children:R()},t))})}let G=()=>{let e=(0,i.useRef)(null),t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,n.jsxs)("group",{position:[0,e,0],scale:t,children:[(0,n.jsxs)("group",{rotation:[0,0,-Math.PI/3],children:[(0,n.jsxs)("mesh",{position:[.1,0,0],rotation:[1,Math.PI/2,0],children:[(0,n.jsx)("torusGeometry",{args:[.2,.015,8,12,.75*Math.PI]}),(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,n.jsxs)("mesh",{position:[.3,-.15,0],children:[(0,n.jsx)("sphereGeometry",{args:[.02,4,4]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]}),(0,n.jsxs)("group",{rotation:[0,0,Math.PI/3],children:[(0,n.jsxs)("mesh",{position:[-.1,0,0],rotation:[0,-Math.PI/2,0],children:[(0,n.jsx)("torusGeometry",{args:[.2,.015,8,12,.75*Math.PI]}),(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,n.jsxs)("mesh",{position:[-.3,-.15,0],children:[(0,n.jsx)("sphereGeometry",{args:[.02,4,4]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.02,.02,.1,4]}),(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]})]})};return(0,n.jsx)("group",{ref:e,position:[0,.04,-0],rotation:[.25,Math.PI+Math.PI/.97,0],children:(0,n.jsxs)("group",{children:[(0,n.jsxs)("group",{children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.04,.04,.8,4]}),(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),[-.3,-.15,0,.15,.3].map((e,t)=>(0,n.jsxs)("group",{position:[0,e,0],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.06,.06,.04,6]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]}),(0,n.jsxs)("mesh",{position:[0,0,.04],children:[(0,n.jsx)("boxGeometry",{args:[.04,.03,.04]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]},t))]}),(0,n.jsxs)("group",{position:[0,0,0],children:[t(.45,.7),t(.3,.8),t(.15,.9),t(0,1),t(-.15,.9),t(-.3,.8),t(-.45,.7)]})]})})},E=()=>{let e=(0,i.useRef)(null);(0,l.F)(t=>{let{clock:r}=t;if(!e.current)return;let n=r.getElapsedTime();e.current.rotation.y=.3*Math.sin(.5*n),e.current.rotation.x=.1+.05*Math.sin(.7*n)});let t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,r=-.8*Math.pow(t/15,2.5),o=Math.PI/3,s=Math.atan2(-.8*Math.pow((t+1)/15,2.5)-r,.1*(1-t/20))+(0===t?o:0);return(0,n.jsxs)("group",{position:[0,-r,-(.1*t)*(1-t/40)],scale:e,rotation:[-s,0,0],children:[(0,n.jsxs)("mesh",{rotation:[Math.PI/2,0,0],children:[(0,n.jsx)("cylinderGeometry",{args:[.04,.035,.08,6]}),(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,n.jsxs)("group",{rotation:[Math.PI/2,0,Math.PI/2],children:[(0,n.jsxs)("mesh",{position:[0,.05,0],children:[(0,n.jsx)("coneGeometry",{args:[.02,.06,4]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]}),(0,n.jsxs)("mesh",{position:[.05,0,0],rotation:[0,0,-Math.PI/2],children:[(0,n.jsx)("coneGeometry",{args:[.015,.04,4]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]}),(0,n.jsxs)("mesh",{position:[-.085,0,0],rotation:[0,0,Math.PI/2],children:[(0,n.jsx)("coneGeometry",{args:[.015,.04,4]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]}),(0,n.jsxs)("mesh",{position:[0,-.01,.13],rotation:[Math.PI/2,0,0],children:[(0,n.jsx)("sphereGeometry",{args:[.03,6,6]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]})};return(0,n.jsx)("group",{ref:e,position:[0,-.65,-.35],rotation:[-.1,0,0],children:[...Array(15)].map((e,r)=>t(1-.04*r,r))})},B=()=>(0,n.jsxs)("group",{children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("boxGeometry",{args:[.15,.03,.03]}),(0,n.jsx)("meshStandardMaterial",{color:"#67f2b9",transparent:!0,opacity:.6,emissive:"#67f2b9",emissiveIntensity:.5})]}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[.02,8,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#39ff14",emissive:"#39ff14",emissiveIntensity:2,transparent:!0,opacity:.5})]})]});function z(e){let{parentRef:t}=e,r=(0,i.useRef)([]),o=(0,i.useRef)(null);return(0,l.F)(e=>{let{clock:n}=e;if(!t.current||!o.current)return;let s=t.current.position;o.current.position.set(s.x,0,s.z),r.current.forEach((e,t)=>{if(!e)return;let r=n.getElapsedTime(),o=t/25*.6,s=t/25*Math.PI*4+2*r,i=.5*(1-.8*o),a=Math.cos(s)*i,l=Math.sin(s)*i;e.position.set(a,o,l),e.rotation.y=s+Math.PI/2,e.rotation.x=Math.PI/6,e.rotation.z=.1*Math.sin(3*r+t);let c=e.children[0];c&&c.material&&(c.material.opacity=Math.max(.1,1-2*o))})}),(0,n.jsxs)("group",{ref:o,children:[Array.from({length:25}).map((e,t)=>(0,n.jsx)("group",{ref:e=>{e&&(r.current[t]=e)},children:B()},t)),(0,n.jsx)("pointLight",{color:"#67f2b9",intensity:1,distance:1.2,position:[0,.25,0]})]})}let A=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return{damage:40,isCritical:!1};let r=.15>Math.random();return{damage:r?2*e:e,isCritical:r}},D=e=>{let{parentRef:t,fireballCharges:r}=e,o=(0,i.useRef)([]);return(0,l.F)(()=>{t.current&&o.current.forEach((e,t)=>{let r=t/8*Math.PI*2+.001*Date.now()*1.2,n=.6*Math.cos(r),o=.6*Math.sin(r),s=.1*Math.sin(.002*Date.now()+t);e.position.set(n,s,o)})}),(0,n.jsx)(n.Fragment,{children:Array.from({length:8}).map((e,t)=>{let s=r[t];return(0,n.jsxs)("mesh",{ref:e=>{e&&(o.current[t]=e)},children:[(0,n.jsx)("sphereGeometry",{args:[.08,8,8]}),(0,n.jsx)("meshStandardMaterial",{color:(null==s?void 0:s.available)?"#00ff44":"#333333",emissive:(null==s?void 0:s.available)?"#00ff44":"#333333",emissiveIntensity:(null==s?void 0:s.available)?2:.5,transparent:!0,opacity:(null==s?void 0:s.available)?.8:.4})]},t)})})};function V(e){var t,r;let{onHit:o,controlsRef:s,currentWeapon:c,onWeaponSelect:h,health:d,maxHealth:u,isPlayer:m=!1,abilities:f,onAbilityUse:y,onPositionUpdate:P,enemyData:R}=e,B=(0,i.useRef)(null),[V,F]=(0,i.useState)(!1),[q,N]=(0,i.useState)([]),L=(0,i.useRef)(0),{camera:O}=(0,l.D)(),H=(0,i.useRef)({w:!1,a:!1,s:!1,d:!1}),[W,Y]=(0,i.useState)(!1),[U,Q]=(0,i.useState)([]),K=(0,i.useRef)(0),[X,Z]=(0,i.useState)([]),J=(0,i.useRef)(0),[$,ee]=(0,i.useState)({}),[et,er]=(0,i.useState)(!1),[en,eo]=(0,i.useState)(0),es=(0,i.useRef)(null),ei=(0,i.useRef)(0),[ea,el]=(0,i.useState)([]),[ec,eh]=(0,i.useState)([{id:1,available:!0,cooldownStartTime:null},{id:2,available:!0,cooldownStartTime:null},{id:3,available:!0,cooldownStartTime:null},{id:4,available:!0,cooldownStartTime:null},{id:5,available:!0,cooldownStartTime:null},{id:6,available:!0,cooldownStartTime:null},{id:7,available:!0,cooldownStartTime:null},{id:8,available:!0,cooldownStartTime:null}]),[ed]=(0,i.useState)(15),eu=(0,i.useCallback)(()=>{if(!B.current)return;let e=ec.findIndex(e=>e.available);if(-1===e)return;let t=B.current.position.clone();t.y+=1;let r=new a.Vector3(0,0,1);r.applyQuaternion(B.current.quaternion),eh(t=>t.map((t,r)=>r===e?{...t,available:!1,cooldownStartTime:Date.now()}:t)),N(e=>[...e,{id:L.current++,position:t.clone(),startPosition:t.clone(),direction:r.normalize(),maxDistance:15}])},[B,ec]),em=e=>{N(t=>t.filter(t=>t.id!==e))},ef=e=>{if(!B.current||!V)return;let t=R.find(t=>t.id===e)||("dummy1"===e||"dummy2"===e?{id:e,position:new a.Vector3,health:1,maxHealth:1}:null);if(!t)return;let r=t.id.startsWith("enemy"),n=t.id.startsWith("dummy");if(r&&n||!r&&!n)return;let s=r?2:c===I.SABRES||c===I.SABRES2?2:1,i=$[t.id]||0;if(!(i>=s)&&B.current.position.distanceTo(t.position)<=(c===I.SABRES||c===I.SABRES2?5:4.5)){ee(e=>({...e,[t.id]:(e[t.id]||0)+1}));let e=C[c].normal;if(W&&c===I.SWORD){let{damage:r,isCritical:n}=A(e=10,!1);o(t.id,r),t.health-r>0&&(Z(e=>[...e,{id:J.current++,damage:r,position:t.position.clone(),isCritical:n}]),setTimeout(()=>{let{damage:e,isCritical:r}=A(25,!1),n=R.find(e=>e.id===t.id);n&&!(n.health<=0)&&(o(t.id,e),n.health-e>0&&Z(n=>[...n,{id:J.current++,damage:e,position:t.position.clone(),isCritical:r,isLightning:!0}]))},250));return}let{damage:r,isCritical:n}=A(e,!1);if(o(t.id,r),t.health-r>0){if(c===I.SABRES){let e=0===i?-.4:.4;Z(o=>[...o,{id:J.current++,damage:r,position:new a.Vector3(t.position.x+e,t.position.y,t.position.z),isCritical:n}])}else Z(e=>[...e,{id:J.current++,damage:r,position:t.position.clone(),isCritical:n}])}}},ep=()=>{F(!1),ee({}),Y(!1)};(0,l.F)((e,t)=>{if(!B.current)return;let r=new a.Vector3;O.getWorldDirection(r),r.y=0,r.normalize();let n=new a.Vector3(-r.z,0,r.x),o=new a.Vector3(0,0,0);if(H.current.w&&o.add(r),H.current.s&&o.sub(r),H.current.a&&o.sub(n),H.current.d&&o.add(n),o.length()>0){o.normalize(),B.current.position.add(o.multiplyScalar(.175));let e=Math.atan2(o.x,o.z);B.current.rotation.y=e}if(s.current){let e=B.current.position;s.current.target.set(e.x,e.y,e.z)}if(V&&B.current&&(ef("dummy1"),ef("dummy2"),R.forEach(e=>{ef(e.id)})),B.current&&P(B.current.position),et&&null!==es.current){let e=Math.min((Date.now()-es.current)/1e3/2,1);eo(e);let r=ei.current;ei.current+=(e-r)*t*5,e>=1&&ex(1)}el(e=>e.map(e=>(e.position.distanceTo(e.startPosition)<e.maxDistance&&(e.position.add(e.direction.clone().multiplyScalar(.5)),R.forEach(t=>{1.5>e.position.distanceTo(t.position)&&ey(e.id,t.id)})),e)).filter(e=>e.position.distanceTo(e.startPosition)<e.maxDistance)),N(e=>e.map(e=>{if(e.position.distanceTo(e.startPosition)<e.maxDistance){e.position.add(e.direction.clone().multiplyScalar(.5));let t=new a.Vector3(5,1.5,5),r=new a.Vector3(-5,1.5,5);if(1.5>e.position.distanceTo(t))return eM(e.id,"dummy1"),null;if(1.5>e.position.distanceTo(r))return eM(e.id,"dummy2"),null;for(let t of R){let r=t.position.clone();if(r.y=1.5,1.5>e.position.distanceTo(r))return eM(e.id,t.id),null}}return e}).filter(Boolean)),eh(e=>e.map(e=>!e.available&&e.cooldownStartTime&&Date.now()-e.cooldownStartTime>=12e3?{...e,available:!0,cooldownStartTime:null}:e))});let ex=(0,i.useCallback)(e=>{if(!B.current)return;let t=Math.floor(5+70*e),r=B.current.position.clone();r.y+=1;let n=new a.Vector3(0,0,1);n.applyQuaternion(B.current.quaternion);let s=r.clone(),i=new a.Ray(s,n.normalize());[{position:new a.Vector3(5,0,5),id:"dummy1"},{position:new a.Vector3(-5,0,5),id:"dummy2"},...R.map(e=>({position:e.position.clone(),id:e.id}))].forEach(r=>{let n=r.position.clone();n.y=1;let a=i.distanceToPoint(n),l=i.direction.dot(n.clone().sub(s));if(a<1.5&&l>0&&l<15){let n=e>=1;o(r.id,t);let s=R.find(e=>e.id===r.id),i="dummy1"===r.id||"dummy2"===r.id?{health:1,maxHealth:1}:null;(s?s.health:i?i.health:0)-t>0&&Z(e=>[...e,{id:J.current++,damage:t,position:r.position.clone(),isCritical:n}])}}),el(t=>[...t,{id:Date.now(),position:s.clone(),direction:n.clone(),power:e,startTime:Date.now(),maxDistance:15,startPosition:s.clone()}]),er(!1),eo(0),es.current=null,y(c,"e")},[c,B,o,Z,el,y,R]);(0,i.useEffect)(()=>{let e=e=>{let t=e.key.toLowerCase();if(t in H.current&&(H.current[t]=!0),"q"===t&&f[c].q.currentCooldown<=0&&!V&&(F(!0),y(c,"q")),"e"===t&&f[c].e.currentCooldown<=0){if(c!==I.SWORD||W)c!==I.SABRES&&c!==I.SABRES2||et?c===I.SABRES||c===I.SABRES2||(eu(),y(c,"e")):(er(!0),es.current=Date.now());else{Y(!0),F(!0);let e=B.current.position.clone();e.add(new a.Vector3(0,0,3.5).applyQuaternion(B.current.quaternion)),Q(t=>[...t,{id:K.current++,position:e}]),y(c,"e")}}switch(t){case"1":h(I.SCYTHE);break;case"2":h(I.SWORD);break;case"3":h(I.SABRES);break;case"4":h(I.SABRES2)}},t=e=>{let t=e.key.toLowerCase();t in H.current&&(H.current[t]=!1),"e"===t&&et&&ex(en)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[eu,V,h,W,c,f,y,et,en,ex]);let eg=e=>{Q(t=>t.filter(t=>t.id!==e))},ej=e=>{Z(t=>t.filter(t=>t.id!==e))};(0,i.useEffect)(()=>{(c===I.SABRES||c===I.SABRES2)&&ee({})},[c]);let ey=(e,t)=>{if(!t.startsWith("enemy"))return;let r=R.find(e=>e.id===t);if(!r)return;let{damage:n,isCritical:s}=A(C[c].normal,!1);o(t,n),r.health-n>0&&Z(e=>[...e,{id:J.current++,damage:n,position:r.position.clone(),isCritical:s}]),el(t=>t.filter(t=>t.id!==e))},eM=(e,t)=>{let r=t.startsWith("enemy"),n=t.startsWith("dummy");if(!r&&!n)return;let s=R.find(e=>e.id===t),i="dummy1"===t||"dummy2"===t?{id:t,position:new a.Vector3,health:1,maxHealth:1}:null,l=s||i;if(!l)return;let{damage:c,isCritical:h}=A(24,!1);o(l.id,c),l.health-c>0&&Z(e=>[...e,{id:J.current++,damage:c,position:l.position.clone(),isCritical:h}]),em(e)};return(0,l.F)(()=>{B.current&&P(B.current.position.clone())}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("group",{ref:B,position:[0,1,0],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[.45,32,32]}),(0,n.jsx)("meshPhongMaterial",{color:"#67f2b9",transparent:!0,opacity:.2,shininess:80})]}),(0,n.jsxs)("mesh",{scale:1.3,children:[(0,n.jsx)("sphereGeometry",{args:[.45,32,32]}),(0,n.jsx)("meshBasicMaterial",{color:"#39ff14",transparent:!0,opacity:.1,depthWrite:!1})]}),(0,n.jsxs)("mesh",{position:[0,.2,.3],scale:.35,children:[(0,n.jsx)("sphereGeometry",{args:[.4,32,32]}),(0,n.jsx)("meshPhongMaterial",{color:"#67f2b9",transparent:!0,opacity:.6,emissive:"#67f2b9",emissiveIntensity:.3})]}),(0,n.jsxs)("group",{position:[0,.2,-.2],children:[(0,n.jsx)("group",{rotation:[0,Math.PI/8,0],children:(0,n.jsx)(k,{collectedBones:ed,isLeftWing:!0,parentRef:B})}),(0,n.jsx)("group",{rotation:[0,-Math.PI/8,0],children:(0,n.jsx)(k,{collectedBones:ed,isLeftWing:!1,parentRef:B})})]}),(0,n.jsx)(D,{parentRef:B,fireballCharges:ec}),(0,n.jsx)(G,{}),(0,n.jsx)(E,{}),c===I.SABRES2?(0,n.jsx)(v,{isSwinging:V,onSwingComplete:ep,onLeftSwingStart:()=>{},onRightSwingStart:()=>{}}):c===I.SABRES?(0,n.jsx)(M,{isSwinging:V,onSwingComplete:ep,onLeftSwingStart:()=>{},onRightSwingStart:()=>{},isBowCharging:et}):c===I.SCYTHE?(0,n.jsx)(x,{parentRef:B,isSwinging:V,onSwingComplete:ep}):(0,n.jsx)(g,{isSwinging:V,isSmiting:W,onSwingComplete:ep,onSmiteComplete:()=>{Y(!1),F(!1),ee({})}}),!m&&(0,n.jsxs)(w,{position:[0,2,0],lockX:!1,lockY:!1,lockZ:!1,children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("planeGeometry",{args:[1,.1]}),(0,n.jsx)("meshBasicMaterial",{color:"#333333"})]}),(0,n.jsxs)("mesh",{position:[-.5+d/u*.5,0,.001],children:[(0,n.jsx)("planeGeometry",{args:[d/u,.08]}),(0,n.jsx)("meshBasicMaterial",{color:"#ff3333"})]})]})]}),(0,n.jsx)(j,{parentRef:B}),q.map(e=>(0,n.jsx)(p,{position:e.position,direction:e.direction,onImpact:()=>em(e.id)},e.id)),U.map(e=>(0,n.jsx)(S,{weaponType:c,position:e.position,onComplete:()=>eg(e.id)},e.id)),X.map(e=>(0,n.jsx)(b,{damage:e.damage,position:e.position,isCritical:e.isCritical,isLightning:e.isLightning,onComplete:()=>ej(e.id)},e.id)),(c===I.SABRES||c===I.SABRES2)&&et&&(0,n.jsx)(T,{position:(null===(t=B.current)||void 0===t?void 0:t.position.clone().add(new a.Vector3(0,1,0)))||new a.Vector3,direction:new a.Vector3(0,0,1).applyQuaternion((null===(r=B.current)||void 0===r?void 0:r.quaternion)||new a.Quaternion),chargeProgress:en,isCharging:et,onRelease:ex}),ea.map(e=>(0,n.jsxs)("group",{children:[(0,n.jsxs)("group",{position:e.position.toArray(),rotation:[0,Math.atan2(e.direction.x,e.direction.z),0],children:[(0,n.jsxs)("mesh",{rotation:[Math.PI/2,0,0],children:[(0,n.jsx)("cylinderGeometry",{args:[.2,.4,1.2,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:5,transparent:!0,opacity:.9})]}),(0,n.jsxs)("mesh",{rotation:[Math.PI/2,0,0],children:[(0,n.jsx)("sphereGeometry",{args:[.3,16,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#ffffff",emissive:"#ffffff",emissiveIntensity:8,transparent:!0,opacity:.7})]}),(0,n.jsxs)("mesh",{scale:[1.2,1.2,1.5],children:[(0,n.jsx)("sphereGeometry",{args:[.4,16,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#80ffff",emissive:"#40ffff",emissiveIntensity:3,transparent:!0,opacity:.3,blending:a.AdditiveBlending})]}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,n.jsxs)("mesh",{position:[.2*Math.sin(.01*Date.now()+t),.2*Math.cos(.01*Date.now()+t),-(.3*t)],children:[(0,n.jsx)("sphereGeometry",{args:[.15-.03*t,8,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:4,transparent:!0,opacity:.5-.1*t})]},t)),[void 0,void 0,void 0].map((e,t)=>(0,n.jsxs)("mesh",{position:[0,0,-(.4*t)],rotation:[Math.PI/2,0,.003*Date.now()+t*Math.PI/3],children:[(0,n.jsx)("torusGeometry",{args:[.5+.1*t,.05,8,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:3,transparent:!0,opacity:.4-.1*t,blending:a.AdditiveBlending})]},"ring-".concat(t))),(0,n.jsx)("pointLight",{color:"#00ffff",intensity:4,distance:5,decay:2}),(0,n.jsx)("pointLight",{color:"#80ffff",intensity:2,distance:8,decay:1})]}),e.power>=1&&(0,n.jsxs)("group",{position:e.position.toArray(),rotation:[0,Math.atan2(e.direction.x,e.direction.z),0],children:[[...Array(12)].map((e,t)=>{let r=1-.08*t,o=.8-.06*t;return(0,n.jsxs)("group",{position:[0,0,-(.5*t)],scale:[.6*r,.6*r,1],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("torusGeometry",{args:[.5,.15,8,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:8,transparent:!0,opacity:o,blending:a.AdditiveBlending})]}),(0,n.jsxs)("mesh",{scale:1.2,children:[(0,n.jsx)("torusGeometry",{args:[.5,.2,8,16]}),(0,n.jsx)("meshStandardMaterial",{color:"#ffffff",emissive:"#80ffff",emissiveIntensity:5,transparent:!0,opacity:.5*o,blending:a.AdditiveBlending})]})]},"power-trail-".concat(t))}),(0,n.jsx)("pointLight",{color:"#00ffff",intensity:3,distance:6,decay:2})]})]},e.id)),(0,n.jsx)(z,{parentRef:B}),(0,n.jsx)(_,{parentRef:B})]})}var F=r(2433);function q(e){let{position:t,isAttacking:r,isWalking:o}=e,s=(0,i.useRef)(null),[a,c]=(0,i.useState)(0),[h,d]=(0,i.useState)(0),u=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,n.jsx)("group",{children:(0,n.jsxs)("group",{children:[m(e?.6:.85,e?.025:.03),(0,n.jsx)("group",{position:[0,e?-.3:-.425,0],children:m(e?.5:.75,e?.02:.025)})]})})},m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.4,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.02;return(0,n.jsxs)("group",{children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[t,.75*t,e,6]}),(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,n.jsxs)("mesh",{position:[0,e/2,0],children:[(0,n.jsx)("sphereGeometry",{args:[1.75*t,6,6]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]}),(0,n.jsxs)("mesh",{position:[0,-e/2,0],children:[(0,n.jsx)("sphereGeometry",{args:[1.5*t,6,6]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]})};return(0,l.F)((e,t)=>{if(s.current&&(o&&(c(e=>(e+2*t)%(2*Math.PI)),["LeftLeg","RightLeg"].forEach(e=>{var t,r;let n=null===(t=s.current)||void 0===t?void 0:t.getObjectByName(e);if(n){let t=e.includes("Right")?a:a+Math.PI,o=.6*Math.sin(t);n.rotation.x=o;let s=null===(r=n.children[0])||void 0===r?void 0:r.children[1];if(s){let e=.4*Math.sin(2*t)+.2;s.rotation.x=e}}}),["LeftArm","RightArm"].forEach(e=>{var t,r;let n=null===(t=s.current)||void 0===t?void 0:t.getObjectByName(e);if(n){let t=e.includes("Right")?a+Math.PI:a,o=.4*Math.sin(t);n.rotation.x=o;let s=null===(r=n.children[0])||void 0===r?void 0:r.children[1];if(s){let e=.2*Math.sin(2*t);s.rotation.x=e}}})),r)){d(e=>e+3*t);let e=Math.sin(Math.min(h,Math.PI/2))*Math.PI/2,r=s.current.getObjectByName("RightArm");if(r){var n;r.rotation.x=-e;let t=null===(n=r.children[0])||void 0===n?void 0:n.children[1];t&&(t.rotation.x=.5*e)}h>Math.PI/2&&d(0)}}),(0,n.jsxs)("group",{ref:s,position:t,children:[(0,n.jsxs)("group",{name:"Body",position:[0,1.2,0],scale:.85,children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.04,.04,1.6,6]}),(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),[-.5,-.25,0,.25,.5].map((e,t)=>(0,n.jsxs)("group",{position:[0,e,0],children:[(0,n.jsx)("group",{rotation:[0,0,-Math.PI/3],children:(0,n.jsxs)("mesh",{position:[.1,0,0],rotation:[1,Math.PI/2,0],children:[(0,n.jsx)("torusGeometry",{args:[.18,.015,8,12,.75*Math.PI]}),(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]})}),(0,n.jsx)("group",{rotation:[0,0,Math.PI/3],children:(0,n.jsxs)("mesh",{position:[-.1,0,0],rotation:[0,-Math.PI/2,0],children:[(0,n.jsx)("torusGeometry",{args:[.18,.015,8,12,.75*Math.PI]}),(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]})})]},t))]}),(0,n.jsxs)("group",{name:"Head",position:[0,2,0],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[.22,8,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,n.jsxs)("mesh",{position:[0,-.12,.05],children:[(0,n.jsx)("boxGeometry",{args:[.17,.08,.22]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]}),(0,n.jsxs)("group",{position:[0,.05,.14],children:[(0,n.jsxs)("group",{position:[-.07,0,0],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[.04,8,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#000000",emissive:"#ff0000",emissiveIntensity:3})]}),(0,n.jsxs)("mesh",{scale:1.2,children:[(0,n.jsx)("sphereGeometry",{args:[.035,8,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:2,transparent:!0,opacity:.4})]}),(0,n.jsxs)("mesh",{scale:1.4,children:[(0,n.jsx)("sphereGeometry",{args:[.03,8,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:1,transparent:!0,opacity:.2})]}),(0,n.jsx)("pointLight",{color:"#ff0000",intensity:.5,distance:.5,decay:2})]}),(0,n.jsxs)("group",{position:[.07,0,0],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[.04,8,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#000000",emissive:"#ff0000",emissiveIntensity:3})]}),(0,n.jsxs)("mesh",{scale:1.2,children:[(0,n.jsx)("sphereGeometry",{args:[.035,8,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:2,transparent:!0,opacity:.4})]}),(0,n.jsxs)("mesh",{scale:1.4,children:[(0,n.jsx)("sphereGeometry",{args:[.03,8,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:1,transparent:!0,opacity:.2})]}),(0,n.jsx)("pointLight",{color:"#ff0000",intensity:.5,distance:.5,decay:2})]})]})]}),(0,n.jsx)("group",{name:"LeftArm",position:[-.45,1.4,0],children:u(!0)}),(0,n.jsx)("group",{name:"RightArm",position:[.45,1.4,0],children:u(!0)}),(0,n.jsxs)("group",{position:[0,.7,0],children:[" ",(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.3,.25,.2,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]}),(0,n.jsx)("group",{name:"LeftLeg",position:[-.25,.3,0],children:u()}),(0,n.jsx)("group",{name:"RightLeg",position:[.25,.3,0],children:u()}),(0,n.jsx)("group",{position:[0,1.8,0],children:(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.04,.04,.2,6]}),(0,n.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]})})]})}let N=()=>(0,n.jsx)("group",{children:(0,n.jsxs)("mesh",{children:[(0,n.jsx)("cylinderGeometry",{args:[.03,.015,.3,8]}),(0,n.jsx)("meshStandardMaterial",{color:"#67f2b9",transparent:!0,opacity:.5,emissive:"#67f2b9",emissiveIntensity:.5})]})});function L(e){let{position:t,onComplete:r}=e,o=(0,i.useRef)([]),s=(0,i.useRef)(null),a=(0,i.useRef)(Date.now());return(0,l.F)(()=>{if(!s.current)return;let e=Date.now()-a.current,n=Math.min(e/1500,1);s.current.position.copy(t),o.current.forEach((t,r)=>{let o=Math.floor(r/8)/11,s=1.2*o*(n<.5?2*n:2-2*n),i=r%8/8*Math.PI*2+.006*(1+3*o)*e,a=Math.cos(i+2*o)*s,l=Math.sin(i+2*o)*s,c=(1-o)*3*(1+.1*Math.sin(.002*e));t.position.set(a,c,l),t.rotation.y=i+Math.PI/2,t.rotation.z=Math.PI/2+.8*o,t.rotation.x=.2*Math.sin(.004*e+r);let h=t.material;h.opacity=Math.max(0,.7-.4*o-(n>.7?(n-.7)*3:0)),h.emissiveIntensity=.5+.3*Math.sin(.004*e+r);let d=1+.2*Math.sin(.003*e+.5*r);t.scale.set(d,d,d)}),1===n&&r&&r()}),(0,n.jsx)("group",{ref:s,children:Array.from({length:96}).map((e,t)=>(0,n.jsx)("mesh",{ref:e=>{e&&(o.current[t]=e)},children:N()},t))})}function O(e){let{id:t,initialPosition:r,health:o,maxHealth:s,onTakeDamage:c,onPositionUpdate:h,playerPosition:d,onAttackPlayer:u}=e,m=(0,i.useRef)(null),f=(0,i.useRef)(Date.now()+2e3),[p,x]=(0,i.useState)(!1),[g,j]=(0,i.useState)(!1),[y,M]=(0,i.useState)(!1),v=(0,i.useRef)(r.clone());return(0,i.useEffect)(()=>{m.current&&m.current.position.copy(r)},[]),(0,i.useEffect)(()=>{0!==o||y||(console.log("Enemy ".concat(t," died")),M(!0),j(!0))},[o,t,y]),(0,l.F)(()=>{if(!m.current||o<=0||!d)return;let e=new a.Vector3().subVectors(d,m.current.position).normalize();if(m.current.position.distanceTo(d)>2&&o>0)x(!1),m.current.position.add(e.multiplyScalar(.02)),m.current.lookAt(d),v.current.copy(m.current.position),h(t,v.current);else if(o>0){let e=Date.now();e-f.current>=2e3&&(x(!0),u(5),f.current=e,setTimeout(()=>{x(!1)},500))}}),(0,i.useEffect)(()=>{console.log("EnemyUnit ".concat(t," health updated:"),o)},[o,t]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("group",{ref:m,visible:o>0,onClick:e=>{e.stopPropagation(),o>0&&(console.log("Clicked enemy ".concat(t)),c("enemy-".concat(t),10))},children:[(0,n.jsx)(q,{position:[0,0,0],isAttacking:p,isWalking:!p&&o>0,onHit:e=>{o>0&&c("enemy-".concat(t),e)}}),(0,n.jsx)(F.Q,{position:[0,3.5,0],follow:!0,lockX:!1,lockY:!1,lockZ:!1,children:o>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("mesh",{position:[0,0,0],children:[(0,n.jsx)("planeGeometry",{args:[2,.25]}),(0,n.jsx)("meshBasicMaterial",{color:"#333333",opacity:.8,transparent:!0})]}),(0,n.jsxs)("mesh",{position:[-1+o/s,0,.001],children:[(0,n.jsx)("planeGeometry",{args:[o/s*2,.23]}),(0,n.jsx)("meshBasicMaterial",{color:"#ff3333",opacity:.9,transparent:!0})]}),(0,n.jsx)(P.E,{position:[0,0,.002],fontSize:.2,color:"#ffffff",anchorX:"center",anchorY:"middle",fontWeight:"bold",children:"".concat(Math.ceil(o),"/").concat(s)})]})})]}),g&&(0,n.jsx)(L,{position:v.current,onComplete:()=>{j(!1)}})]})}let H=()=>(0,n.jsxs)("group",{position:[100,80,-150],scale:[30,30,30],children:[(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[1,32,32]}),(0,n.jsx)("meshStandardMaterial",{color:"#B8E0D2",roughness:.7,metalness:.2,emissive:"#B8E0D2",emissiveIntensity:.5})]}),(0,n.jsxs)("mesh",{scale:[1.2,1.2,1.2],children:[(0,n.jsx)("sphereGeometry",{args:[1,32,32]}),(0,n.jsx)("meshBasicMaterial",{color:"#4dff90",transparent:!0,opacity:.6})]}),(0,n.jsxs)("mesh",{scale:[1.5,1.5,1.5],children:[(0,n.jsx)("sphereGeometry",{args:[1,32,32]}),(0,n.jsx)("meshBasicMaterial",{color:"#4dff90",transparent:!0,opacity:.1,side:a.BackSide})]}),(0,n.jsx)("pointLight",{color:"#4dff90",intensity:2,distance:50})]}),W={uniforms:{topColor:{value:new a.Color("#ffb6c1")},middleColor:{value:new a.Color("#ffd1dc")},bottomColor:{value:new a.Color("#ffe4e1")},offset:{value:33},exponent:{value:.6}},vertexShader:"\n    varying vec3 vWorldPosition;\n    \n    void main() {\n      vec4 worldPosition = modelMatrix * vec4(position, 1.0);\n      vWorldPosition = worldPosition.xyz;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ",fragmentShader:"\n    uniform vec3 topColor;\n    uniform vec3 middleColor;\n    uniform vec3 bottomColor;\n    uniform float offset;\n    uniform float exponent;\n    \n    varying vec3 vWorldPosition;\n    \n    void main() {\n      float h = normalize(vWorldPosition + vec3(0.0, offset, 0.0)).y;\n      float mixStrength = max(pow(max(h, 0.0), exponent), 0.0);\n      vec3 color = mix(middleColor, topColor, mixStrength);\n      color = mix(bottomColor, color, smoothstep(0.0, 1.0, h));\n      gl_FragColor = vec4(color, 1.0);\n    }\n  "},Y=()=>{let e=(0,i.useMemo)(()=>({uniforms:W.uniforms,vertexShader:W.vertexShader,fragmentShader:W.fragmentShader,side:a.BackSide}),[]);return(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[500,32,32]}),(0,n.jsx)("shaderMaterial",{attach:"material",args:[e]})]})},U=()=>{let e=Math.random()*Math.PI*2,t=20*Math.cos(e)*Math.random(),r=20*Math.sin(e)*Math.random();return new a.Vector3(t,0,r)},Q=[{title:"The Darkness Claims Another",subtitle:"Your soul joins the eternal dance..."},{title:"Fallen to Shadow",subtitle:"The necropolis grows stronger..."},{title:"Death's Embrace",subtitle:"The bones welcome their kin..."},{title:"The Last Stand",subtitle:"Your light fades into the abyss..."},{title:"Eternal Rest",subtitle:"The skeleton army claims victory..."},{title:"Denied Ascension",subtitle:"The dragons turn their backs on another unworthy soul..."},{title:"Draconic Disappointment",subtitle:"Your flames were not strong enough to join their ranks..."},{title:"Failed Wyrm",subtitle:"The ancient dragons scoff at your weakness..."},{title:"Wingless One",subtitle:"You'll never know the freedom of dragon flight..."},{title:"Mortal Chains",subtitle:"Forever bound to walk while dragons soar above..."},{title:"Lost Heritage",subtitle:"The dragon blood within you grows cold..."},{title:"Fading Ember",subtitle:"Your draconic spark extinguishes in darkness..."},{title:"Rejected by Fire",subtitle:"The dragon's flame finds you unworthy..."}];function K(e){let{playerHealth:t,onReset:r,onSpawnSkeleton:o,killCount:s}=e,[a,l]=(0,i.useState)(!1),[c,h]=(0,i.useState)(null),[d,u]=(0,i.useState)(0);(0,i.useEffect)(()=>{let e=setInterval(()=>{!a&&d<10&&(o(U()),u(e=>e+1))},12e3);return()=>clearInterval(e)},[a,o,d]),(0,i.useEffect)(()=>{if(t<=0&&!a){let e=Q[Math.floor(Math.random()*Q.length)];h({title:e.title,subtitle:"".concat(e.subtitle,"\nSkeletons Slain: ").concat(s)}),l(!0)}},[t,a,s]);let m=(0,i.useCallback)(()=>{l(!1),h(null),u(0),r()},[r]);return a&&c?(0,n.jsxs)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.8)",zIndex:1e3,color:"#fff",fontFamily:"Arial, sans-serif"},children:[(0,n.jsx)("h1",{style:{fontSize:"3rem",marginBottom:"1rem",color:"#ff3333",textShadow:"0 0 10px rgba(255, 51, 51, 0.5)"},children:c.title}),(0,n.jsx)("p",{style:{fontSize:"1.5rem",marginBottom:"2rem",color:"#aaa",textAlign:"center",whiteSpace:"pre-line"},children:c.subtitle}),(0,n.jsx)("button",{onClick:m,style:{padding:"1rem 3rem",fontSize:"1.2rem",backgroundColor:"#ff3333",border:"none",borderRadius:"5px",color:"#fff",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 0 20px rgba(255, 51, 51, 0.3)"},onMouseOver:e=>{e.currentTarget.style.transform="scale(1.1)",e.currentTarget.style.boxShadow="0 0 30px rgba(255, 51, 51, 0.5)"},onMouseOut:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 0 20px rgba(255, 51, 51, 0.3)"},children:"RETRY"}),(0,n.jsxs)("div",{style:{position:"fixed",bottom:"20px",right:"20px",color:"#fff",fontSize:"24px",fontFamily:"Arial, sans-serif",zIndex:1e3,pointerEvents:"none"},children:["Kills: ",s]})]}):null}let X=()=>{let e=document.createElement("canvas");e.width=308,e.height=308;let t=e.getContext("2d");if(t){t.clearRect(0,0,308,308);let e=t.createRadialGradient(154,154,0,154,154,154);e.addColorStop(0,"rgba(255, 255, 255, 0.6)"),e.addColorStop(.2,"rgba(255, 255, 255, 0.3)"),e.addColorStop(.5,"rgba(255, 255, 255, 0.1)"),e.addColorStop(.8,"rgba(255, 255, 255, 0.05)"),e.addColorStop(1,"rgba(255, 255, 255, 0)"),t.fillStyle=e,t.beginPath(),t.arc(154,154,154,0,2*Math.PI),t.fill()}let r=new a.Texture(e);return r.needsUpdate=!0,r},Z=e=>{let{count:t=2e3,radius:r=100}=e,o=(0,i.useMemo)(()=>X(),[]),s=(0,i.useMemo)(()=>{let e=new Float32Array(3*t),n=new Float32Array(3*t),o=new Float32Array(t);for(let s=0;s<t;s++){let t=2*Math.PI*Math.random(),i=Math.acos(2*Math.random()-1),l=r*Math.cbrt(Math.random());e[3*s]=l*Math.sin(i)*Math.cos(t),e[3*s+1]=l*Math.sin(i)*Math.sin(t),e[3*s+2]=l*Math.cos(i);let c=new a.Color;c.setHSL(.33+.02*Math.random(),1,.8+.2*Math.random()),n[3*s]=.3*c.r,n[3*s+1]=1.5*c.g,n[3*s+2]=.3*c.b,o[s]=8*Math.random()+4}return{positions:e,colors:n,sizes:o}},[t,r]),c=i.useRef(null);return(0,l.F)(e=>{let{clock:t}=e;c.current&&(c.current.rotation.y=.05*t.getElapsedTime())}),(0,n.jsxs)("points",{ref:c,children:[(0,n.jsxs)("bufferGeometry",{children:[(0,n.jsx)("bufferAttribute",{attach:"attributes-position",count:t,array:s.positions,itemSize:3}),(0,n.jsx)("bufferAttribute",{attach:"attributes-color",count:t,array:s.colors,itemSize:3}),(0,n.jsx)("bufferAttribute",{attach:"attributes-size",count:t,array:s.sizes,itemSize:1,normalized:!0})]}),(0,n.jsx)("pointsMaterial",{size:1,vertexColors:!0,transparent:!0,opacity:.6,sizeAttenuation:!0,blending:a.AdditiveBlending,depthWrite:!1,map:o})]})};var J=r(4463);let $=()=>(0,n.jsx)(J.A,{radius:500,depth:200,count:5e3,factor:3,saturation:0,fade:!0,speed:.2});function ee(e){let{mountainData:t,treeData:r,mushroomData:o,treePositions:s,interactiveTrunkColor:l,interactiveLeafColor:d,unitProps:f,skeletonProps:p,killCount:x}=e,[g,j]=(0,i.useState)(p.map((e,t)=>({id:"skeleton-".concat(t),initialPosition:e.initialPosition,currentPosition:e.initialPosition.clone(),health:e.maxHealth,maxHealth:e.maxHealth}))),[y,M]=(0,i.useState)(f.health),v=(0,i.useRef)(null),[w,S]=(0,i.useState)(new a.Vector3(0,0,0)),P=(0,i.useCallback)((e,t)=>{console.log("Target ".concat(e," takes ").concat(t," damage")),j(r=>r.map(r=>{let n=e.replace("enemy-","");if(r.id===n){let e=Math.max(0,r.health-t);return console.log("Enemy ".concat(n," health: ").concat(r.health," -> ").concat(e)),0===e&&r.health>0&&(console.log("Enemy defeated, triggering onEnemyDeath"),f.onEnemyDeath()),{...r,health:e}}return r}))},[f]),b=(0,i.useCallback)(e=>{var t;null===(t=f.onDamage)||void 0===t||t.call(f,e)},[f]),I=(0,i.useCallback)(e=>{S(e)},[]),C=(0,i.useCallback)((e,t)=>{j(r=>r.map(r=>r.id===e.replace("enemy-","")?{...r,currentPosition:t.clone()}:r))},[]),T=(0,i.useCallback)(e=>{j(t=>{let r="skeleton-".concat(t.length);return[...t,{id:r,initialPosition:e,currentPosition:e.clone(),health:200,maxHealth:200}]})},[]),k=(0,i.useCallback)(()=>{M(f.maxHealth),j(p.map((e,t)=>({id:"skeleton-".concat(t),initialPosition:e.initialPosition,currentPosition:e.initialPosition.clone(),health:e.maxHealth,maxHealth:e.maxHealth})))},[p,f.maxHealth]),R={onHit:P,controlsRef:f.controlsRef,currentWeapon:f.currentWeapon,onWeaponSelect:f.onWeaponSelect,health:y,maxHealth:f.maxHealth,isPlayer:f.isPlayer,abilities:f.abilities,onAbilityUse:f.onAbilityUse,onPositionUpdate:I,enemyData:g.map(e=>({id:"enemy-".concat(e.id),position:e.currentPosition,health:e.health,maxHealth:e.maxHealth})),onDamage:f.onDamage,onEnemyDeath:()=>{console.log("Kill counted in Scene")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(K,{playerHealth:y,onReset:k,onSpawnSkeleton:T,killCount:x}),(0,n.jsx)($,{}),(0,n.jsx)(Z,{}),(0,n.jsx)(Y,{}),(0,n.jsx)(H,{}),(0,n.jsx)(c,{}),t.map((e,t)=>(0,n.jsx)(h,{position:e.position,scale:e.scale},"mountain-".concat(t))),r.map((e,t)=>(0,n.jsx)(u,{position:e.position,scale:e.scale,trunkColor:e.trunkColor,leafColor:e.leafColor},"tree-".concat(t))),o.map((e,t)=>(0,n.jsx)(m,{position:e.position,scale:e.scale},"mushroom-".concat(t))),(0,n.jsx)(u,{position:s.mainTree,scale:1,trunkColor:l,leafColor:d}),(0,n.jsx)("group",{ref:v,children:(0,n.jsx)(V,{...R})}),g.map(e=>(0,n.jsx)(O,{id:e.id,initialPosition:e.initialPosition,health:e.health,maxHealth:e.maxHealth,onTakeDamage:P,onPositionUpdate:C,playerPosition:w,onAttackPlayer:b},e.id))]})}var et=r(4983),er=r.n(et),en=r(9965),eo=r.n(en),es=r(155),ei=r.n(es);function ea(e){let{damage:t,index:r,onComplete:o,timestamp:s}=e,[a,l]=(0,i.useState)(!0);(0,i.useEffect)(()=>{let e=setTimeout(()=>{l(!1),setTimeout(o,300)},1e3),t=setTimeout(()=>{o()},2e3);return()=>{clearTimeout(e),clearTimeout(t)}},[o]);let c=Math.max(0,1-(Date.now()-s)/1e3);return(0,n.jsxs)("div",{className:"".concat(ei().notification," ").concat(a?ei().visible:ei().hidden),style:{transform:"translateY(".concat(-20-25*r,"px)"),opacity:c},children:["-",t]})}let el=[{title:"The Darkness Claims Another",subtitle:"Your soul joins the eternal dance..."},{title:"Fallen to Shadow",subtitle:"The necropolis grows stronger..."},{title:"Death's Embrace",subtitle:"The bones welcome their kin..."},{title:"The Last Stand",subtitle:"Your light fades into the abyss..."},{title:"Eternal Rest",subtitle:"The skeleton army claims victory..."},{title:"Denied Ascension",subtitle:"The dragons turn their backs on another unworthy soul..."},{title:"Draconic Disappointment",subtitle:"Your flames were not strong enough to join their ranks..."},{title:"Failed Wyrm",subtitle:"The ancient dragons scoff at your weakness..."},{title:"Wingless One",subtitle:"You'll never know the freedom of dragon flight..."},{title:"Mortal Chains",subtitle:"Forever bound to walk while dragons soar above..."},{title:"Lost Heritage",subtitle:"The dragon blood within you grows cold..."},{title:"Fading Ember",subtitle:"Your draconic spark extinguishes in darkness..."},{title:"Rejected by Fire",subtitle:"The dragon's flame finds you unworthy..."}],ec=e=>{let{size:t,strokeWidth:r,percentage:o,borderRadius:s}=e,i=r/2,a=t-r,l=4*a;return(0,n.jsx)("svg",{width:t,height:t,className:er().roundedSquareProgress,children:(0,n.jsx)("rect",{x:i,y:i,width:a,height:a,rx:s,ry:s,stroke:"#39ff14",strokeWidth:r,fill:"none",strokeDasharray:l,strokeDashoffset:l-l*o/100,className:er().progressForeground})})};function eh(e){let{currentWeapon:t,onWeaponSelect:r,playerHealth:o,maxHealth:s,abilities:a,onReset:l,killCount:c}=e,[h,d]=(0,i.useState)([]),u=(0,i.useRef)(0),m=(0,i.useRef)(o),[f,p]=(0,i.useState)(null);(0,i.useEffect)(()=>{if(o<m.current){let e=m.current-o;d(t=>[...t,{id:u.current++,damage:e,timestamp:Date.now()}].slice(-3))}m.current=o},[o]),(0,i.useEffect)(()=>{o<=0?p(el[Math.floor(Math.random()*el.length)]):p(null)},[o]);let x=e=>{d(t=>t.filter(t=>t.id!==e))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:er().bottomPanel,children:[(0,n.jsxs)("div",{className:er().healthBarSection,children:[h.map((e,t)=>(0,n.jsx)(ea,{damage:e.damage,index:t,timestamp:e.timestamp,onComplete:()=>x(e.id)},e.id)),(0,n.jsxs)("div",{className:er().healthBarContainer,children:[(0,n.jsxs)("div",{className:er().healthBarDecoration,children:[(0,n.jsx)("div",{className:er().healthBarOrnamentLeft}),(0,n.jsx)("div",{className:er().healthBarOrnamentRight,children:(0,n.jsx)("span",{className:er().killCountText,children:c})})]}),(0,n.jsxs)("div",{className:er().healthBar,children:[(0,n.jsx)("div",{className:er().healthBarBackground}),(0,n.jsx)("div",{className:er().healthBarInner,style:{width:"".concat(o/s*100,"%")}}),(0,n.jsx)("div",{className:er().healthBarShine}),(0,n.jsx)("div",{className:er().healthBarPulse})]}),(0,n.jsxs)("span",{className:er().healthText,children:[(0,n.jsx)("span",{className:er().healthCurrent,children:o}),(0,n.jsx)("span",{className:er().healthSeparator,children:"/"}),(0,n.jsx)("span",{className:er().healthMax,children:s})]})]})]}),(0,n.jsx)("div",{className:er().abilityContainer,children:a[t]&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:er().ability,children:[(0,n.jsx)("div",{className:er().keyBind,children:"Q"}),(0,n.jsx)(eo(),{src:a[t].q.icon,alt:"Q ability",width:50,height:50,className:er().abilityIcon}),a[t].q.currentCooldown>0&&(0,n.jsxs)("div",{className:er().cooldownOverlay,children:[(0,n.jsx)(ec,{size:50,strokeWidth:4,percentage:a[t].q.currentCooldown/a[t].q.cooldown*100,borderRadius:8}),(0,n.jsx)("span",{className:er().cooldownText,children:Math.ceil(a[t].q.currentCooldown)})]})]}),(0,n.jsxs)("div",{className:er().ability,children:[(0,n.jsx)("div",{className:er().keyBind,children:"E"}),(0,n.jsx)(eo(),{src:a[t].e.icon,alt:"E ability",width:50,height:50,className:er().abilityIcon}),a[t].e.currentCooldown>0&&(0,n.jsxs)("div",{className:er().cooldownOverlay,children:[(0,n.jsx)(ec,{size:50,strokeWidth:4,percentage:a[t].e.currentCooldown/a[t].e.cooldown*100,borderRadius:8}),(0,n.jsx)("span",{className:er().cooldownText,children:Math.ceil(a[t].e.currentCooldown)})]})]})]})}),(0,n.jsx)("div",{className:er().weaponIcons,children:Object.values(I).filter((e,t)=>t<3).map((e,o)=>(0,n.jsxs)("div",{className:"".concat(er().weaponSlot," ").concat(t===e?er().activeWeapon:""),onClick:()=>r(e),children:[(0,n.jsx)("div",{className:er().keyBind,children:o+1}),(0,n.jsx)(eo(),{src:"/icons/".concat(o+1,".svg"),alt:e,width:50,height:50,className:er().weaponIcon})]},e))})]}),f&&(0,n.jsxs)("div",{className:er().gameOverOverlay,children:[(0,n.jsx)("h1",{className:er().gameOverTitle,children:f.title}),(0,n.jsx)("p",{className:er().gameOverSubtitle,children:f.subtitle}),(0,n.jsx)("button",{className:er().retryButton,onClick:l,children:"RETRY"})]})]})}let ed=["#3b2616","#4a3421","#5c4033","#654321","#8b7355"],eu=["#228b22","#3a5f0b"],em=()=>{let e=[];for(let t=0;t<45;t++){let t=Math.random()*Math.PI*2,r=35+40*Math.random(),n=Math.cos(t)*r,o=Math.sin(t)*r,s=.6+.8*Math.random();e.push({position:new a.Vector3(n,0,o),scale:s})}return e},ef=()=>[{position:new a.Vector3(-15,0,-5),scale:.9,trunkColor:new a.Color(ed[1]),leafColor:new a.Color(eu[1])},{position:new a.Vector3(-16.5,0,-6.5),scale:.75,trunkColor:new a.Color(ed[1]),leafColor:new a.Color(eu[1])},{position:new a.Vector3(-14,0,-6),scale:.85,trunkColor:new a.Color(ed[1]),leafColor:new a.Color(eu[1])},{position:new a.Vector3(-15.5,0,-3.5),scale:.8,trunkColor:new a.Color(ed[1]),leafColor:new a.Color(eu[1])},{position:new a.Vector3(16,0,-8),scale:.85,trunkColor:new a.Color(ed[2]),leafColor:new a.Color(eu[2])},{position:new a.Vector3(17.5,0,-9),scale:.9,trunkColor:new a.Color(ed[2]),leafColor:new a.Color(eu[2])},{position:new a.Vector3(15,0,-9.5),scale:.8,trunkColor:new a.Color(ed[2]),leafColor:new a.Color(eu[2])},{position:new a.Vector3(16.5,0,-6.5),scale:.75,trunkColor:new a.Color(ed[2]),leafColor:new a.Color(eu[2])},{position:new a.Vector3(-20,0,-20),scale:.95,trunkColor:new a.Color(ed[0]),leafColor:new a.Color(eu[0])},{position:new a.Vector3(-10,0,-22),scale:.9,trunkColor:new a.Color(ed[1]),leafColor:new a.Color(eu[1])},{position:new a.Vector3(0,0,-23),scale:.95,trunkColor:new a.Color(ed[2]),leafColor:new a.Color(eu[2])},{position:new a.Vector3(10,0,-22),scale:.9,trunkColor:new a.Color(ed[0]),leafColor:new a.Color(eu[0])},{position:new a.Vector3(20,0,-20),scale:.95,trunkColor:new a.Color(ed[1]),leafColor:new a.Color(eu[1])},{position:new a.Vector3(-12,0,12),scale:.8,trunkColor:new a.Color(ed[2]),leafColor:new a.Color(eu[2])},{position:new a.Vector3(12,0,12),scale:.8,trunkColor:new a.Color(ed[0]),leafColor:new a.Color(eu[0])},{position:new a.Vector3(-5,0,-15),scale:.85,trunkColor:new a.Color(ed[1]),leafColor:new a.Color(eu[1])},{position:new a.Vector3(5,0,-18),scale:.85,trunkColor:new a.Color(ed[2]),leafColor:new a.Color(eu[2])}],ep=()=>{let e=[];for(let t=0;t<100;t++){let t=Math.random()*Math.PI*2,r=45*Math.random(),n=r*Math.cos(t),o=r*Math.sin(t),s=.3+.2*Math.random();e.push({position:new a.Vector3(n,0,o),scale:s})}return e},ex=()=>{let e=Math.random()*Math.PI*2,t=30*Math.sqrt(Math.random());return new a.Vector3(Math.cos(e)*t,0,Math.sin(e)*t)};function eg(){let[e,t]=(0,i.useState)(I.SCYTHE),r=(0,i.useRef)(null),[l,c]=(0,i.useState)(200),[h,d]=(0,i.useState)(300),[u,m]=(0,i.useState)(0),[f,p]=(0,i.useState)(300),[x,g]=(0,i.useState)({[I.SWORD]:{q:{key:"q",cooldown:1.15,currentCooldown:0,icon:"/icons/q2.svg",maxCooldown:1,name:"Sword Q"},e:{key:"e",cooldown:4,currentCooldown:0,icon:"/icons/e2.svg",maxCooldown:3,name:"Sword E"}},[I.SCYTHE]:{q:{key:"q",cooldown:1,currentCooldown:0,icon:"/icons/q1.svg",maxCooldown:1,name:"Scythe Q"},e:{key:"e",cooldown:.4,currentCooldown:0,icon:"/icons/e1.svg",maxCooldown:1,name:"Scythe E"}},[I.SABRES]:{q:{key:"q",cooldown:.8,currentCooldown:0,icon:"/icons/q3.svg",maxCooldown:1,name:"Sabres Q"},e:{key:"e",cooldown:1.25,currentCooldown:0,icon:"/icons/e3.svg",maxCooldown:1,name:"Sabres E"}},[I.SABRES2]:{q:{key:"q",cooldown:1.5,currentCooldown:0,icon:"/icons/q3.svg",maxCooldown:1,name:"Sabres2 Q"},e:{key:"e",cooldown:1.25,currentCooldown:0,icon:"/icons/e3.svg",maxCooldown:3,name:"Sabres2 E"}}}),j=(0,i.useMemo)(()=>({mainTree:new a.Vector3(0,2,-5)}),[]),y=(0,i.useMemo)(()=>em(),[]),M=(0,i.useMemo)(()=>ef(),[]),v=(0,i.useMemo)(()=>ep(),[]),w=(0,i.useMemo)(()=>new a.Color(ed[Math.floor(Math.random()*ed.length)]),[]),S=(0,i.useMemo)(()=>new a.Color(eu[Math.floor(Math.random()*eu.length)]),[]),P=e=>{t(e)};(0,i.useEffect)(()=>{let e=setInterval(()=>{g(e=>{let t={...e};return Object.keys(t).forEach(e=>{["q","e"].forEach(r=>{t[e][r].currentCooldown>0&&(t[e][r].currentCooldown-=.1)})}),t})},100);return()=>clearInterval(e)},[]);let[b]=(0,i.useState)(new a.Vector3(0,0,0));(0,i.useEffect)(()=>{console.log("Dummy 1 Health: ".concat(h))},[h]);let[C,T]=(0,i.useState)(()=>[,,,,,].fill(200)),[k]=(0,i.useState)(()=>[,,,,,].fill(null).map((e,t)=>({id:"skeleton-".concat(t),initialPosition:ex(),health:200,maxHealth:200,onTakeDamage:(e,r)=>{T(e=>e.map((e,n)=>n===t?Math.max(0,e-r):e))}}))),[R,_]=(0,i.useState)(0),G=(0,i.useCallback)(()=>{console.log("Enemy death registered in HomePage"),_(e=>{let t=e+1;return console.log("Kill count updated:",t),t})},[]),E={mountainData:y,treeData:M,mushroomData:v,treePositions:j,interactiveTrunkColor:w,interactiveLeafColor:S,unitProps:{onHit:(e,t)=>{let r=Date.now();if(r-u>100){if("dummy1"===e)h>0&&d(Math.max(0,h-t));else if("dummy2"===e)f>0&&p(Math.max(0,f-t));else if(e.startsWith("skeleton-")){let r=parseInt(e.split("-")[1]);if(C[r]>0){let e=Math.max(0,C[r]-t);T(t=>{let n=[...t];return n[r]=e,n})}}m(r)}},controlsRef:r,currentWeapon:e,onWeaponSelect:P,health:l,maxHealth:200,isPlayer:!0,abilities:x,onAbilityUse:(e,t)=>{g(r=>{let n={...r};return n[e][t].currentCooldown=n[e][t].cooldown,n})},onPositionUpdate:e=>{b.copy(e)},enemyData:[{id:"dummy1",position:new a.Vector3(5,0,5),health:h,maxHealth:300},{id:"dummy2",position:new a.Vector3(-5,0,5),health:f,maxHealth:300},...[,,,,,].fill(null).map((e,t)=>({id:"skeleton-".concat(t),position:ex(),health:C[t],maxHealth:200}))],onDamage:e=>{c(t=>Math.max(0,t-e))},onEnemyDeath:G},skeletonProps:k,killCount:R};return(0,i.useEffect)(()=>{let e=e=>{"Space"===e.code&&e.preventDefault()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]),(0,n.jsxs)("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0},children:[(0,n.jsxs)(o.Hl,{shadows:!0,camera:{position:[0,10,20],fov:60},children:[(0,n.jsx)("ambientLight",{intensity:.3}),(0,n.jsx)(ee,{...E}),(0,n.jsx)(s.N,{ref:r,enablePan:!1,maxPolarAngle:Math.PI/2.2,maxDistance:75,mouseButtons:{LEFT:void 0,MIDDLE:void 0,RIGHT:a.MOUSE.ROTATE}})]}),(0,n.jsx)(eh,{currentWeapon:e,onWeaponSelect:P,playerHealth:l,maxHealth:200,abilities:x,onReset:()=>{c(200),d(300),p(300),T([,,,,,].fill(200)),g(e=>{let t={...e};return Object.keys(t).forEach(e=>{["q","e"].forEach(r=>{t[e][r].currentCooldown=0})}),t}),m(0),_(0)},killCount:R})]})}},155:e=>{e.exports={notification:"DamageNotification_notification__Y7BRa",floatUp:"DamageNotification_floatUp__prCzP",visible:"DamageNotification_visible__SgnZ4",hidden:"DamageNotification_hidden__TjZKP"}},4983:e=>{e.exports={bottomPanel:"Panel_bottomPanel__BfzyV",healthBarSection:"Panel_healthBarSection__gFmEd",healthBarContainer:"Panel_healthBarContainer__5tKwc",healthBarDecoration:"Panel_healthBarDecoration__GuSYa",healthBarOrnamentLeft:"Panel_healthBarOrnamentLeft__Q4Swy",healthBarOrnamentRight:"Panel_healthBarOrnamentRight__bIvNu",healthBar:"Panel_healthBar__esE_F",healthBarBackground:"Panel_healthBarBackground__uRzRP",healthBarInner:"Panel_healthBarInner__06c6o",healthBarShine:"Panel_healthBarShine__NHTuZ",shine:"Panel_shine__9Ky0a",healthBarPulse:"Panel_healthBarPulse__fbZXn",pulse:"Panel_pulse__kr41k",healthText:"Panel_healthText__ctvYG",healthCurrent:"Panel_healthCurrent__A_IbW",healthSeparator:"Panel_healthSeparator__4uXkI",healthMax:"Panel_healthMax__W4ON5",abilityContainer:"Panel_abilityContainer__9MMjy",ability:"Panel_ability__1K_7C",abilityIcon:"Panel_abilityIcon__2081V",weaponIcons:"Panel_weaponIcons__AYlTF",weaponSlot:"Panel_weaponSlot__tIfd1",keyBind:"Panel_keyBind__RUK7a",activeWeapon:"Panel_activeWeapon__STCzn",weaponIcon:"Panel_weaponIcon__LQiZv",cooldownOverlay:"Panel_cooldownOverlay__SUC04",cooldownText:"Panel_cooldownText__MNAuW",roundedSquareProgress:"Panel_roundedSquareProgress__kyHj3",progressForeground:"Panel_progressForeground__IHf6x",gameOverOverlay:"Panel_gameOverOverlay__ETe4B",gameOverTitle:"Panel_gameOverTitle__5G1mi",gameOverSubtitle:"Panel_gameOverSubtitle__mYzJr",retryButton:"Panel_retryButton__LqPQh",killCounter:"Panel_killCounter__BRNu4",killCountText:"Panel_killCountText__QWIBe",glowPulse:"Panel_glowPulse__ewMOw"}}},e=>{var t=t=>e(e.s=t);e.O(0,[624,84,682,636,593,792],()=>t(2022)),_N_E=e.O()}]);