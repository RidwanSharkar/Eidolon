(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{2022:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(110)}])},110:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>eQ});var r=n(4848),o=n(6540),s=n(4922),i=function(e){return e.SCYTHE="scythe",e.SWORD="sword",e.SABRES="sabres",e.SABRES2="sabres2",e.STAFF="staff",e}({});let a={sword:{normal:29,range:6.5,maxHitsPerSwing:1},scythe:{normal:17,range:4,maxHitsPerSwing:1},sabres:{normal:13,range:3.5,maxHitsPerSwing:2},sabres2:{normal:11,range:4,maxHitsPerSwing:2},staff:{normal:15,range:4,maxHitsPerSwing:1}},l={scythe:{q:{key:"q",cooldown:.8,currentCooldown:0,icon:"/Eidolon/icons/q1.svg",maxCooldown:1,name:"Scythe Q",isUnlocked:!0},e:{key:"e",cooldown:.7,currentCooldown:0,icon:"/Eidolon/icons/e1.svg",maxCooldown:.65,name:"Scythe E",isUnlocked:!0},r:{key:"r",cooldown:2.5,currentCooldown:0,icon:"/Eidolon/icons/r1.svg",maxCooldown:1,name:"Boneclaw",isUnlocked:!1},passive:{key:"1",cooldown:.5,currentCooldown:0,icon:"/Eidolon/icons/p1.svg",maxCooldown:0,name:"Reanimate",isUnlocked:!1}},sword:{q:{key:"q",cooldown:1,currentCooldown:0,icon:"/Eidolon/icons/q2.svg",maxCooldown:1.08,name:"Sword Q",isUnlocked:!0},e:{key:"e",cooldown:3,currentCooldown:0,icon:"/Eidolon/icons/e2.svg",maxCooldown:4,name:"Sword E",isUnlocked:!0},r:{key:"r",cooldown:25,currentCooldown:0,icon:"/Eidolon/icons/r2.svg",maxCooldown:5,name:"Retribute",isUnlocked:!1},passive:{key:"1",cooldown:.5,currentCooldown:0,icon:"/Eidolon/icons/p1.svg",maxCooldown:0,name:"Reanimate",isUnlocked:!1}},sabres:{q:{key:"q",cooldown:.65,currentCooldown:0,icon:"/Eidolon/icons/q3.svg",maxCooldown:.9,name:"Sabres Q",isUnlocked:!0},e:{key:"e",cooldown:.5,currentCooldown:0,icon:"/Eidolon/icons/e3.svg",maxCooldown:1,name:"Sabres E",isUnlocked:!0},r:{key:"r",cooldown:9.5,currentCooldown:0,icon:"/Eidolon/icons/r3.svg",maxCooldown:5,name:"Blizzard",isUnlocked:!1},passive:{key:"1",cooldown:.5,currentCooldown:0,icon:"/Eidolon/icons/p1.svg",maxCooldown:0,name:"Reanimate",isUnlocked:!1}},sabres2:{q:{key:"q",cooldown:.7,currentCooldown:0,icon:"/Eidolon/icons/q4.svg",maxCooldown:1.5,name:"Sabres2 Q",isUnlocked:!0},e:{key:"e",cooldown:1.5,currentCooldown:0,icon:"/Eidolon/icons/e4.svg",maxCooldown:6,name:"Firebeam",isUnlocked:!0},r:{key:"r",cooldown:15,currentCooldown:0,icon:"/Eidolon/icons/r4.svg",maxCooldown:15,name:"Blizzard",isUnlocked:!1},passive:{key:"1",cooldown:.5,currentCooldown:0,icon:"/Eidolon/icons/p1.svg",maxCooldown:0,name:"Reanimate",isUnlocked:!1}},staff:{q:{key:"q",cooldown:.8,currentCooldown:0,icon:"/Eidolon/icons/q4.svg",maxCooldown:1,name:"Staff Q",isUnlocked:!0},e:{key:"e",cooldown:2,currentCooldown:0,icon:"/Eidolon/icons/e4.svg",maxCooldown:0,name:"Firebeam",isUnlocked:!0},r:{key:"r",cooldown:15,currentCooldown:0,icon:"/Eidolon/icons/r4.svg",maxCooldown:15,name:"Blizzard",isUnlocked:!1},passive:{key:"1",cooldown:.5,currentCooldown:0,icon:"/Eidolon/icons/p1.svg",maxCooldown:0,name:"Reanimate",isUnlocked:!1}}},c=["#3b2616","#4a3421","#5c4033","#654321","#8b7355"],h=["#228b22","#3a5f0b"],u=()=>{let e=[];for(let t=0;t<60;t++){let t=Math.random()*Math.PI*2,n=35+40*Math.random(),r=Math.cos(t)*n,o=Math.sin(t)*n,i=.6+.8*Math.random();e.push({position:new s.Pq0(r,0,o),scale:i})}return e},d=()=>[{position:new s.Pq0(-15,0,-5),scale:.9,trunkColor:new s.Q1f(c[1]),leafColor:new s.Q1f(h[1])},{position:new s.Pq0(-16.5,0,-6.5),scale:.75,trunkColor:new s.Q1f(c[1]),leafColor:new s.Q1f(h[1])},{position:new s.Pq0(-14,0,-6),scale:.85,trunkColor:new s.Q1f(c[1]),leafColor:new s.Q1f(h[1])},{position:new s.Pq0(-15.5,0,-3.5),scale:.8,trunkColor:new s.Q1f(c[1]),leafColor:new s.Q1f(h[1])},{position:new s.Pq0(16,0,-8),scale:.85,trunkColor:new s.Q1f(c[2]),leafColor:new s.Q1f(h[2])},{position:new s.Pq0(17.5,0,-9),scale:.9,trunkColor:new s.Q1f(c[2]),leafColor:new s.Q1f(h[2])},{position:new s.Pq0(15,0,-9.5),scale:.8,trunkColor:new s.Q1f(c[2]),leafColor:new s.Q1f(h[2])},{position:new s.Pq0(16.5,0,-6.5),scale:.75,trunkColor:new s.Q1f(c[2]),leafColor:new s.Q1f(h[2])},{position:new s.Pq0(-20,0,-20),scale:.95,trunkColor:new s.Q1f(c[0]),leafColor:new s.Q1f(h[0])},{position:new s.Pq0(-10,0,-22),scale:.9,trunkColor:new s.Q1f(c[1]),leafColor:new s.Q1f(h[1])},{position:new s.Pq0(0,0,-23),scale:.95,trunkColor:new s.Q1f(c[2]),leafColor:new s.Q1f(h[2])},{position:new s.Pq0(10,0,-22),scale:.9,trunkColor:new s.Q1f(c[0]),leafColor:new s.Q1f(h[0])},{position:new s.Pq0(20,0,-20),scale:.95,trunkColor:new s.Q1f(c[1]),leafColor:new s.Q1f(h[1])},{position:new s.Pq0(-12,0,12),scale:.8,trunkColor:new s.Q1f(c[2]),leafColor:new s.Q1f(h[2])},{position:new s.Pq0(12,0,12),scale:.8,trunkColor:new s.Q1f(c[0]),leafColor:new s.Q1f(h[0])},{position:new s.Pq0(-5,0,-15),scale:.85,trunkColor:new s.Q1f(c[1]),leafColor:new s.Q1f(h[1])},{position:new s.Pq0(5,0,-18),scale:.85,trunkColor:new s.Q1f(c[2]),leafColor:new s.Q1f(h[2])}],m=()=>{let e=[];for(let t=0;t<100;t++){let t=Math.random()*Math.PI*2,n=45*Math.random(),r=n*Math.cos(t),o=n*Math.sin(t),i=.3+.2*Math.random();e.push({position:new s.Pq0(r,0,o),scale:i})}return e},p=()=>{let e=Math.random()*Math.PI*2,t=25*Math.random(),n=Math.cos(e)*t,r=Math.sin(e)*t;return new s.Pq0(n,0,r)};var f=n(8875),x=n(2805),g=n(7980);function j(e){let{color:t="#4a1c2c",roughness:n=.5,metalness:i=.1}=e,a=(0,o.useRef)(null),l=(0,o.useRef)(null),c=(0,o.useRef)(null),h=(0,o.useRef)(new s.BKk({uniforms:{time:{value:0},scale:{value:20},elevation:{value:.2},groundScale:{value:.1},baseColor:{value:new s.Q1f(t)},roughnessValue:{value:n},metalnessValue:{value:i}},vertexShader:"\n      varying vec2 vUv;\n      varying vec3 vNormal;\n      \n      void main() {\n        vUv = uv;\n        vNormal = normal;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n      }\n    ",fragmentShader:"\n      uniform float time;\n      uniform float scale;\n      uniform float elevation;\n      uniform float groundScale;\n      \n      varying vec2 vUv;\n      varying vec3 vNormal;\n      \n      // Simplex noise function\n      vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }\n      vec2 mod289(vec2 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }\n      vec3 permute(vec3 x) { return mod289(((x*34.0)+1.0)*x); }\n      \n      float snoise(vec2 v) {\n        const vec4 C = vec4(0.211324865405187,\n                           0.366025403784439,\n                          -0.577350269189626,\n                           0.024390243902439);\n        vec2 i  = floor(v + dot(v, C.yy) );\n        vec2 x0 = v -   i + dot(i, C.xx);\n        vec2 i1;\n        i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n        vec4 x12 = x0.xyxy + C.xxzz;\n        x12.xy -= i1;\n        i = mod289(i);\n        vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n                         + i.x + vec3(0.0, i1.x, 1.0 ));\n        vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n        m = m*m ;\n        m = m*m ;\n        vec3 x = 2.0 * fract(p * C.www) - 1.0;\n        vec3 h = abs(x) - 0.5;\n        vec3 ox = floor(x + 0.5);\n        vec3 a0 = x - ox;\n        m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n        vec3 g;\n        g.x  = a0.x  * x0.x  + h.x  * x0.y;\n        g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n        return 130.0 * dot(m, g);\n      }\n      \n      void main() {\n        // Create large distinct patches\n        vec2 groundUv = vUv * groundScale;\n        float groundPattern = snoise(groundUv);\n        \n        // Create snow texture for detail\n        vec2 uv = vUv * scale;\n        float n = snoise(uv) * 0.5;\n        n += snoise(uv * 2.0) * 0.25;\n        n += snoise(uv * 4.0) * 0.125;\n        n += snoise(uv * 8.0) * 0.0625;\n        \n        // Sparkle effect\n        float sparkle = pow(max(0.0, snoise(uv * 20.0 + time * 0.1)), 20.0) * 0.3;\n        \n        // Create blight glow spots\n        float blightSpots = pow(max(0.0, snoise(uv * 8.0 + time * 0.05)), 8.0) * 0.15;\n        \n        // Colors\n        vec3 snowColor = vec3(0.92, 0.93, 0.95);\n        vec3 blightColor = vec3(0.25, 0.22, 0.20);\n        vec3 glowColor = vec3(0.3, 0.8, 0.2);\n        \n        // Create sharp transitions between snow and ground\n        float blend = smoothstep(0.0, 0.1, groundPattern);\n        vec3 finalColor = mix(snowColor, blightColor, blend);\n        \n        // Add green glow spots only to blighted areas\n        float blightAmount = blend;\n        finalColor += glowColor * blightSpots * blightAmount;\n        \n        // Add snow effects only to snow areas\n        float snowAmount = 1.0 - blend;\n        float shadow = smoothstep(-1.0, 1.0, n) * 0.2;\n        finalColor = mix(finalColor, finalColor * 1.15, shadow * snowAmount);\n        finalColor += vec3(sparkle * snowAmount);\n        \n        gl_FragColor = vec4(finalColor, 1.0);\n      }\n    ",side:s.$EB})).current;return(0,o.useEffect)(()=>{if(!c.current){let e=new s.ypk;for(let t=0;t<8;t++){let n=t/8*Math.PI*2,r=50*Math.cos(n),o=50*Math.sin(n);0===t?e.moveTo(r,o):e.lineTo(r,o)}e.closePath(),c.current=e}},[]),(0,g.F)(e=>{let{clock:t}=e;h.uniforms&&(h.uniforms.time.value=t.getElapsedTime())}),(0,o.useEffect)(()=>{if(l.current){let e=new s.kn4,t=[];for(let e=0;e<200;e++){let e=Math.random()*Math.PI*2,n=45*Math.random();t.push([n*Math.cos(e),.01,n*Math.sin(e)])}t.forEach((t,n)=>{var r;let o=.1+.15*Math.random(),i=Math.random()*Math.PI*2;e.compose(new s.Pq0(t[0],t[1],t[2]),new s.PTz().setFromEuler(new s.O9p(.3*Math.random(),i,.3*Math.random())),new s.Pq0(o,o,o)),null===(r=l.current)||void 0===r||r.setMatrixAt(n,e)}),l.current&&(l.current.instanceMatrix.needsUpdate=!0)}},[]),(0,r.jsxs)("group",{children:[(0,r.jsxs)("mesh",{ref:a,rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[c.current&&(0,r.jsx)("shapeGeometry",{args:[c.current]}),(0,r.jsx)("meshStandardMaterial",{color:"#304050",roughness:.7,metalness:.1,emissive:"#304050",emissiveIntensity:1.3})]}),(0,r.jsxs)("instancedMesh",{ref:l,args:[void 0,void 0,200],castShadow:!0,receiveShadow:!0,children:[(0,r.jsx)("cylinderGeometry",{args:[.02,.02,.3,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.7,metalness:.2,emissive:"#304050",emissiveIntensity:.5})]}),(0,r.jsxs)("mesh",{position:[0,.1,0],rotation:[-Math.PI/2,0,0],children:[(0,r.jsx)("planeGeometry",{args:[100,100]}),(0,r.jsx)("meshStandardMaterial",{transparent:!0,opacity:.1,color:"#4a1c2c",fog:!0,depthWrite:!1,blending:s.EZo})]}),(0,r.jsx)("pointLight",{position:[0,.1,0],color:"#304050",intensity:4,distance:10,decay:2})]})}let y=e=>{let{position:t,scale:n=1,isInteractive:s=!1,health:i=100}=e,a=(0,o.useRef)(null);return((0,o.useEffect)(()=>{if(s&&i<=0&&a.current){var e;null===(e=a.current.parent)||void 0===e||e.remove(a.current)}},[i,s]),s&&i<=0)?null:(0,r.jsxs)("group",{name:"mountain",position:t,scale:n,children:[(0,r.jsxs)("mesh",{ref:a,castShadow:!0,receiveShadow:!0,children:[(0,r.jsx)("coneGeometry",{args:[23,35,6]}),(0,r.jsx)("meshStandardMaterial",{color:"#2a2a2a",metalness:.1,roughness:.9,emissive:"#222222"})]}),(0,r.jsxs)("mesh",{position:[-4,-5,-2],rotation:[0,.5,.1],castShadow:!0,children:[(0,r.jsx)("coneGeometry",{args:[24,28,5]}),(0,r.jsx)("meshStandardMaterial",{color:"#252525",metalness:.1,roughness:.9})]}),(0,r.jsxs)("mesh",{position:[0,15,0],castShadow:!0,children:[(0,r.jsx)("coneGeometry",{args:[5,8,6]}),(0,r.jsx)("meshStandardMaterial",{color:"#ffffff",metalness:.1,roughness:.6})]}),(0,r.jsxs)("mesh",{position:[-2,10,-1],rotation:[.1,.3,.1],castShadow:!0,children:[(0,r.jsx)("coneGeometry",{args:[3,6,5]}),(0,r.jsx)("meshStandardMaterial",{color:"#f0f0f0",metalness:.1,roughness:.7})]}),(0,r.jsxs)("mesh",{position:[3,5,2],rotation:[.2,-.3,0],castShadow:!0,children:[(0,r.jsx)("coneGeometry",{args:[6,15,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#1f1f1f",metalness:.2,roughness:1})]})]})},v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=new s.Q1f(e);return n.r=s.cj9.clamp(n.r+(Math.random()-.5)*t,0,1),n.g=s.cj9.clamp(n.g+(Math.random()-.5)*t,0,1),n.b=s.cj9.clamp(n.b+(Math.random()-.5)*t,0,1),n},M=o.memo(e=>{let{position:t=new s.Pq0(0,2,-5),scale:n=.8,trunkColor:i,leafColor:a}=e,l=(0,o.useMemo)(()=>v(i),[i]),c=(0,o.useMemo)(()=>v(a),[a]),h=.25*n,u=4.2*n,d=1.5*n,m=2*n;return(0,r.jsx)("group",{name:"tree",position:t,scale:n,children:(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[h,1.2*h,u,8]}),(0,r.jsx)("meshStandardMaterial",{color:l,roughness:.8,metalness:.1}),(0,r.jsxs)("mesh",{position:[0,.6*u,0],name:"tree-top",children:[(0,r.jsx)("coneGeometry",{args:[d,m,8]}),(0,r.jsx)("meshStandardMaterial",{color:c,roughness:.8,metalness:.1})]}),(0,r.jsxs)("mesh",{position:[0,.8*u,0],name:"tree-top-2",children:[(0,r.jsx)("coneGeometry",{args:[.7*d,.7*m,8]}),(0,r.jsx)("meshStandardMaterial",{color:c.clone().offsetHSL(0,0,-.1),roughness:.8,metalness:.1})]}),(0,r.jsxs)("mesh",{position:[0,u,0],name:"tree-top-3",children:[(0,r.jsx)("coneGeometry",{args:[.4*d,.4*m,8]}),(0,r.jsx)("meshStandardMaterial",{color:c.clone().offsetHSL(0,0,-.15),roughness:.8,metalness:.1})]})]})})}),w=e=>{let{position:t,scale:n}=e,s=(0,o.useRef)(null);return(0,g.F)(e=>{s.current&&(s.current.position.y=t.y+.05*Math.sin(e.clock.getElapsedTime()))}),(0,r.jsxs)("group",{position:t,scale:n,children:[(0,r.jsxs)("mesh",{ref:s,children:[(0,r.jsx)("cylinderGeometry",{args:[.05,.05,.6,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#d66a95"})]}),(0,r.jsxs)("mesh",{position:[0,.35,0],children:[(0,r.jsx)("coneGeometry",{args:[.2,.3,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#d66a95"})]})]})},P=e=>{let{color:t,size:n,meshRef:i,opacity:a=1}=e,l=(0,o.useRef)(null),c=(0,o.useRef)(new Float32Array(90)),h=(0,o.useRef)(new Float32Array(30)),u=(0,o.useRef)(new Float32Array(30)),d=(0,o.useRef)(!1);return(0,o.useEffect)(()=>{if(i.current&&!d.current){let{x:e,y:t,z:n}=i.current.position;for(let r=0;r<30;r++)c.current[3*r]=e,c.current[3*r+1]=t,c.current[3*r+2]=n,h.current[r]=0,u.current[r]=0;d.current=!0}},[i]),(0,g.F)(()=>{var e;if(!(null===(e=l.current)||void 0===e?void 0:e.parent)||!i.current||!d.current)return;let{x:t,y:r,z:o}=i.current.position;for(let e=29;e>0;e--)c.current[3*e]=c.current[(e-1)*3],c.current[3*e+1]=c.current[(e-1)*3+1],c.current[3*e+2]=c.current[(e-1)*3+2],h.current[e]=.5*Math.pow(1-e/30,2)*a,u.current[e]=.8*n*Math.pow(1-e/30,.5);if(c.current[0]=t,c.current[1]=r,c.current[2]=o,h.current[0]=.6*a,u.current[0]=1.2*n,l.current){let e=l.current.geometry;e.attributes.position.array=c.current,e.attributes.position.needsUpdate=!0,e.attributes.opacity&&(e.attributes.opacity.array=h.current,e.attributes.opacity.needsUpdate=!0),e.attributes.scale&&(e.attributes.scale.array=u.current,e.attributes.scale.needsUpdate=!0)}}),(0,r.jsxs)("points",{ref:l,children:[(0,r.jsxs)("bufferGeometry",{children:[(0,r.jsx)("bufferAttribute",{attach:"attributes-position",count:30,array:c.current,itemSize:3}),(0,r.jsx)("bufferAttribute",{attach:"attributes-opacity",count:30,array:h.current,itemSize:1}),(0,r.jsx)("bufferAttribute",{attach:"attributes-scale",count:30,array:u.current,itemSize:1})]}),(0,r.jsx)("shaderMaterial",{transparent:!0,depthWrite:!1,blending:s.EZo,vertexShader:"\n          attribute float opacity;\n          attribute float scale;\n          varying float vOpacity;\n          void main() {\n            vOpacity = opacity;\n            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n            gl_Position = projectionMatrix * mvPosition;\n            gl_PointSize = scale * 20.0 * (300.0 / -mvPosition.z);\n          }\n        ",fragmentShader:"\n          varying float vOpacity;\n          uniform vec3 uColor;\n          void main() {\n            float d = length(gl_PointCoord - vec2(0.5));\n            float strength = smoothstep(0.5, 0.1, d);\n            vec3 glowColor = mix(uColor, vec3(1.0), 0.4);\n            gl_FragColor = vec4(glowColor, vOpacity * strength);\n          }\n        ",uniforms:{uColor:{value:t}}})]})};function S(e){let{position:t,direction:n,onImpact:i}=e,a=(0,o.useRef)(null),l=(0,o.useRef)(new s.zD7),c=(0,o.useRef)(t.clone()),{scene:h}=(0,g.D)(),u=new s.Q1f("#00ff44"),d=(0,o.useRef)(null),m=(0,o.useRef)(!1),p=(0,o.useRef)(0),f=e=>{let t=new s.tBo,n=e.clone().sub(c.current).normalize();t.set(c.current,n);let r=h.children.filter(e=>"mountain"===e.name&&e instanceof s.YJl||"tree"===e.name&&e instanceof s.YJl).flatMap(e=>{let t=[];return e.traverse(e=>{e instanceof s.eaF&&t.push(e)}),t}),o=t.intersectObjects(r,!0);if(o.length>0){let t=o[0],n=c.current.distanceTo(e);if(t.distance<=n)return console.log("Collision detected:",t.point),!0}return!1},x=e=>{d.current&&(m.current=!0,p.current=l.current.getElapsedTime(),d.current.position.copy(e))};return(0,g.F)((e,t)=>{if(!a.current)return;if(l.current.getElapsedTime()>10){a.current.removeFromParent();return}let r=n.clone().multiplyScalar(.4*t*60),o=c.current.clone().add(r);if(f(o)?(a.current&&(x(c.current),a.current.removeFromParent()),i()):(c.current.copy(o),a.current.position.copy(c.current)),m.current&&d.current){let e=(l.current.getElapsedTime()-p.current)/1;if(e>=1)m.current=!1,d.current.scale.set(1,1,1),d.current.visible=!1;else{let t=1+2*e;d.current.scale.set(t,t,t),d.current.visible=!0;let n=d.current.children[0];n.material instanceof s._4j&&(n.material.opacity=1-e)}}}),(0,r.jsxs)("group",{name:"fireball-group",children:[(0,r.jsxs)("mesh",{ref:a,position:c.current,children:[(0,r.jsx)("sphereGeometry",{args:[.3,32,32]}),(0,r.jsx)("meshStandardMaterial",{emissive:u,emissiveIntensity:2,toneMapped:!1}),(0,r.jsx)("pointLight",{color:u,intensity:5,distance:12})]}),(0,r.jsx)("group",{ref:d,visible:!1,children:(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[.525,16,16]}),(0,r.jsx)("meshStandardMaterial",{color:u,emissive:u,emissiveIntensity:2,transparent:!0,opacity:1,depthWrite:!1,blending:s.EZo})]})}),(0,r.jsx)(P,{color:u,size:.3,meshRef:a,opacity:1})]})}function b(e){let{isSwinging:t,onSwingComplete:n}=e,i=(0,o.useRef)(null),a=(0,o.useRef)(0),l=[-1.055,1.1,.35];return(0,g.F)((e,r)=>{if(t&&i.current){a.current+=6*r;let e=Math.min(a.current/Math.PI/1.5,1),t=e<=.25?2*e:1-(e-.125)*2,o=l[0]+2.5*Math.sin(t*Math.PI),s=l[1]+-1.5*Math.sin(t*Math.PI),c=l[2]+1.1*Math.cos(t*Math.PI);i.current.position.set(o,s,c);let h=Math.PI/3*Math.sin(t*Math.PI),u=Math.sin(t*Math.PI)*Math.PI,d=Math.PI/3*Math.sin(t*Math.PI);i.current.rotation.set(h,u,d),a.current>=Math.PI&&(a.current=0,i.current.rotation.set(0,0,0),i.current.position.set(...l),n())}else!t&&i.current&&(i.current.rotation.x*=.85,i.current.rotation.y*=.85,i.current.rotation.z*=.85,i.current.position.x+=(l[0]-i.current.position.x)*.2,i.current.position.y+=(l[1]-i.current.position.y)*.2,i.current.position.z+=(l[2]-i.current.position.z)*.2)}),(0,r.jsxs)("group",{ref:i,position:[l[0],l[1],l[2]],rotation:[0,0,Math.PI],scale:[1,1,1.1],children:[(0,r.jsxs)("group",{position:[0,-.7,0],rotation:[0,0,-Math.PI],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.05,.05,2.1,12]})," ",(0,r.jsx)("meshStandardMaterial",{color:"#2c1810",roughness:.7})]}),[...Array(7)].map((e,t)=>(0,r.jsxs)("mesh",{position:[0,.81-.3*t,0],rotation:[Math.PI/2,0,0],children:[" ",(0,r.jsx)("torusGeometry",{args:[.06,.01,8,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#8B4513",metalness:.3,roughness:.7})]},t))]}),(0,r.jsxs)("group",{position:[0,.35,0],rotation:[Math.PI/1,0,Math.PI],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.08,.08,.3,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#2c1810",roughness:.6})]}),(0,r.jsx)("group",{"rotation-x":(0,g.F)(e=>2*e.clock.getElapsedTime()),children:(0,r.jsxs)("mesh",{"position-y":-.075,rotation:[Math.PI/2,0,0],children:[(0,r.jsx)("torusGeometry",{args:[.145,.02,16,32]}),(0,r.jsx)("meshStandardMaterial",{color:"#39ff14",emissive:"#39ff14",emissiveIntensity:1.5,transparent:!0,opacity:.7})]})}),(0,r.jsx)("group",{"rotation-x":(0,g.F)(e=>-(2*e.clock.getElapsedTime())),children:(0,r.jsxs)("mesh",{"position-y":.03,rotation:[Math.PI/2,0,0],children:[(0,r.jsx)("torusGeometry",{args:[.175,.02,16,32]}),(0,r.jsx)("meshStandardMaterial",{color:"#39ff14",emissive:"#39ff14",emissiveIntensity:1.5,transparent:!0,opacity:.7})]})}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.13,.11,.32,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#39ff14",emissive:"#39ff14",emissiveIntensity:1.5,transparent:!0,opacity:.3})]})]}),(0,r.jsx)("group",{position:[0,.375,1.175],rotation:[-1,-Math.PI/2,Math.PI/2.2],children:(0,r.jsxs)("mesh",{children:[(0,r.jsx)("extrudeGeometry",{args:[(()=>{let e=new s.ypk;return e.moveTo(0,0),e.lineTo(.4,-.13),e.bezierCurveTo(.8,.22,1.33,.5,1.6,.515),e.lineTo(1.125,.75),e.bezierCurveTo(.5,.2,.225,0,.1,.7),e.lineTo(0,0),e})(),{steps:1,depth:1e-4,bevelEnabled:!0,bevelThickness:.03,bevelSize:.035,bevelSegments:1,curveSegments:16,depth:.03}]}),(0,r.jsx)("meshStandardMaterial",{color:"#39ff14",emissive:"#39ff14",emissiveIntensity:1.3,metalness:.8,roughness:.1,opacity:1,transparent:!0,side:s.$EB})]})})]})}function C(e){let{isSwinging:t,isSmiting:n,onSwingComplete:i,onSmiteComplete:a}=e,l=(0,o.useRef)(null),c=(0,o.useRef)(0),h=(0,o.useRef)(0),u=[-1.2,.45,.75];(0,g.F)((e,r)=>{if(l.current){if(n){let e,t,n,o,s;h.current+=r*(h.current<Math.PI/2?3:6);let i=Math.min(h.current/Math.PI,1);if(i<.5){let r=1.75*i;e=-Math.PI/3-r*Math.PI/3,t=r*Math.PI/4,n=u[0]+1.5*r,o=u[1]+1.5*r,s=u[2]-1.5*r}else{let r=(i-.5)*2;e=-2*Math.PI/3+3*r*Math.PI/2,t=Math.PI/4*(1-r),n=u[0]+1.5*(1-r),o=u[1]+(1.5-2*r),s=u[2]-(1.5-3*r)}l.current.position.set(n,o,s),l.current.rotation.set(e,t,0),h.current>=Math.PI&&(h.current=0,l.current.rotation.set(0,0,0),l.current.position.set(...u),a());return}if(t){c.current+=8*r;let e=Math.min(c.current/Math.PI,1),t=u[0]+2.5*Math.sin(e*Math.PI),n=u[1]+-1*Math.sin(e*Math.PI),o=u[2]+2*Math.cos(e*Math.PI);l.current.position.set(t,n,o);let s=Math.PI/3*Math.sin(e*Math.PI*.8),a=Math.sin(e*Math.PI)*Math.PI,h=Math.PI/3*Math.sin(e*Math.PI*.9);l.current.rotation.set(s,a,h),c.current>=Math.PI&&(c.current=0,l.current.rotation.set(0,0,0),l.current.position.set(...u),i())}else t||n||(l.current.rotation.x*=.85,l.current.rotation.y*=.85,l.current.rotation.z*=.85,l.current.position.x+=(u[0]-l.current.position.x)*.2,l.current.position.y+=(u[1]-l.current.position.y)*.2,l.current.position.z+=(u[2]-l.current.position.z)*.2)}});let d=()=>{let e=new s.ypk;return e.moveTo(0,0),e.lineTo(0,.1),e.lineTo(.2,.2),e.quadraticCurveTo(1,.15,1.5,.2),e.quadraticCurveTo(2,.12,2.2,0),e.quadraticCurveTo(2,-.12,1.5,-.2),e.quadraticCurveTo(1,-.15,.2,-.2),e.lineTo(0,-.1),e.lineTo(0,0),e},m={steps:4,depth:.04,bevelEnabled:!0,bevelThickness:.015,bevelSize:.025,bevelOffset:0,bevelSegments:6},p={...m,depth:.06,bevelThickness:.03,bevelSize:.025,bevelOffset:0,bevelSegments:6};return(0,r.jsxs)("group",{ref:l,position:[u[0],u[1],u[2]],rotation:[0,0,Math.PI],scale:[1.1,1.1,1.1],children:[(0,r.jsxs)("group",{position:[0,-.4,0],rotation:[0,0,-Math.PI],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.03,.04,.9,12]}),(0,r.jsx)("meshStandardMaterial",{color:"#2a3b4c",roughness:.7})]}),[...Array(8)].map((e,t)=>(0,r.jsxs)("mesh",{position:[0,.35-.11*t,0],rotation:[Math.PI/2,0,0],children:[(0,r.jsx)("torusGeometry",{args:[.045,.016,8,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#1a2b3c",metalness:.6,roughness:.4})]},t))]}),(0,r.jsxs)("group",{position:[-.025,.28,0],rotation:[Math.PI,1.5,Math.PI],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("torusGeometry",{args:[.25,.07,16,32]}),(0,r.jsx)("meshStandardMaterial",{color:"#4a5b6c",metalness:.9,roughness:.1})]}),[...Array(8)].map((e,t)=>(0,r.jsxs)("mesh",{position:[.25*Math.cos(t*Math.PI/4),.25*Math.sin(t*Math.PI/4),0],rotation:[0,0,t*Math.PI/4+Math.PI/2],children:[(0,r.jsx)("coneGeometry",{args:[.05,.25,3]}),(0,r.jsx)("meshStandardMaterial",{color:"#4a5b6c",metalness:.9,roughness:.1})]},"spike-".concat(t))),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[.09,16,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff9900",emissive:"#ff8800",emissiveIntensity:30,transparent:!0,opacity:.95})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[.1,16,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff9900",emissive:"#ff8800",emissiveIntensity:25,transparent:!0,opacity:.8})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[.145,16,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff9900",emissive:"#ff8800",emissiveIntensity:20,transparent:!0,opacity:.6})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[.175,16,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff9900",emissive:"#ff8800",emissiveIntensity:15,transparent:!0,opacity:.4})]}),(0,r.jsx)("pointLight",{color:"#ff8800",intensity:4,distance:1.5,decay:2})]}),(0,r.jsxs)("group",{position:[0,.6,0],rotation:[0,-Math.PI/2,Math.PI/2],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("extrudeGeometry",{args:[(()=>{let e=new s.ypk;return e.moveTo(0,0),e.lineTo(-.25,.25),e.lineTo(-.15,-.15),e.lineTo(0,0),e.lineTo(.25,.25),e.lineTo(.15,-.15),e.lineTo(0,0),e.lineTo(0,.12),e.lineTo(.25,.25),e.quadraticCurveTo(1,.2,1.5,.25),e.quadraticCurveTo(2,.15,2.2,0),e.quadraticCurveTo(2,-.15,1.5,-.25),e.quadraticCurveTo(1,-.2,.25,-.25),e.lineTo(0,-.12),e.lineTo(0,0),e})(),m]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8e8ff",metalness:.4,roughness:.1})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("extrudeGeometry",{args:[d(),p]}),(0,r.jsx)("meshStandardMaterial",{color:"#ffffff",emissive:"#a0d4ff",emissiveIntensity:4,metalness:.2,roughness:.1,opacity:.8,transparent:!0})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("extrudeGeometry",{args:[d(),{...p,depth:.06}]}),(0,r.jsx)("meshStandardMaterial",{color:"#ffffff",emissive:"#c0e0ff",emissiveIntensity:3,metalness:.2,roughness:.1,opacity:.4,transparent:!0})]})]})]})}let I=(e,t,n)=>e*(1-n)+t*n;function k(e){let{isSwinging:t,onSwingComplete:n,onLeftSwingStart:i,onRightSwingStart:a,isBowCharging:l}=e,c=(0,o.useRef)(null),h=(0,o.useRef)(0),u=(0,o.useRef)(null),d=(0,o.useRef)(0),m=[-.8,.75,.75],p=[.8,.75,.75],f=(0,o.useRef)(0),x=(0,o.useRef)(!1),j=(0,o.useRef)(0);(0,g.F)((e,r)=>{if(c.current&&u.current){if(l)c.current.position.x+=(-.8-c.current.position.x)*.3,c.current.position.y+=(-.2-c.current.position.y)*.3,c.current.position.z+=(.5-c.current.position.z)*.3,u.current.position.x+=(.8-u.current.position.x)*.3,u.current.position.y+=(-.2-u.current.position.y)*.3,u.current.position.z+=(.5-u.current.position.z)*.3,c.current.rotation.x=I(c.current.rotation.x,1.2*Math.PI,.3),c.current.rotation.z=I(c.current.rotation.z,.15*Math.PI,.3),u.current.rotation.x=I(u.current.rotation.x,1.2*Math.PI,.3),u.current.rotation.z=I(u.current.rotation.z,-(.15*Math.PI),.3),h.current=0,d.current=0,j.current=0,f.current=0,x.current=!1;else if(t){if(0===h.current&&0===d.current&&(x.current=!1),c.current){if(j.current<.15)j.current+=r;else{0===h.current&&i(),h.current+=7*r;let e=Math.min(h.current/Math.PI,1),t=m[0]+1.2*Math.sin(e*Math.PI),n=m[1]+-.3*Math.sin(e*Math.PI*2),o=m[2]+2*Math.sin(e*Math.PI);c.current.position.set(t,n,o);let s=.5*Math.PI*Math.sin(e*Math.PI),a=.3*Math.PI*Math.sin(e*Math.PI),l=.2*Math.PI*Math.sin(e*Math.PI);c.current.rotation.set(s,a,l),h.current>=Math.PI&&(h.current=0,j.current=0,c.current.rotation.set(0,0,0),c.current.position.set(...m))}}if(u.current){0===d.current&&a(),d.current+=7*r;let e=Math.min(d.current/Math.PI,1),t=p[0]-1.2*Math.sin(e*Math.PI),o=p[1]+-.3*Math.sin(e*Math.PI*2),s=p[2]+2*Math.sin(e*Math.PI);u.current.position.set(t,o,s);let i=.5*Math.PI*Math.sin(e*Math.PI),l=-(.3*Math.PI*Math.sin(e*Math.PI)),c=-(.2*Math.PI*Math.sin(e*Math.PI));u.current.rotation.set(i,l,c),d.current>=Math.PI&&(d.current=0,f.current=0,u.current.rotation.set(0,0,0),u.current.position.set(...p),x.current=!0,n())}}else c.current.position.x+=(m[0]-c.current.position.x)*.2,c.current.position.y+=(m[1]-c.current.position.y)*.2,c.current.position.z+=(m[2]-c.current.position.z)*.2,u.current.position.x+=(p[0]-u.current.position.x)*.2,u.current.position.y+=(p[1]-u.current.position.y)*.2,u.current.position.z+=(p[2]-u.current.position.z)*.2,c.current.rotation.x*=.85,c.current.rotation.y*=.85,c.current.rotation.z*=.85,u.current.rotation.x*=.85,u.current.rotation.y*=.85,u.current.rotation.z*=.85,t||(h.current=0,d.current=0,j.current=0,f.current=0,x.current=!1)}});let y=()=>{let e=new s.ypk;return e.moveTo(0,0),e.lineTo(-.15,.1),e.lineTo(-.2,0),e.lineTo(-.2,-.05),e.lineTo(0,0),e.lineTo(.15,.1),e.lineTo(.2,0),e.lineTo(.3,0),e.lineTo(0,0),e.lineTo(0,.05),e.quadraticCurveTo(.3,.15,.5,.2),e.quadraticCurveTo(.7,.25,.9,.15),e.quadraticCurveTo(1,.1,1.1,0),e.quadraticCurveTo(1,-.05,.8,-.1),e.lineTo(.7,-.15),e.lineTo(.65,-.1),e.quadraticCurveTo(.4,-.08,.2,-.05),e.quadraticCurveTo(.1,-.02,0,0),e},v=()=>{let e=new s.ypk;return e.moveTo(0,0),e.lineTo(-.13,.08),e.lineTo(-.18,0),e.lineTo(-.08,-.04),e.lineTo(0,0),e.lineTo(.13,.08),e.lineTo(.18,0),e.lineTo(.08,-.04),e.lineTo(0,0),e.lineTo(0,.04),e.quadraticCurveTo(.28,.13,.48,.18),e.quadraticCurveTo(.68,.23,.88,.13),e.quadraticCurveTo(.98,.08,1.08,0),e.quadraticCurveTo(.98,-.04,.78,-.08),e.lineTo(.68,-.13),e.lineTo(.63,-.08),e.quadraticCurveTo(.38,-.06,.18,-.04),e.quadraticCurveTo(.08,-.02,0,0),e},M={steps:2,depth:.02,bevelEnabled:!0,bevelThickness:.004,bevelSize:.01,bevelSegments:3},w={...M,depth:.025,bevelThickness:.003,bevelSize:.004,bevelOffset:0};return(0,r.jsxs)("group",{position:[0,0,0],rotation:[0,0,0],scale:[.8,.8,.8],children:[(0,r.jsxs)("group",{ref:c,position:[m[0],m[1],m[2]],rotation:[0,0,Math.PI],scale:[1,1,1],children:[(0,r.jsxs)("group",{position:[0,-.125,0],rotation:[0,0,-Math.PI],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.015,.02,.45,12]}),(0,r.jsx)("meshStandardMaterial",{color:"#2a3b4c",roughness:.7})]}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("mesh",{position:[0,.175-.065*t,0],children:[(0,r.jsx)("torusGeometry",{args:[.0225,.004,8,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#1a2b3c",metalness:.6,roughness:.4})]},t))]}),(0,r.jsxs)("group",{position:[0,.3,0],rotation:[0,Math.PI/2,Math.PI/2],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("extrudeGeometry",{args:[y(),M]}),(0,r.jsx)("meshStandardMaterial",{color:"#0066ff",emissive:"#0088ff",emissiveIntensity:3,metalness:.9,roughness:.2,opacity:.9,transparent:!0})]}),(0,r.jsxs)("mesh",{position:[0,0,-.02],children:["  ",(0,r.jsx)("extrudeGeometry",{args:[v(),{...w,depth:.06}]}),(0,r.jsx)("meshStandardMaterial",{color:"#0033ff",emissive:"#0066ff",emissiveIntensity:8,metalness:.7,roughness:.1,opacity:.4,transparent:!0})]}),(0,r.jsx)("pointLight",{color:"#0088ff",intensity:1,distance:2,decay:2})]})]}),(0,r.jsxs)("group",{ref:u,position:[p[0],p[1],p[2]],rotation:[0,0,Math.PI],scale:[1,1,1],children:[(0,r.jsxs)("group",{position:[0,-.125,0],rotation:[0,0,-Math.PI],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.015,.02,.45,12]}),(0,r.jsx)("meshStandardMaterial",{color:"#2a3b4c",roughness:.7})]}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("mesh",{position:[0,.175-.065*t,0],children:[(0,r.jsx)("torusGeometry",{args:[.0225,.004,8,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#1a2b3c",metalness:.6,roughness:.4})]},t))]}),(0,r.jsxs)("group",{position:[0,.3,0],rotation:[0,Math.PI/2,Math.PI/2],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("extrudeGeometry",{args:[y(),M]}),(0,r.jsx)("meshStandardMaterial",{color:"#0066ff",emissive:"#0088ff",emissiveIntensity:3,metalness:.9,roughness:.2,opacity:.9,transparent:!0})]}),(0,r.jsxs)("mesh",{position:[0,0,-.02],children:["  ",(0,r.jsx)("extrudeGeometry",{args:[v(),{...w,depth:.06}]}),(0,r.jsx)("meshStandardMaterial",{color:"#0033ff",emissive:"#0066ff",emissiveIntensity:8,metalness:.7,roughness:.1,opacity:.4,transparent:!0})]}),(0,r.jsx)("pointLight",{color:"#0088ff",intensity:2,distance:2,decay:2})]})]})]})}function _(e){let{position:t,direction:n,chargeProgress:i,isCharging:a,onRelease:l}=e,c=(0,o.useRef)(null),h=(0,o.useRef)(a),u=(0,o.useRef)(null);return(0,o.useEffect)(()=>{if(c.current){let e=Math.atan2(n.x,n.z);c.current.rotation.set(0,e,0)}},[n]),(0,g.F)(()=>{!h.current&&a&&(u.current=Date.now()),h.current&&!a&&(l(Math.min((u.current?(Date.now()-u.current)/1e3:0)/2,1)),u.current=null),h.current=a}),(0,r.jsxs)("group",{ref:c,position:t.toArray(),children:[(0,r.jsxs)("mesh",{rotation:[Math.PI/2,0,0],children:[(0,r.jsx)("tubeGeometry",{args:[new s.s0K(new s.Pq0(-.8,0,0),new s.Pq0(-.85,.3,0),new s.Pq0(.85,.3,0),new s.Pq0(.8,0,0)),64,.035,8,!1]}),(0,r.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:2,transparent:!0,opacity:.8})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("tubeGeometry",{args:[(e=>{let t=2*e;return new s.s0K(new s.Pq0(-.8,0,0),new s.Pq0(0,-.1,-t),new s.Pq0(0,.1,-t),new s.Pq0(.8,0,0))})(i),32,.02,8,!1]}),(0,r.jsx)("meshStandardMaterial",{color:"#ffffff",emissive:"#ffffff",emissiveIntensity:4,transparent:!0,opacity:.6})]}),(0,r.jsxs)("group",{children:[(0,r.jsxs)("mesh",{position:[-.3,0,.32],rotation:[Math.PI/2,0,Math.PI/6],children:[(0,r.jsx)("boxGeometry",{args:[.6,.02,.05]}),(0,r.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:2,transparent:!0,opacity:.8})]}),(0,r.jsxs)("mesh",{position:[.3,0,.32],rotation:[Math.PI/2,0,-Math.PI/6],children:[(0,r.jsx)("boxGeometry",{args:[.6,.02,.05]}),(0,r.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:2,transparent:!0,opacity:.8})]})]}),a&&(0,r.jsxs)("group",{position:[0,0,.8-2*i],rotation:[Math.PI/2,0,0],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.002,.02,.7,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:3,transparent:!0,opacity:.9})]}),(0,r.jsxs)("mesh",{position:[0,.35,0],children:[(0,r.jsx)("coneGeometry",{args:[.03,.1,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:3,transparent:!0,opacity:.9})]})]}),a&&(0,r.jsxs)("mesh",{rotation:[-Math.PI/2,-Math.PI,0],children:[(0,r.jsx)("tubeGeometry",{args:[new s.VnP(new s.Pq0(0,0,0),new s.Pq0(0,0,10)),64,.01,8,!1]}),(0,r.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:1,transparent:!0,opacity:.3*i})]})]})}function R(e){let{position:t,onComplete:n}=e,s=(0,o.useRef)(null),i=(0,o.useRef)(0),a=(0,o.useRef)(0);return(0,g.F)((e,t)=>{if(!s.current)return;if(a.current<.05){a.current+=t;return}i.current+=t;let r=Math.min(i.current/.75,1);if(r<1){s.current.position.y=40*(1-r);let e=r<.9?1:1-(r-.9)/.1;s.current.scale.set(e,e,e)}else n()}),(0,r.jsxs)("group",{ref:s,position:[t.x,25,t.z],visible:a.current>=.05,children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.35,.35,20,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff6600",emissive:"#ff4400",emissiveIntensity:15,transparent:!0,opacity:.95})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.7,.7,20,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff6600",emissive:"#ff4400",emissiveIntensity:10,transparent:!0,opacity:.7})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[1,1,20,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff8800",emissive:"#ff6600",emissiveIntensity:8,transparent:!0,opacity:.4})]}),[void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("mesh",{rotation:[0,t*Math.PI/1.5,0],children:[(0,r.jsx)("torusGeometry",{args:[1.2,.08,8,32]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff6600",emissive:"#ff4400",emissiveIntensity:8,transparent:!0,opacity:.3})]},t)),[...Array(8)].map((e,t)=>(0,r.jsxs)("mesh",{position:[1*Math.cos(t*Math.PI/4),(t-4)*2,1*Math.sin(t*Math.PI/4)],children:[(0,r.jsx)("sphereGeometry",{args:[.15,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff6600",emissive:"#ff4400",emissiveIntensity:12,transparent:!0,opacity:.6})]},t)),(0,r.jsx)("pointLight",{position:[0,-10,0],color:"#ff4400",intensity:25,distance:12}),(0,r.jsx)("pointLight",{position:[0,0,0],color:"#ff6600",intensity:15,distance:6})]})}var T=n(2027);function E(e){let{damage:t,position:n,isCritical:s=!1,isLightning:i=!1,isBlizzard:a=!1,isHealing:l=!1,isBoneclaw:c=!1,onComplete:h}=e;console.log("DamageNumber props:",{damage:t,isCritical:s,isBlizzard:a,isLightning:i,isHealing:l,isBoneclaw:c});let u=(0,o.useRef)(null),d=(0,o.useRef)(Date.now()),m=n.y+3.5,{camera:p}=(0,g.D)(),f=Date.now()%1e3/1e3,x=.3*Math.sin(f*Math.PI*2),j=.2*Math.cos(f*Math.PI*2);return(0,g.F)(()=>{if(!u.current)return;let e=(Date.now()-d.current)/1e3;if(e>=1.5){h();return}u.current.quaternion.copy(p.quaternion);let t=e/1.5,r=m+1.2*(1-Math.pow(1-t,3)),o=n.x+x;u.current.position.set(o,r+j,n.z),u.current.material.opacity=Math.min(1,3*(1-t))}),(0,r.jsx)(T.E,{ref:u,position:[n.x,m,n.z],fontSize:.5,color:l?"#338C66":c?"#39ff14":s?"#ff0000":i?"#ffff00":a?"#61EDFF":"#ffffff",anchorX:"center",anchorY:"middle",outlineWidth:.1,outlineColor:"#000000","material-transparent":!0,"material-depthTest":!1,children:l?"+".concat(t):t})}function G(e){let{children:t,position:n=[0,0,0],lockX:i=!1,lockY:a=!1,lockZ:l=!1}=e,c=(0,o.useRef)(null);return(0,g.F)(e=>{let{camera:t}=e;if(!c.current)return;let n=c.current.position,r=t.position,o=new s.Pq0().subVectors(r,n),h=c.current.rotation.clone();a||(h.y=Math.atan2(o.x,o.z)),i||(h.x=Math.atan2(-o.y,Math.sqrt(o.x*o.x+o.z*o.z))),l||(h.z=0),c.current.rotation.set(h.x,h.y,h.z)}),(0,r.jsx)("group",{ref:c,position:n,children:t})}function q(e){let{parentRef:t}=e,n=(0,o.useRef)([]),i=(0,o.useRef)([]),[a,l]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{if(t.current){let e=t.current.position.clone();i.current=Array(12).fill(0).map(()=>e.clone()),l(!0)}},[t]),(0,g.F)(()=>{if(!t.current||!a)return;let e=t.current.position.clone();i.current.unshift(e),i.current=i.current.slice(0,12),n.current.forEach((e,t)=>{e&&i.current[t]&&(e.position.copy(i.current[t]),e.scale.setScalar(1-t/12*.3),e.material&&e.material instanceof s.V9B&&(e.material.opacity=(1-t/12)*.3))})}),a)?(0,r.jsx)(r.Fragment,{children:Array.from({length:12}).map((e,t)=>(0,r.jsxs)("mesh",{ref:e=>{e&&(n.current[t]=e)},children:[(0,r.jsx)("sphereGeometry",{args:[.5,32,32]}),(0,r.jsx)("meshBasicMaterial",{color:new s.Q1f("#39ff14"),transparent:!0,opacity:.3,depthWrite:!1})]},t))}):null}function D(e){let{collectedBones:t,isLeftWing:n}=e,i=(0,o.useRef)(null),a=[{pos:new s.Pq0(n?-.3:.3,.4,0),rot:new s.O9p(0,0,n?-Math.PI/6:Math.PI/6),scale:1.4},{pos:new s.Pq0(n?-.6:.6,.5,0),rot:new s.O9p(0,0,n?-Math.PI/4:Math.PI/4),scale:1.3},{pos:new s.Pq0(n?-.8:.8,.7,0),rot:new s.O9p(0,0,n?-Math.PI/2.5:Math.PI/2.5),scale:1},{pos:new s.Pq0(n?-1.1:1.1,.8,.1),rot:new s.O9p(.1,0,n?-Math.PI/2.2:Math.PI/2.2),scale:.9},{pos:new s.Pq0(n?-1.4:1.4,.9,.2),rot:new s.O9p(.2,0,n?-Math.PI/2:Math.PI/2),scale:.8}],l=()=>(0,r.jsxs)("group",{children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.02,.015,.4,4]})," ",(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,r.jsxs)("mesh",{position:new s.Pq0(0,.2,0),rotation:new s.O9p(0,0,Math.PI/6),children:[(0,r.jsx)("sphereGeometry",{args:[.035,4,4]})," ",(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]}),(0,r.jsxs)("mesh",{position:new s.Pq0(0,-.2,0),rotation:new s.O9p(0,0,-Math.PI/6),children:[(0,r.jsx)("sphereGeometry",{args:[.03,4,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]});return(0,r.jsx)("group",{ref:i,rotation:new s.O9p(0,Math.PI,0),position:new s.Pq0(0,-.3,0),children:a.slice(0,Math.min(15,t)).map((e,t)=>(0,r.jsx)("group",{position:e.pos,rotation:e.rot,scale:e.scale,children:l()},"bone-".concat(t)))})}let z=()=>(0,r.jsxs)("group",{rotation:[Math.PI/3,0,0],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.02,.015,.2,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,r.jsxs)("mesh",{position:new s.Pq0(0,.1,0),rotation:new s.O9p(0,0,Math.PI/6),children:[(0,r.jsx)("sphereGeometry",{args:[.025,4,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]}),(0,r.jsxs)("mesh",{position:new s.Pq0(0,-.1,0),rotation:new s.O9p(0,0,-Math.PI/6),children:[(0,r.jsx)("sphereGeometry",{args:[.02,4,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]});function B(e){let{parentRef:t}=e,n=(0,o.useRef)([]),s=(0,o.useRef)(null);return(0,g.F)(()=>{if(!t.current||!s.current)return;let e=t.current.position;s.current.position.set(e.x,0,e.z),n.current.forEach((e,t)=>{let n=t/12*Math.PI*2+.001*Date.now(),r=.55*Math.cos(n),o=.55*Math.sin(n),s=.08*Math.sin(.002*Date.now()+t);e.position.set(r,s+.1,o),e.rotation.y=n+Math.PI/2})}),(0,r.jsx)("group",{ref:s,children:Array.from({length:12}).map((e,t)=>(0,r.jsx)("mesh",{ref:e=>{e&&(n.current[t]=e)},children:z()},t))})}let A=()=>{let e=(0,o.useRef)(null),t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,r.jsxs)("group",{position:[0,e,0],scale:t,children:[(0,r.jsxs)("group",{rotation:[0,0,-Math.PI/3],children:[(0,r.jsxs)("mesh",{position:[.1,0,0],rotation:[1,Math.PI/2,0],children:[(0,r.jsx)("torusGeometry",{args:[.2,.015,8,12,.75*Math.PI]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,r.jsxs)("mesh",{position:[.3,-.15,0],children:[(0,r.jsx)("sphereGeometry",{args:[.02,4,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]}),(0,r.jsxs)("group",{rotation:[0,0,Math.PI/3],children:[(0,r.jsxs)("mesh",{position:[-.1,0,0],rotation:[0,-Math.PI/2,0],children:[(0,r.jsx)("torusGeometry",{args:[.2,.015,8,12,.75*Math.PI]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,r.jsxs)("mesh",{position:[-.3,-.15,0],children:[(0,r.jsx)("sphereGeometry",{args:[.02,4,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.02,.02,.1,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]})]})};return(0,r.jsx)("group",{ref:e,position:[0,.04,-0],rotation:[.25,Math.PI+Math.PI/.97,0],children:(0,r.jsxs)("group",{children:[(0,r.jsxs)("group",{children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.04,.04,.8,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),[-.3,-.15,0,.15,.3].map((e,t)=>(0,r.jsxs)("group",{position:[0,e,0],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.06,.06,.04,6]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]}),(0,r.jsxs)("mesh",{position:[0,0,.04],children:[(0,r.jsx)("boxGeometry",{args:[.04,.03,.04]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]},t))]}),(0,r.jsxs)("group",{position:[0,0,0],children:[t(.45,.7),t(.3,.8),t(.15,.9),t(0,1),t(-.15,.9),t(-.3,.8),t(-.45,.7)]})]})})},F=()=>{let e=(0,o.useRef)(null);(0,g.F)(t=>{let{clock:n}=t;if(!e.current)return;let r=n.getElapsedTime();e.current.rotation.y=.3*Math.sin(.5*r),e.current.rotation.x=.1+.05*Math.sin(.7*r)});let t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=-.8*Math.pow(t/15,2.5),o=Math.PI/3,s=Math.atan2(-.8*Math.pow((t+1)/15,2.5)-n,.1*(1-t/20))+(0===t?o:0);return(0,r.jsxs)("group",{position:[0,-n,-(.1*t)*(1-t/40)],scale:e,rotation:[-s,0,0],children:[(0,r.jsxs)("mesh",{rotation:[Math.PI/2,0,0],children:[(0,r.jsx)("cylinderGeometry",{args:[.04,.035,.08,6]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,r.jsxs)("group",{rotation:[Math.PI/2,0,Math.PI/2],children:[(0,r.jsxs)("mesh",{position:[0,.05,0],children:[(0,r.jsx)("coneGeometry",{args:[.02,.06,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]}),(0,r.jsxs)("mesh",{position:[.05,0,0],rotation:[0,0,-Math.PI/2],children:[(0,r.jsx)("coneGeometry",{args:[.015,.04,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]}),(0,r.jsxs)("mesh",{position:[-.085,0,0],rotation:[0,0,Math.PI/2],children:[(0,r.jsx)("coneGeometry",{args:[.015,.04,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]}),(0,r.jsxs)("mesh",{position:[0,-.01,.13],rotation:[Math.PI/2,0,0],children:[(0,r.jsx)("sphereGeometry",{args:[.03,6,6]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]})};return(0,r.jsx)("group",{ref:e,position:[0,-.65,-.35],rotation:[-.1,0,0],children:[...Array(15)].map((e,n)=>t(1-.04*n,n))})},N=()=>(0,r.jsxs)("group",{children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("boxGeometry",{args:[.15,.03,.03]}),(0,r.jsx)("meshStandardMaterial",{color:"#67f2b9",transparent:!0,opacity:.6,emissive:"#67f2b9",emissiveIntensity:.5})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[.02,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#39ff14",emissive:"#39ff14",emissiveIntensity:2,transparent:!0,opacity:.5})]})]});function L(e){let{parentRef:t}=e,n=(0,o.useRef)([]),s=(0,o.useRef)(null);return(0,g.F)(e=>{let{clock:r}=e;if(!t.current||!s.current)return;let o=t.current.position;s.current.position.set(o.x,0,o.z),n.current.forEach((e,t)=>{if(!e)return;let n=r.getElapsedTime(),o=t/25*.6,s=t/25*Math.PI*4+2*n,i=.5*(1-.8*o),a=Math.cos(s)*i,l=Math.sin(s)*i;e.position.set(a,o,l),e.rotation.y=s+Math.PI/2,e.rotation.x=Math.PI/6,e.rotation.z=.1*Math.sin(3*n+t);let c=e.children[0];c&&c.material&&(c.material.opacity=Math.max(.1,1-2*o))})}),(0,r.jsxs)("group",{ref:s,children:[Array.from({length:25}).map((e,t)=>(0,r.jsx)("group",{ref:e=>{e&&(n.current[t]=e)},children:N()},t)),(0,r.jsx)("pointLight",{color:"#67f2b9",intensity:1,distance:1.2,position:[0,.25,0]})]})}function H(e){let t=.11>Math.random();return{damage:t?2*e:e,isCritical:t}}let O=Math.PI/2;function W(e){let{position:t,direction:n,onComplete:i}=e,a=(0,o.useRef)(null),l=(0,o.useRef)(0),c=(0,o.useRef)(0),h=new s.Q1f("#39ff14"),u=new s.Pq0(t.x+5*n.x,0,t.z+5*n.z),d=new s.Pq0(-n.z,0,n.x).normalize(),m=u.clone().add(d.clone().multiplyScalar(-1.35)),p=u.clone().add(d.clone().multiplyScalar(1.35));(0,g.F)((e,t)=>{if(!a.current)return;if(c.current<.125){c.current+=t;return}l.current+=t;let n=Math.min(l.current/1.2,1);if(n<1){a.current.position.y=3*(1-n);let e=n<.9?1:1-(n-.9)/.2;a.current.scale.set(e,e,e)}else i()});let f=(e,t)=>(0,r.jsxs)("group",{position:[e.x,0,e.z],rotation:[Math.PI/6,Math.atan2(n.x,n.z),0],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.1,.1,15,16]}),(0,r.jsx)("shaderMaterial",{transparent:!0,depthWrite:!1,blending:s.EZo,vertexShader:"\n            varying vec2 vUv;\n            void main() {\n              vUv = uv;\n              gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n            }\n          ",fragmentShader:"\n            uniform vec3 uColor;\n            varying vec2 vUv;\n            void main() {\n              float strength = 1.0 - length(vUv - vec2(0.5));\n              vec3 glowColor = mix(uColor, vec3(1.0), 0.3);\n              gl_FragColor = vec4(glowColor, strength * 0.95);\n            }\n          ",uniforms:{uColor:{value:h}}})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.2,.2,15,16]}),(0,r.jsx)("shaderMaterial",{transparent:!0,depthWrite:!1,blending:s.EZo,vertexShader:"\n            varying vec2 vUv;\n            void main() {\n              vUv = uv;\n              gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n            }\n          ",fragmentShader:"\n            uniform vec3 uColor;\n            varying vec2 vUv;\n            void main() {\n              float strength = 1.0 - length(vUv - vec2(0.5));\n              vec3 glowColor = mix(uColor, vec3(1.0), 0.4);\n              gl_FragColor = vec4(glowColor, strength * 0.7);\n            }\n          ",uniforms:{uColor:{value:h}}})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.35,.35,15,16]}),(0,r.jsx)("shaderMaterial",{transparent:!0,depthWrite:!1,blending:s.EZo,vertexShader:"\n            varying vec2 vUv;\n            void main() {\n              vUv = uv;\n              gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n            }\n          ",fragmentShader:"\n            uniform vec3 uColor;\n            varying vec2 vUv;\n            void main() {\n              float strength = 1.0 - length(vUv - vec2(0.5));\n              vec3 glowColor = mix(uColor, vec3(1.0), 0.5);\n              gl_FragColor = vec4(glowColor, strength * 0.4);\n            }\n          ",uniforms:{uColor:{value:h}}})]}),(0,r.jsx)("pointLight",{position:[0,-5,0],color:h,intensity:20,distance:6}),(0,r.jsx)("pointLight",{position:[0,0,0],color:h,intensity:15,distance:3})]});return(0,r.jsxs)("group",{ref:a,visible:c.current>=.125,children:[f(m,!1),f(u,!0),f(p,!1)]})}function U(e){let{position:t,direction:n,onComplete:s,parentRef:i,onHitTarget:a,enemyData:l,onSwingComplete:c}=e,h=(0,o.useRef)(null),u=(0,o.useRef)(0),d=(0,o.useRef)(!1),m=(0,o.useRef)(!1),p=(e,t)=>(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[t,.8*t,e,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),f=e=>(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[e,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),x=(e,t)=>(0,r.jsxs)("group",{children:[(0,r.jsx)("group",{position:[t/2,0,0],children:p(e,.06)}),(0,r.jsx)("group",{position:[-t/2,0,0],children:p(e,.06)}),(0,r.jsx)("group",{position:[0,e/2,0],children:f(.08)}),(0,r.jsx)("group",{position:[0,-e/2,0],children:f(.08)})]});return(0,g.F)((e,t)=>{if(!h.current||!(null==i?void 0:i.current))return;u.current+=6*t;let r=Math.min(u.current/Math.PI,1);if(r>=1){u.current=0,null==c||c(h.current.position.clone(),n),s();return}let o=i.current.position.clone(),p=i.current.rotation.y,f=-(1.2*Math.sin(r*Math.PI))+2,x=Math.cos(r*Math.PI)+1,g=2*Math.sin(r*Math.PI)-.5,j=f*Math.cos(p)+g*Math.sin(p),y=-f*Math.sin(p)+g*Math.cos(p);h.current.position.set(o.x+j,o.y+x,o.z+y);let v=-(Math.cos(r*Math.PI)/(Math.PI/1)),M=p+Math.PI/2-r*Math.PI,w=-(Math.PI/2*Math.sin(r*Math.PI));h.current.rotation.set(v,M,w),.1>Math.abs(r-.5)&&!d.current&&(d.current=!0,m.current=!0,(function(e,t,n){let r=[];return n.forEach(n=>{if(n.health<=0)return;let o=n.position.clone().sub(e);if(o.length()>7.5||(o.normalize(),Math.acos(o.dot(t))>O/2))return;let{damage:s,isCritical:i}=H(67);r.push({targetId:n.id,damage:s,isCritical:i,position:n.position.clone()})}),r})(h.current.position,n,l).forEach(e=>{null==a||a(e.targetId,e.damage,e.isCritical,e.position,!0)}))}),(0,r.jsxs)(r.Fragment,{children:[m.current&&(0,r.jsx)(W,{position:t,direction:n,onComplete:()=>{m.current=!1}}),(0,r.jsx)("group",{ref:h,position:t,rotation:[0,Math.atan2(n.x,n.z),Math.PI/4],children:(0,r.jsxs)("group",{children:[x(1,.15),(0,r.jsxs)("group",{position:[.25,-.85,.21],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[.12,12,12]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,r.jsxs)("group",{rotation:[-.7,-0,Math.PI/5],children:[x(.8,.12),(0,r.jsxs)("group",{position:[0,-.5,0],rotation:[0,0,Math.PI/5.5],children:[f(.09),(0,r.jsxs)("group",{position:[0,-.1,0],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("boxGeometry",{args:[.2,.15,.08]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4})]}),[-.08,-.04,0,.04,.08].map((e,t)=>(0,r.jsxs)("group",{position:[e,-.1,0],rotation:[0,0,(t-2)*Math.PI/10],children:[p(.5,.02),(0,r.jsx)("group",{position:[.025,-.3,0],rotation:[0,0,Math.PI+Math.PI/16],children:(0,r.jsxs)("mesh",{children:[(0,r.jsx)("coneGeometry",{args:[.03,.3,6]}),(0,r.jsx)("meshStandardMaterial",{color:"#d4d4d4",roughness:.3,metalness:.4})]})})]},t))]})]})]})]})]})})]})}function Q(e){let{initialPosition:t,onComplete:n,type:s}=e,i=(0,o.useRef)(null),a=(0,o.useRef)(2*Math.random()+4),l=(0,o.useRef)({x:1*Math.random(),y:.25*Math.random(),z:1*Math.random()}),c=(0,o.useRef)(t.length()),h=(0,o.useRef)(Math.atan2(t.z,t.x));return(0,g.F)((e,t)=>{i.current&&("falling"===s?(i.current.position.y-=a.current*t,i.current.position.y<0&&n()):(h.current+=t,i.current.position.x=Math.cos(h.current)*c.current,i.current.position.z=Math.sin(h.current)*c.current,h.current>8*Math.PI&&n()),i.current.rotation.x+=l.current.x,i.current.rotation.y+=l.current.y,i.current.rotation.z+=l.current.z)}),(0,r.jsxs)("mesh",{ref:i,position:t,children:[(0,r.jsx)("tetrahedronGeometry",{args:[.075]}),(0,r.jsx)("meshStandardMaterial",{color:"#80ffff",emissive:"#40a0ff",emissiveIntensity:2,transparent:!0,opacity:.8}),(0,r.jsx)("pointLight",{color:"#80ffff",intensity:1,distance:2,decay:2})]})}function Y(e){let{onComplete:t,enemyData:n=[],onHitTarget:i,parentRef:a}=e,l=(0,o.useRef)(null),c=(0,o.useRef)(0),h=(0,o.useRef)(0),[u,d]=(0,o.useState)([]);return(0,g.F)((e,r)=>{if(!l.current||!(null==a?void 0:a.current))return;let o=a.current.position;if(l.current.position.copy(o),c.current+=r,c.current>=6){t();return}if(l.current.rotation.y+=6.5*r,.22>Math.random()){let e=Math.random()*Math.PI*2,t=1.01*Math.random()/50,n=new s.Pq0(Math.cos(e)*t,2.35+1.7*Math.random(),Math.sin(e)*t);d(e=>[...e.slice(-20),{id:Date.now()+Math.random(),position:n,type:"orbital"}])}if(.5>Math.random()){let e=Math.random()*Math.PI*2,t=2.5*Math.random(),n=new s.Pq0(Math.cos(e)*t,1.2+3*Math.random(),Math.sin(e)*t);d(e=>[...e.slice(-120),{id:Date.now()+Math.random(),position:n,type:"falling"}])}let u=Date.now();u-h.current>=1e3&&(h.current=u,n&&i&&(function(e,t){let n=[];return t.forEach(t=>{if(!(t.health<=0)&&4>=t.position.distanceTo(e)){let{damage:e,isCritical:r}=H(17);n.push({targetId:t.id,damage:e,isCritical:r,position:t.position.clone()})}}),n})(o,n).forEach(e=>{i(e.targetId,e.damage,e.isCritical,e.position,!0)}))}),(0,r.jsxs)("group",{ref:l,children:[(0,r.jsx)("pointLight",{position:[0,3,0],color:"#80ffff",intensity:1.5,distance:3,decay:2}),u.map(e=>(0,r.jsx)(Q,{initialPosition:e.position,type:e.type,onComplete:()=>{d(t=>t.filter(t=>t.id!==e.id))}},e.id))]})}function V(e){let{onComplete:t,parentRef:n}=e,s=(0,o.useRef)(null),i=(0,o.useRef)(0);return(0,g.F)((e,r)=>{if(!s.current||!n.current)return;if(s.current.position.copy(n.current.position),i.current+=r,i.current>=5){t();return}let o=-.05*Math.sin(2*i.current)+1;s.current.scale.setScalar(2*o)}),(0,r.jsxs)("group",{ref:s,children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[-1,32,32]}),(0,r.jsx)("meshStandardMaterial",{color:"#ffff00",emissive:"#ffff00",emissiveIntensity:1.5,transparent:!0,opacity:.2})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[.9,32,32]}),(0,r.jsx)("meshStandardMaterial",{color:"#ffffff",emissive:"#ffff00",emissiveIntensity:2,transparent:!0,opacity:.1})]}),Array.from({length:8}).map((e,t)=>(0,r.jsxs)("mesh",{position:[1.2*Math.sin(t*Math.PI*.25),1.2*Math.cos(t*Math.PI*.25),0],children:[(0,r.jsx)("sphereGeometry",{args:[.07,16,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#ffff00",emissive:"#ffff00",emissiveIntensity:2,transparent:!0,opacity:.6})]},t)),(0,r.jsx)("pointLight",{color:"#ffff00",intensity:2,distance:5,decay:2})]})}let Z=e=>{let{maxHealth:t,onHealthChange:n,duration:r,onHeal:s,onComplete:i}=e,[a,l]=(0,o.useState)(!1),c=(0,o.useRef)(null),h=(0,o.useRef)(0),u=(0,o.useRef)(0),d=(0,o.useCallback)(()=>{c.current&&(clearInterval(c.current),c.current=null),l(!1),i()},[i]);return{isRetributing:a,startRetribute:(0,o.useCallback)(()=>{l(!0),h.current=0,u.current=0,c.current&&clearInterval(c.current),c.current=setInterval(()=>{if(h.current>=500){d();return}n(e=>Math.min(e+5,t)),h.current+=5,s(5,!0)},1e3),setTimeout(()=>{d()},1e3*r)},[d,t,n,r,s]),stopRetribute:d}},X=e=>{let{parentRef:t}=e,[n,r]=(0,o.useState)(!1);return{isActive:n,activateFirebeam:(0,o.useCallback)(()=>{if(!t.current)return;let e=t.current.position.clone();e.y+=1;let n=new s.Pq0(0,0,1).applyQuaternion(t.current.quaternion);return r(!0),{position:e,direction:n,onComplete:()=>r(!1),damage:10}},[t]),deactivateFirebeam:(0,o.useCallback)(()=>{r(!1)},[])}};function K(e){let{parentRef:t,charges:n,orbitRadius:s=.6,orbitSpeed:i=1.2,particleSize:a=.09,particleCount:l=8,activeColor:c="#00ff44",inactiveColor:h="#333333",activeEmissiveIntensity:u=2,inactiveEmissiveIntensity:d=.5,activeOpacity:m=.8,inactiveOpacity:p=.4}=e,f=(0,o.useRef)([]);return(0,g.F)(()=>{t.current&&f.current.forEach((e,t)=>{let n=t/l*Math.PI*2+.001*Date.now()*i,r=Math.cos(n)*s,o=Math.sin(n)*s,a=.1*Math.sin(.002*Date.now()+t);e.position.set(r,a,o)})}),(0,r.jsx)(r.Fragment,{children:Array.from({length:l}).map((e,t)=>{let o=n[t];return(0,r.jsxs)("mesh",{ref:e=>{e&&(f.current[t]=e)},children:[(0,r.jsx)("sphereGeometry",{args:[a,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:(null==o?void 0:o.available)?c:h,emissive:(null==o?void 0:o.available)?c:h,emissiveIntensity:(null==o?void 0:o.available)?u:d,transparent:!0,opacity:(null==o?void 0:o.available)?m:p})]},t)})})}let J=e=>{let{parentRef:t,onHit:n,enemyData:r,setActiveEffects:s,charges:i,setCharges:a}=e,l=(0,o.useRef)(0),c=(0,o.useRef)(null),h=(0,o.useRef)(null),u=(0,o.useRef)(0),d=(0,o.useRef)(Date.now()),{isActive:m,activateFirebeam:p,deactivateFirebeam:f}=X({onHit:n,parentRef:t}),x=(0,o.useCallback)(e=>{e&&clearInterval(e),h.current&&(clearInterval(h.current),h.current=null),null!==c.current&&(s(e=>e.filter(e=>e.id!==c.current)),c.current=null),f()},[f,s]),g=(0,o.useCallback)(()=>{let e=i.findIndex(e=>e.available);return -1!==e&&(a(t=>t.map((t,n)=>n===e?{...t,available:!1,cooldownStartTime:Date.now()}:t)),setTimeout(()=>{a(t=>t.map((t,n)=>n===e?{...t,available:!0,cooldownStartTime:null}:t))},9e3),!0)},[i,a]),j=(0,o.useCallback)(()=>{if(!g())return;let e=p();if(!e)return;let{position:t,direction:o,damage:i}=e,a=l.current++;return c.current=a,u.current=0,d.current=Date.now(),s(e=>[...e,{id:a,type:"firebeam",position:t,direction:o}]),h.current=setInterval(()=>{if(!m){x();return}let e=Date.now();if(e-d.current>=1e3){if(!g()){x();return}d.current=e}r.forEach(e=>{if(e.health<=0)return;let r=e.position.clone().sub(t),s=o.angleTo(r),a=r.length();s<.3&&a<20&&n(e.id,i)})},500),h.current},[x,p,r,n,s,m,g]);return(0,o.useEffect)(()=>()=>{h.current&&clearInterval(h.current)},[]),{isActive:m,startFirebeam:j,stopFirebeam:x}},$=e=>{let{beamRef:t}=e,n=(0,o.useRef)(0),r=(0,o.useRef)(0),s=(0,o.useRef)(!0);return(0,o.useEffect)(()=>{let e=t.current;return()=>{s.current=!1,e&&(e.scale.z=0)}},[t]),(0,g.F)((e,o)=>{if(t.current&&s.current){if(r.current<0){r.current+=o;return}if(n.current<0){n.current+=o;let e=Math.min(n.current/0,1);t.current.scale.z=e}t.current.children.forEach((e,t)=>{"particle"===e.name&&(e.position.z=(.01*Date.now()+50*t)%200/10)})}}),{reset:()=>{n.current=0,r.current=0,s.current=!1,t.current&&(t.current.scale.z=0)}}};function ee(e){let{position:t,direction:n,onComplete:s}=e,i=(0,o.useRef)(null);(0,o.useEffect)(()=>{let e=i.current;return()=>{e&&(e.scale.z=0),s()}},[s]);let{reset:a}=$({beamRef:i,position:t,direction:n});return(0,o.useEffect)(()=>()=>{a()},[a]),(0,r.jsx)("group",{ref:i,position:t.toArray(),rotation:[0,Math.atan2(n.x,n.z),0],children:(0,r.jsxs)("group",{position:[0,-1.25,10.7],children:[(0,r.jsxs)("mesh",{rotation:[Math.PI/2,0,0],children:[(0,r.jsx)("cylinderGeometry",{args:[.1,.1,20,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff0000",emissive:"#ff1100",emissiveIntensity:15,transparent:!0,opacity:.95})]}),(0,r.jsxs)("mesh",{rotation:[Math.PI/2,0,0],children:[(0,r.jsx)("cylinderGeometry",{args:[.2,.2,20,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff2200",emissive:"#ff1100",emissiveIntensity:10,transparent:!0,opacity:.7})]}),(0,r.jsxs)("mesh",{rotation:[Math.PI/2,0,0],children:[(0,r.jsx)("cylinderGeometry",{args:[.3,.3,20,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff3300",emissive:"#ff2200",emissiveIntensity:8,transparent:!0,opacity:.4})]}),[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("mesh",{rotation:[Math.PI/2,0,t*Math.PI/1.5],position:[0,0,10],children:[(0,r.jsx)("torusGeometry",{args:[.35,.05,8,32]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff2200",emissive:"#ff1100",emissiveIntensity:8,transparent:!0,opacity:.3})]},t)),[...Array(8)].map((e,t)=>(0,r.jsxs)("mesh",{position:[.8*Math.cos(t*Math.PI/4),.8*Math.sin(t*Math.PI/4),2.5*t],children:[(0,r.jsx)("sphereGeometry",{args:[.15,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff6600",emissive:"#ff4400",emissiveIntensity:12,transparent:!0,opacity:.6})]},t)),(0,r.jsx)("pointLight",{position:[0,0,10],color:"#ff4400",intensity:25,distance:12}),(0,r.jsx)("pointLight",{position:[0,0,0],color:"#ff6600",intensity:15,distance:6})]})})}function et(e){let{isSwinging:t,onSwingComplete:n}=e,i=(0,o.useRef)(null),a=(0,o.useRef)(0),l=[-1.33,1.25,.75];(0,g.F)((e,r)=>{if(t&&i.current){a.current+=6*r;let e=Math.min(a.current/Math.PI,1),t=e<=.5?2*e:1-(e-.5)*2,o=l[0]+2*Math.sin(t*Math.PI),s=l[1]+-.5*Math.sin(t*Math.PI),c=l[2]+1.5*Math.cos(t*Math.PI);i.current.position.set(o,s,c);let h=Math.PI/4*Math.sin(t*Math.PI),u=Math.PI/2*Math.sin(t*Math.PI),d=Math.PI/3*Math.sin(t*Math.PI);i.current.rotation.set(h,u,d),a.current>=Math.PI&&(a.current=0,i.current.rotation.set(0,0,0),i.current.position.set(...l),n())}else!t&&i.current&&(i.current.rotation.x*=.85,i.current.rotation.y*=.85,i.current.rotation.z*=.85,i.current.position.x+=(l[0]-i.current.position.x)*.2,i.current.position.y+=(l[1]-i.current.position.y)*.2,i.current.position.z+=(l[2]-i.current.position.z)*.2)});let c=()=>{let e=new s.ypk;return e.moveTo(0,0),e.lineTo(.2,.05),e.bezierCurveTo(.7,.2,1.35,.6,1.55,.5),e.lineTo(1.125,1.125),e.bezierCurveTo(.7,.4,.3,.15,.4,.75),e.lineTo(0,0),e},h={steps:1,depth:.02,bevelEnabled:!0,bevelThickness:.01,bevelSize:.02,bevelSegments:3};return(0,r.jsxs)("group",{ref:i,position:[l[0],l[1],l[2]],rotation:[0,0,Math.PI],scale:[1.1,1.1,1.1],children:[(0,r.jsxs)("group",{position:[0,-.7,0],rotation:[0,0,-Math.PI],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.035,.05,1.5,12]}),(0,r.jsx)("meshStandardMaterial",{color:"#2c1810",roughness:.7})]}),[...Array(8)].map((e,t)=>(0,r.jsxs)("mesh",{position:[0,.8-.3*t,0],children:[(0,r.jsx)("torusGeometry",{args:[.06,.01,8,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#8B4513",metalness:.3,roughness:.7})]},t))]}),(0,r.jsxs)("group",{position:[0,.3,0],rotation:[Math.PI/1,0,Math.PI],children:[(0,r.jsx)("group",{"rotation-x":(0,g.F)(e=>2*e.clock.getElapsedTime()),children:(0,r.jsxs)("mesh",{children:[(0,r.jsx)("torusGeometry",{args:[.15,.01,16,32]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:2,transparent:!0,opacity:.7})]})}),(0,r.jsx)("group",{"rotation-x":(0,g.F)(e=>-(2*e.clock.getElapsedTime())),children:(0,r.jsxs)("mesh",{"position-y":.1,children:[(0,r.jsx)("torusGeometry",{args:[.13,.01,16,32]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:1.5,transparent:!0,opacity:.5})]})}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.14,.11,.32,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:1,transparent:!0,opacity:.3})]})]}),(0,r.jsxs)("group",{position:[0,.5,1.3],rotation:[-.9,-Math.PI/2,Math.PI/2],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("extrudeGeometry",{args:[c(),h]}),(0,r.jsx)("meshStandardMaterial",{color:"#f26767",metalness:.9,roughness:.3})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("extrudeGeometry",{args:[c(),{...h,depth:.021}]}),(0,r.jsx)("meshStandardMaterial",{color:"#f26767",emissive:"#ff0000",emissiveIntensity:2.5,metalness:.9,roughness:.2,opacity:.7,transparent:!0})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("extrudeGeometry",{args:[c(),{...h,depth:.022}]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:1.5,metalness:.8,roughness:.1,opacity:.3,transparent:!0})]})]})]})}let en=e=>{let{position:t,onComplete:n}=e,[s,i]=(0,o.useState)(0);(0,g.F)((e,t)=>{i(e=>{let r=e+t;return r>=1.5&&n(),r})});let a=s/1.5,l=Math.sin(a*Math.PI),c=1+2*a;return(0,r.jsxs)("group",{position:t.toArray(),children:[[void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("mesh",{position:[0,2*a+.5*t,0],rotation:[Math.PI/2,0,2*s],children:[(0,r.jsx)("torusGeometry",{args:[.8-.2*t,.05,16,32]}),(0,r.jsx)("meshStandardMaterial",{color:"#00ff88",emissive:"#00ff88",emissiveIntensity:2,transparent:!0,opacity:l*(1-.2*t)})]},"ring-".concat(t))),(0,r.jsxs)("mesh",{scale:[c,c,c],children:[(0,r.jsx)("sphereGeometry",{args:[.5,32,32]}),(0,r.jsx)("meshStandardMaterial",{color:"#00ff88",emissive:"#00ff88",emissiveIntensity:3,transparent:!0,opacity:.3*l})]}),[...Array(12)].map((e,t)=>{let n=t/12*Math.PI*2,o=1+a;return(0,r.jsxs)("mesh",{position:[Math.cos(n+2*s)*o,2*a+.5*Math.sin(3*s+t),Math.sin(n+2*s)*o],children:[(0,r.jsx)("sphereGeometry",{args:[.1,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#00ff88",emissive:"#00ff88",emissiveIntensity:2,transparent:!0,opacity:.8*l})]},"particle-".concat(t))}),(0,r.jsx)("pointLight",{color:"#00ff88",intensity:4*l,distance:5,decay:2})]})},er=(0,o.forwardRef)((e,t)=>{let{parentRef:n,onHealthChange:i,charges:a,setCharges:l}=e,[c,h]=(0,o.useState)(!1),{castReanimate:u}=function(e){let{charges:t,setCharges:n,onHealthChange:r}=e,s=(0,o.useRef)(0);return{castReanimate:(0,o.useCallback)(()=>{let e=t.findIndex(e=>e.available);return -1===e?(console.log("No charges available for Reanimate"),!1):(n(t=>t.map((t,n)=>n===e?{...t,available:!1,cooldownStartTime:Date.now()}:t)),r(10),setTimeout(()=>{n(t=>t.map((t,n)=>n===e?{...t,available:!0,cooldownStartTime:null}:t))},9e3),s.current=Date.now(),console.log("Reanimate casted. Healed for ".concat(10," points.")),!0)},[t,n,r])}}({parentRef:n,charges:a,setCharges:l,onHealthChange:e=>{h(!0),i(e)}});return(0,o.useImperativeHandle)(t,()=>({castReanimate:u})),c&&n.current?(0,r.jsx)(en,{position:n.current.position.clone().add(new s.Pq0(0,1,0)),onComplete:()=>h(!1)}):null});function eo(e){var t,n,l;let{onHit:c,controlsRef:h,currentWeapon:u,health:d,maxHealth:m,isPlayer:p=!1,abilities:f,onAbilityUse:x,onPositionUpdate:j,enemyData:y,onHealthChange:v}=e,M=(0,o.useRef)(null),[w,P]=(0,o.useState)(!1),[I,T]=(0,o.useState)([]),z=(0,o.useRef)(0),{camera:N}=(0,g.D)(),{keys:O}=function(e){let{groupRef:t,controlsRef:n,camera:r,speed:i=.07,onPositionUpdate:a}=e,l=(0,o.useRef)({w:!1,a:!1,s:!1,d:!1});return(0,g.F)(()=>{if(!t.current)return;let e=new s.Pq0;r.getWorldDirection(e),e.y=0,e.normalize();let o=new s.Pq0(-e.z,0,e.x),c=new s.Pq0(0,0,0);if(l.current.w&&c.add(e),l.current.s&&c.sub(e),l.current.a&&c.sub(o),l.current.d&&c.add(o),c.length()>0){c.normalize(),t.current.position.add(c.multiplyScalar(i));let e=Math.atan2(c.x,c.z);t.current.rotation.y=e}if(n.current){let e=t.current.position;n.current.target.set(e.x,e.y,e.z)}a(t.current.position.clone())}),(0,o.useEffect)(()=>{let e=e=>{let t=e.key.toLowerCase();t in l.current&&(l.current[t]=!0)},t=e=>{let t=e.key.toLowerCase();t in l.current&&(l.current[t]=!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[]),{keys:l}}({groupRef:M,controlsRef:h,camera:N,onPositionUpdate:j}),[W,Q]=(0,o.useState)(!1),[X,$]=(0,o.useState)([]),en=(0,o.useRef)(0),[eo,es]=(0,o.useState)([]),ei=(0,o.useRef)(0),[ea,el]=(0,o.useState)({}),[ec,eh]=(0,o.useState)(!1),[eu,ed]=(0,o.useState)(0),em=(0,o.useRef)(null),ep=(0,o.useRef)(0),[ef,ex]=(0,o.useState)([]),[eg,ej]=(0,o.useState)([{id:1,available:!0,cooldownStartTime:null},{id:2,available:!0,cooldownStartTime:null},{id:3,available:!0,cooldownStartTime:null},{id:4,available:!0,cooldownStartTime:null},{id:5,available:!0,cooldownStartTime:null},{id:6,available:!0,cooldownStartTime:null},{id:7,available:!0,cooldownStartTime:null},{id:8,available:!0,cooldownStartTime:null}]),[ey]=(0,o.useState)(15),ev=(0,o.useRef)(new Set),[eM,ew]=(0,o.useState)([]),{isRetributing:eP,startRetribute:eS,stopRetribute:eb}=Z({maxHealth:m,onHealthChange:e=>{if(console.log("Health Changed:",e),v){if("function"==typeof e){let t=e(d);console.log("Updated Health:",t),v(t)}else console.log("Set Health To:",e),v(e)}},duration:5,onHeal:(e,t)=>{es(n=>{var r;return[...n,{id:ei.current++,damage:e,position:(null===(r=M.current)||void 0===r?void 0:r.position.clone().add(new s.Pq0(0,1,0)))||new s.Pq0,isCritical:!1,isHealing:t}]})},onComplete:(0,o.useCallback)(()=>{console.log("Retribute has completed.")},[])}),eC=(0,o.useCallback)(()=>{if(!M.current)return;let e=eg.findIndex(e=>e.available);if(-1===e)return;let t=M.current.position.clone();t.y+=1;let n=new s.Pq0(0,0,1);n.applyQuaternion(M.current.quaternion),ej(t=>t.map((t,n)=>n===e?{...t,available:!1,cooldownStartTime:Date.now()}:t)),T(e=>[...e,{id:z.current++,position:t.clone(),startPosition:t.clone(),direction:n.normalize(),maxDistance:35}])},[M,eg]),eI=e=>{T(t=>t.filter(t=>t.id!==e))},ek=e=>{if(!M.current||!w)return;let t=Date.now();if(t-(ea["".concat(e,"_time")]||0)<240)return;let n=y.find(t=>t.id===e);if(!n)return;el(e=>({...e,[n.id]:(e[n.id]||0)+1,["".concat(n.id,"_time")]:t}));let r=n.id.startsWith("enemy");if(!r)return;let o=r&&(u===i.SABRES||u===i.SABRES2)?2:1,l=ea[n.id]||0;if(!(l>=o)&&M.current.position.distanceTo(n.position)<=(u===i.SABRES||u===i.SABRES2?5:4.5)){if(u===i.SABRES||u===i.SABRES2){let e=new s.Pq0().subVectors(n.position,M.current.position).normalize(),t=new s.Pq0(0,0,1).applyQuaternion(M.current.quaternion);if(Math.abs(e.angleTo(t))>Math.PI/6)return}let e=a[u].normal;if(W&&u===i.SWORD){if(ev.current.has(n.id)||eF)return;eN(!0);let{damage:t,isCritical:r}=H(e=31);c(n.id,t);let o=y.find(e=>e.id===n.id);if(!o||o.health<=0)return;es(e=>[...e,{id:ei.current++,damage:t,position:o.position.clone(),isCritical:r}]),ev.current.add(n.id),setTimeout(()=>{let e=y.find(e=>e.id===n.id);if(!e||e.health<=0||!ev.current.has(n.id)){ev.current.delete(n.id);return}let{damage:t,isCritical:r}=H(47);c(n.id,t);let o=y.find(e=>e.id===n.id);o&&o.health>0&&es(e=>[...e,{id:ei.current++,damage:t,position:o.position.clone(),isCritical:r,isLightning:!0}]),ev.current.delete(n.id)},200),setTimeout(()=>{eN(!1)},250);return}let{damage:t,isCritical:r}=H(e);if(c(n.id,t),n.health-t>0){if(u===i.SABRES){let e=0===l?-.4:.4;es(o=>[...o,{id:ei.current++,damage:t,position:new s.Pq0(n.position.x+e,n.position.y,n.position.z),isCritical:r}])}else es(e=>[...e,{id:ei.current++,damage:t,position:n.position.clone(),isCritical:r}])}}},e_=()=>{P(!1),el({}),Q(!1)};(0,g.F)((e,t)=>{if(M.current){if(w&&M.current&&y.forEach(e=>{ek(e.id)}),ec&&null!==em.current){let e=Math.min((Date.now()-em.current)/1e3/2,1);ed(e);let n=ep.current;ep.current+=(e-n)*t*15,e>=1&&eR(1)}ex(e=>e.map(e=>(e.position.distanceTo(e.startPosition)<e.maxDistance&&(e.position.add(e.direction.clone().multiplyScalar(.5)),y.forEach(t=>{1.4>e.position.distanceTo(t.position)&&ez(e.id,t.id,e.power)})),e)).filter(e=>e.position.distanceTo(e.startPosition)<e.maxDistance)),T(e=>e.map(e=>{if(e.position.distanceTo(e.startPosition)<e.maxDistance)for(let t of(e.position.add(e.direction.clone().multiplyScalar(.5)),y)){if(t.health<=0)continue;let n=t.position.clone();if(n.y=1.5,1.5>e.position.distanceTo(n))return eB(e.id,t.id),null}return e}).filter(Boolean)),ej(e=>e.map(e=>!e.available&&e.cooldownStartTime&&Date.now()-e.cooldownStartTime>=9e3?{...e,available:!0,cooldownStartTime:null}:e))}});let eR=(0,o.useCallback)(e=>{if(!M.current)return;let t=Math.floor(3+e*e*94)+(e>=.99?20:0),n=M.current.position.clone();n.y+=1;let r=new s.Pq0(0,0,1);r.applyQuaternion(M.current.quaternion);let o=n.clone(),i=new s.RlV(o,r.normalize());[...y.map(e=>({position:e.position.clone(),id:e.id}))].forEach(n=>{let r=n.position.clone();r.y=1;let s=i.distanceToPoint(r),a=i.direction.dot(r.clone().sub(o));if(s<1.5&&a>0&&a<25){let r=e>=1;c(n.id,t);let o=y.find(e=>e.id===n.id);if(!o)return;o.health-t>0&&es(e=>[...e,{id:ei.current++,damage:t,position:n.position.clone(),isCritical:r}])}}),ex(t=>[...t,{id:Date.now(),position:o.clone(),direction:r.clone(),power:e,startTime:Date.now(),maxDistance:25,startPosition:o.clone()}]),eh(!1),ed(0),em.current=null,x(u,"e")},[u,M,c,es,ex,x,y]),{startFirebeam:eT,stopFirebeam:eE}=J({parentRef:M,onHit:c,enemyData:y,setActiveEffects:ew,charges:eg,setCharges:ej}),eG=(0,o.useRef)(null);!function(e){let{keys:t,groupRef:n,currentWeapon:r,abilities:a,isSwinging:l,isSmiting:c,isBowCharging:h,bowChargeProgress:u,nextSmiteId:d,setIsSwinging:m,setIsSmiting:p,setIsBowCharging:f,setBowChargeStartTime:x,setSmiteEffects:g,setActiveEffects:j,onAbilityUse:y,startRetribute:v,shootFireball:M,releaseBowShot:w,startFirebeam:P,stopFirebeam:S,castReanimate:b,health:C,maxHealth:I,onHealthChange:k}=e,_=(0,o.useRef)(null),R=(0,o.useRef)(!1),T=(0,o.useRef)(0);(0,o.useEffect)(()=>{let e=e=>{let o=e.key.toLowerCase();if(!(o in t.current)||!t.current[o]){if(o in t.current&&(t.current[o]=!0),"2"===o&&r===i.SWORD&&a[i.SWORD].passive.isUnlocked&&(R.current=!R.current,R.current?null==k||k(C+100):C>I&&(null==k||k(I))),"q"===o&&a[r].q.currentCooldown<=0&&!l&&(T.current=Date.now(),m(!0),y(r,"q")),"e"===o&&a[r].e.currentCooldown<=0){if(r!==i.SWORD||c)(r===i.SABRES2||r===i.STAFF)&&P&&S?(_.current=P(),y(r,"e")):r!==i.SABRES||h?r===i.SCYTHE&&(M(),y(r,"e")):(f(!0),x(Date.now()));else{if(Date.now()-T.current<1e3){console.log("Cannot use Smite so soon after a normal attack");return}p(!0),m(!0);let e=n.current.position.clone();e.add(new s.Pq0(0,0,3.5).applyQuaternion(n.current.quaternion)),g(t=>[...t,{id:d.current++,position:e}]),y(r,"e")}}if("1"===o&&a[r].passive.isUnlocked&&b(),"r"===o){let e=a[r].r;if(e.isUnlocked&&e.currentCooldown<=0)switch(y(r,"r"),r){case i.SCYTHE:let t=new s.Pq0(0,0,1).applyQuaternion(n.current.quaternion);j(e=>[...e,{id:Math.random(),type:"boneclaw",position:n.current.position.clone(),direction:t}]);break;case i.SWORD:v();break;case i.SABRES:case i.SABRES2:j(e=>[...e,{id:Math.random(),type:"blizzard",position:n.current.position.clone(),direction:new s.Pq0(0,0,0)}])}}}},o=e=>{let n=e.key.toLowerCase();n in t.current&&(t.current[n]=!1),"e"===n&&h&&w(u)};return window.addEventListener("keydown",e),window.addEventListener("keyup",o),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",o)}},[t,n,r,a,l,c,h,u,m,p,f,g,j,y,v,M,w,d,x,P,S,b,C,I,k]),R.current}({keys:O,groupRef:M,currentWeapon:u,abilities:f,isSwinging:w,isSmiting:W,isBowCharging:ec,bowChargeProgress:eu,nextSmiteId:en,setIsSwinging:P,setIsSmiting:Q,setIsBowCharging:eh,setBowChargeStartTime:e=>{em.current=e},setSmiteEffects:$,setActiveEffects:ew,onAbilityUse:x,startRetribute:eS,shootFireball:eC,releaseBowShot:eR,startFirebeam:eT,stopFirebeam:eE,castReanimate:()=>{var e;null===(e=eG.current)||void 0===e||e.castReanimate()},reanimateRef:eG,health:d,maxHealth:m,onHealthChange:v});let eq=e=>{$(t=>t.filter(t=>t.id!==e))},eD=e=>{es(t=>t.filter(t=>t.id!==e))};(0,o.useEffect)(()=>{(u===i.SABRES||u===i.SABRES2)&&el({})},[u]);let ez=(e,t,n)=>{if(!t.startsWith("enemy"))return;let r=y.find(e=>e.id===t);if(!r)return;let o=Math.floor(3+n*n*94)+(n>=.99?20:0);c(t,o),r.health-o>0&&es(e=>[...e,{id:ei.current++,damage:o,position:r.position.clone(),isCritical:n>=.99}])},eB=(e,t)=>{if(!t.startsWith("enemy"))return;let n=y.find(e=>e.id===t);if(!n)return;let{damage:r,isCritical:o}=H(41);c(t,r),n.health-r>0&&es(e=>[...e,{id:ei.current++,damage:r,position:n.position.clone(),isCritical:o}]),eI(e)};(0,g.F)(()=>{M.current&&j(M.current.position.clone())});let eA=(0,o.useCallback)(e=>{v&&v(Math.min(m,d+e))},[v,d,m]),[eF,eN]=(0,o.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("group",{ref:M,position:[0,1,0],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[.15,32,32]}),(0,r.jsx)("meshPhongMaterial",{color:"#EAC4D5",transparent:!0,opacity:.2,shininess:80})]}),(0,r.jsxs)("mesh",{scale:1.3,children:[(0,r.jsx)("sphereGeometry",{args:[.45,32,32]}),(0,r.jsx)("meshBasicMaterial",{color:"#EAC4D5",transparent:!0,opacity:.1,depthWrite:!1})]}),(0,r.jsxs)("mesh",{position:[0,.2,.3],scale:.35,children:[(0,r.jsx)("sphereGeometry",{args:[.4,32,32]}),(0,r.jsx)("meshPhongMaterial",{color:"#EAC4D5",transparent:!0,opacity:.6,emissive:"#EAC4D5",emissiveIntensity:.3})]}),(0,r.jsxs)("group",{position:[0,.2,-.2],children:[(0,r.jsx)("group",{rotation:[0,Math.PI/8,0],children:(0,r.jsx)(D,{collectedBones:ey,isLeftWing:!0,parentRef:M})}),(0,r.jsx)("group",{rotation:[0,-Math.PI/8,0],children:(0,r.jsx)(D,{collectedBones:ey,isLeftWing:!1,parentRef:M})})]}),(0,r.jsx)(K,{parentRef:M,charges:eg}),(0,r.jsx)(A,{}),(0,r.jsx)(F,{}),u===i.SABRES?(0,r.jsx)(k,{isSwinging:w,onSwingComplete:e_,onLeftSwingStart:()=>{},onRightSwingStart:()=>{},isBowCharging:ec}):u===i.STAFF?(0,r.jsx)(et,{isSwinging:w,onSwingComplete:e_,parentRef:M}):u===i.SCYTHE?(0,r.jsx)(b,{parentRef:M,isSwinging:w,onSwingComplete:e_}):(0,r.jsx)(C,{isSwinging:w,isSmiting:W,onSwingComplete:e_,onSmiteComplete:()=>{Q(!1),P(!1),el({})}}),!p&&(0,r.jsxs)(G,{position:[0,2,0],lockX:!1,lockY:!1,lockZ:!1,children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("planeGeometry",{args:[1,.1]}),(0,r.jsx)("meshBasicMaterial",{color:"#333333"})]}),(0,r.jsx)("mesh",{position:[.5+d/m*.5,0,.001],children:(0,r.jsx)("planeGeometry",{args:[d/m,.08]})})]})]}),(0,r.jsx)(q,{parentRef:M}),I.map(e=>(0,r.jsx)(S,{position:e.position,direction:e.direction,onImpact:()=>eI(e.id)},e.id)),X.map(e=>(0,r.jsx)(R,{weaponType:u,position:e.position,onComplete:()=>eq(e.id)},e.id)),eo.map(e=>(0,r.jsx)(E,{damage:e.damage,position:e.position,isCritical:e.isCritical,isLightning:e.isLightning,onComplete:()=>eD(e.id)},e.id)),(u===i.SABRES||u===i.SABRES2)&&ec&&(0,r.jsx)(_,{position:(null===(t=M.current)||void 0===t?void 0:t.position.clone().add(new s.Pq0(0,1,0)))||new s.Pq0,direction:new s.Pq0(0,0,1).applyQuaternion((null===(n=M.current)||void 0===n?void 0:n.quaternion)||new s.PTz),chargeProgress:eu,isCharging:ec,onRelease:eR}),ef.map(e=>(0,r.jsxs)("group",{children:[(0,r.jsxs)("group",{position:e.position.toArray(),rotation:[0,Math.atan2(e.direction.x,e.direction.z),0],children:[(0,r.jsxs)("mesh",{rotation:[Math.PI/2,0,0],children:[(0,r.jsx)("cylinderGeometry",{args:[.005,.1,1.2,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:2.5,transparent:!0,opacity:.9})]}),(0,r.jsxs)("mesh",{rotation:[Math.PI/2,0,0],children:[(0,r.jsx)("sphereGeometry",{args:[25e-5,16,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#ffffff",emissive:"#ffffff",emissiveIntensity:8,transparent:!0,opacity:.7})]}),[...Array(6)].map((e,t)=>(0,r.jsxs)("mesh",{position:[.2*Math.sin(.01*Date.now()+t),.2*Math.cos(.01*Date.now()+t),-(.3*t)],children:[(0,r.jsx)("sphereGeometry",{args:[.05-.03*t,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:4,transparent:!0,opacity:.5-.1*t})]},t)),[void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("mesh",{position:[0,0,-(.45*t)-.5],rotation:[Math.PI,0,.003*Date.now()+t*Math.PI/3],children:[(0,r.jsx)("torusGeometry",{args:[.2+.1*t,.05,8,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:3,transparent:!0,opacity:.4-.1*t,blending:s.EZo})]},"ring-".concat(t))),(0,r.jsx)("pointLight",{color:"#00ffff",intensity:4,distance:5,decay:2}),(0,r.jsx)("pointLight",{color:"#80ffff",intensity:2,distance:8,decay:1})]}),e.power>=1&&e.position.distanceTo(e.startPosition)<e.maxDistance&&!e.hasCollided&&(0,r.jsxs)("group",{position:e.position.toArray(),rotation:[0,Math.atan2(e.direction.x,e.direction.z),0],children:[[...Array(10)].map((e,t)=>{let n=.15*t,o=1-.09*t;return(0,r.jsxs)("group",{position:[0,0,-(.6*t)+.25],scale:[.3*n,.3*n,1],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("torusGeometry",{args:[.15,.15,8,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#00ffff",emissive:"#00ffff",emissiveIntensity:7,transparent:!0,opacity:o,blending:s.EZo})]}),(0,r.jsxs)("mesh",{scale:1.5,children:[(0,r.jsx)("torusGeometry",{args:[.5,.2,8,16]}),(0,r.jsx)("meshStandardMaterial",{color:"#ffffff",emissive:"#80ffff",emissiveIntensity:5,transparent:!0,opacity:.5*o,blending:s.EZo})]})]},"power-trail-".concat(t))}),(0,r.jsx)("pointLight",{color:"#00ffff",intensity:3,distance:6,decay:2})]})]},e.id)),(0,r.jsx)(L,{parentRef:M}),(0,r.jsx)(B,{parentRef:M}),eM.map(e=>"boneclaw"===e.type?(0,r.jsx)(U,{position:e.position,direction:e.direction,parentRef:M,enemyData:y,onComplete:()=>{ew(t=>t.filter(t=>t.id!==e.id))},onHitTarget:(e,t,n,r,o)=>{c(e,t),es(e=>[...e,{id:ei.current++,damage:t,position:r.clone(),isCritical:n,isBoneclaw:o}])}},e.id):"blizzard"===e.type?(0,r.jsx)(Y,{position:e.position,enemyData:y,parentRef:M,onHitTarget:(e,t,n,r,o)=>{console.log("Creating blizzard damage number:",{damage:t,isCritical:n,isBlizzard:o}),c(e,t),es(e=>[...e,{id:ei.current++,damage:t,position:r.clone(),isCritical:n,isBlizzard:!0}])},onComplete:()=>{ew(t=>t.filter(t=>t.id!==e.id))}},e.id):"firebeam"===e.type?(0,r.jsx)(ee,{position:e.position,direction:e.direction,onComplete:()=>{ew(t=>t.filter(t=>t.id!==e.id))}},e.id):null),eP&&(0,r.jsx)(V,{position:(null===(l=M.current)||void 0===l?void 0:l.position)||new s.Pq0,parentRef:M,onComplete:eb,onHeal:(e,t)=>{console.log("Healing: +".concat(e," health")),es(n=>{var r;return[...n,{id:ei.current++,damage:e,position:(null===(r=M.current)||void 0===r?void 0:r.position.clone().add(new s.Pq0(0,1,0)))||new s.Pq0,isCritical:!1,isHealing:t}]})}}),(0,r.jsx)(er,{ref:eG,parentRef:M,onHealthChange:eA,charges:eg,setCharges:ej})]})}er.displayName="Reanimate";var es=n(2433);function ei(){let e=(e,t)=>(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[t,.8*t,e,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),t=e=>(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[e,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),n=(n,o)=>(0,r.jsxs)("group",{children:[(0,r.jsx)("group",{position:[o/2,0,0],children:e(n,.04)}),(0,r.jsx)("group",{position:[-o/2,0,0],children:e(n,.04)}),(0,r.jsx)("group",{position:[0,n/2,0],children:t(.06)}),(0,r.jsx)("group",{position:[0,-n/2,0],children:t(.06)})]});return(0,r.jsx)("group",{children:(0,r.jsxs)("group",{children:[n(.65,.05),(0,r.jsxs)("group",{position:[0,-.35,0],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[.08,12,12]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,r.jsxs)("group",{position:[0,-.15,0],children:[n(.7,.06),(0,r.jsxs)("group",{position:[0,-.25,0],rotation:[Math.PI/2,0,0],children:[t(.06),(0,r.jsxs)("group",{position:[0,-.015,.1],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("boxGeometry",{args:[.15,.02,.4]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),[-.05,0,.05].map((e,t)=>(0,r.jsx)("group",{position:[e,.15,.25],rotation:[-Math.PI,0,0],children:(0,r.jsxs)("group",{children:[n(.15,.02),(0,r.jsx)("group",{position:[0,-.1,0],rotation:[Math.PI/6,0,0],children:(0,r.jsxs)("mesh",{children:[(0,r.jsx)("coneGeometry",{args:[.02,.15,6]}),(0,r.jsx)("meshStandardMaterial",{color:"#d4d4d4",roughness:.3,metalness:.4})]})})]})},t))]})]})]})]})]})})}function ea(){let e=(e,t)=>(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[t,.8*t,e,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),t=e=>(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[e,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),n=(n,o)=>(0,r.jsxs)("group",{children:[(0,r.jsx)("group",{position:[o/2,0,0],children:e(n,.06)}),(0,r.jsx)("group",{position:[-o/2,0,0],children:e(n,.06)}),(0,r.jsx)("group",{position:[0,n/2,0],children:t(.08)}),(0,r.jsx)("group",{position:[0,-n/2,0],children:t(.08)})]});return(0,r.jsx)("group",{children:(0,r.jsxs)("group",{children:[n(1.3,.15),(0,r.jsxs)("group",{position:[.25,-.85,.21],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[.12,12,12]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,r.jsxs)("group",{rotation:[-.7,-0,Math.PI/5],children:[n(.8,.12),(0,r.jsxs)("group",{position:[0,-.5,0],rotation:[0,0,Math.PI/5.5],children:[t(.09),(0,r.jsxs)("group",{position:[0,-.1,0],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("boxGeometry",{args:[.2,.15,.08]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4})]}),[-.08,-.04,0,.04,.08].map((t,n)=>(0,r.jsxs)("group",{position:[t,-.1,0],rotation:[0,0,(n-2)*Math.PI/10],children:[e(.5,.02),(0,r.jsx)("group",{position:[.025,-.3,0],rotation:[0,0,Math.PI+Math.PI/16],children:(0,r.jsxs)("mesh",{children:[(0,r.jsx)("coneGeometry",{args:[.03,.3,6]}),(0,r.jsx)("meshStandardMaterial",{color:"#d4d4d4",roughness:.3,metalness:.4})]})})]},n))]})]})]})]})]})})}function el(){return(0,r.jsxs)("group",{children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.05,.2,.3,6,1,!1,0,-(2*Math.PI)]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),[0,0,.1].map((e,t)=>(0,r.jsx)("group",{position:[0,.1,e],rotation:[0,0,0],children:(0,r.jsxs)("mesh",{children:[(0,r.jsx)("coneGeometry",{args:[.04,.2,4]}),(0,r.jsx)("meshStandardMaterial",{color:"#d4d4d4",roughness:.3,metalness:.4})]})},t))]})}function ec(e){let{position:t,isAttacking:n,isWalking:s}=e,i=(0,o.useRef)(null),[a,l]=(0,o.useState)(0),[c,h]=(0,o.useState)(0);return(0,g.F)((e,r)=>{if(i.current){if(s){l(e=>(e+2.5*r)%(2*Math.PI));let e=Math.abs(.1*Math.sin(a));i.current&&(i.current.position.y=t[1]-e),["LeftLeg","RightLeg"].forEach(e=>{var t,n;let r=null===(t=i.current)||void 0===t?void 0:t.getObjectByName(e);if(r){let t=e.includes("Right")?a:a+Math.PI,o=.4*Math.sin(t);r.rotation.x=o;let s=null===(n=r.children[0])||void 0===n?void 0:n.children[1];if(s){let e=Math.max(0,Math.sin(t+Math.PI/4));s.rotation.x=.2+.8*e;let n=.1*Math.sin(t);s.rotation.y=n}let i=.05*Math.sin(t);r.rotation.y=i}}),["LeftArm","RightArm"].forEach(e=>{var t;let n=null===(t=i.current)||void 0===t?void 0:t.getObjectByName(e);if(n){let t=.1*Math.sin(e.includes("Right")?a+Math.PI:a);n.rotation.x=t}})}if(n){h(e=>e+3*r);let e=Math.sin(Math.min(c,Math.PI/2))*Math.PI/2,t=i.current.getObjectByName("RightArm");t&&(t.rotation.x=-e),c>Math.PI/2&&h(0)}}}),(0,r.jsxs)("group",{ref:i,position:[t[0],t[1]+.6,t[2]],children:[(0,r.jsxs)("group",{name:"Body",position:[0,1.45,0],scale:.85,children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.08,.08,1.6,6]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),[-.5,-.25,0,.25,.5].map((e,t)=>(0,r.jsxs)("group",{position:[0,e,0],children:[(0,r.jsx)("group",{rotation:[0,0,-Math.PI/3],children:(0,r.jsxs)("mesh",{position:[.1,0,0],rotation:[1,Math.PI/2,0],children:[(0,r.jsx)("torusGeometry",{args:[.18,.015,8,12,1*Math.PI]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]})}),(0,r.jsx)("group",{rotation:[0,0,Math.PI/3],children:(0,r.jsxs)("mesh",{position:[-.1,0,0],rotation:[0,-Math.PI/2,0],children:[(0,r.jsx)("torusGeometry",{args:[.18,.015,8,12,1*Math.PI]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]})})]},t))]}),(0,r.jsxs)("group",{name:"Head",position:[0,2,0],children:[(0,r.jsxs)("group",{children:[(0,r.jsxs)("mesh",{position:[0,0,-.05],children:[(0,r.jsx)("sphereGeometry",{args:[.22,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,r.jsxs)("mesh",{position:[0,-.02,.12],children:[(0,r.jsx)("boxGeometry",{args:[.28,.3,.12]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,r.jsxs)("group",{children:[(0,r.jsxs)("mesh",{position:[.12,-.08,.1],children:[(0,r.jsx)("boxGeometry",{args:[.08,.12,.15]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]}),(0,r.jsxs)("mesh",{position:[-.12,-.08,.1],children:[(0,r.jsx)("boxGeometry",{args:[.08,.12,.15]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]})]}),(0,r.jsx)("group",{position:[0,-.15,.05],children:(0,r.jsxs)("mesh",{position:[0,-.08,.08],rotation:[0,Math.PI/5,0],children:[(0,r.jsx)("cylinderGeometry",{args:[.08,.08,.2,5]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})}),(0,r.jsx)("group",{position:[.025,-.25,.2175],children:[-.03,-.06,-.09,-0,.03].map((e,t)=>(0,r.jsx)("group",{position:[e,0,0],rotation:[.5,0,0],children:(0,r.jsxs)("mesh",{children:[(0,r.jsx)("coneGeometry",{args:[.02,.075,3]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.3,metalness:.4})]})},t))}),(0,r.jsx)("group",{position:[0,-.18,.2],children:[-.06,-.02,.02,.06].map((e,t)=>(0,r.jsx)("group",{position:[e,0,0],rotation:[2.5,0,0],children:(0,r.jsxs)("mesh",{children:[(0,r.jsx)("coneGeometry",{args:[.01,.08,3]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.3,metalness:.4})]})},t))})]}),(0,r.jsxs)("group",{position:[0,.05,.14],children:[(0,r.jsxs)("group",{position:[-.07,0,0],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[.02,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#000000",emissive:"#ff0000",emissiveIntensity:3})]}),(0,r.jsxs)("mesh",{scale:1.2,children:[(0,r.jsx)("sphereGeometry",{args:[.035,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:1,transparent:!0,opacity:1})]}),(0,r.jsxs)("mesh",{scale:1.4,children:[(0,r.jsx)("sphereGeometry",{args:[.05,6.5,2]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:1,transparent:!0,opacity:1})]}),(0,r.jsx)("pointLight",{color:"#ff0000",intensity:1,distance:.5,decay:2})]}),(0,r.jsxs)("group",{position:[.07,0,0],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[.02,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#000000",emissive:"#ff0000",emissiveIntensity:3})]}),(0,r.jsxs)("mesh",{scale:1.2,children:[(0,r.jsx)("sphereGeometry",{args:[.035,8,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:2,transparent:!0,opacity:1})]}),(0,r.jsxs)("mesh",{scale:1.3,children:[(0,r.jsx)("sphereGeometry",{args:[.05,6.5,2]}),(0,r.jsx)("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:1,transparent:!0,opacity:1})]}),(0,r.jsx)("pointLight",{color:"#ff0000",intensity:1,distance:1,decay:2})]})]})]}),(0,r.jsx)("group",{position:[-.35,1.65,0],rotation:[Math.PI/5,-Math.PI/2-.8,0],children:(0,r.jsx)(el,{})}),(0,r.jsx)("group",{position:[.35,1.65,0],rotation:[Math.PI/5,Math.PI-.8,0],children:(0,r.jsx)(el,{})}),(0,r.jsx)("group",{name:"LeftArm",position:[-.35,1.4,0],scale:[-.4,.4,.4],rotation:[0,Math.PI/2,0],children:(0,r.jsx)(ea,{})}),(0,r.jsx)("group",{name:"RightArm",position:[.35,1.4,0],scale:[.4,.4,.4],rotation:[0,-Math.PI/2.5,0],children:(0,r.jsx)(ea,{})}),(0,r.jsxs)("group",{position:[0,.7,0],children:[" ",(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.26,.25,.15,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#d8d8d8",roughness:.5,metalness:.2})]})]}),(0,r.jsx)("group",{name:"LeftLeg",position:[.2,.3,0],children:(0,r.jsx)(ei,{})}),(0,r.jsx)("group",{name:"RightLeg",position:[-.2,.3,0],children:(0,r.jsx)(ei,{})}),(0,r.jsx)("group",{position:[0,1.8,0],children:(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.04,.04,.2,6]}),(0,r.jsx)("meshStandardMaterial",{color:"#e8e8e8",roughness:.4,metalness:.3})]})})]})}let eh=()=>(0,r.jsx)("group",{children:(0,r.jsxs)("mesh",{children:[(0,r.jsx)("cylinderGeometry",{args:[.03,.015,.3,8]}),(0,r.jsx)("meshStandardMaterial",{color:"#67f2b9",transparent:!0,opacity:.5,emissive:"#67f2b9",emissiveIntensity:.5})]})});function eu(e){let{position:t,onComplete:n,isSpawning:s=!1}=e,i=(0,o.useRef)([]),a=(0,o.useRef)(null),l=(0,o.useRef)(Date.now());return(0,g.F)(()=>{if(!a.current)return;let e=Date.now()-l.current,r=Math.min(e/1500,1),o=s?1-r:r;a.current.position.copy(t),i.current.forEach((t,n)=>{let r=Math.floor(n/8)/11,s=1.2*r*(o<.5?2*o:2-2*o),i=n%8/8*Math.PI*2+.006*(1+3*r)*e,a=Math.cos(i+2*r)*s,l=Math.sin(i+2*r)*s,c=(1-r)*3*(1+.1*Math.sin(.002*e));t.position.set(a,c,l),t.rotation.y=i+Math.PI/2,t.rotation.z=Math.PI/2+.8*r,t.rotation.x=.2*Math.sin(.004*e+n);let h=t.material;h.opacity=Math.max(0,.7-.4*r-(o>.7?(o-.7)*3:0)),h.emissiveIntensity=.5+.3*Math.sin(.004*e+n);let u=1+.2*Math.sin(.003*e+.5*n);t.scale.set(u,u,u)}),1===r&&n&&n()}),(0,r.jsx)("group",{ref:a,children:Array.from({length:96}).map((e,t)=>(0,r.jsx)("mesh",{ref:e=>{e&&(i.current[t]=e)},children:eh()},t))})}function ed(e){let{id:t,initialPosition:n,position:i,health:a,maxHealth:l,onTakeDamage:c,onPositionUpdate:h,playerPosition:u,onAttackPlayer:d}=e,m=(0,o.useRef)(null),p=(0,o.useRef)(Date.now()+2e3),[f,x]=(0,o.useState)(!1),[j,y]=(0,o.useState)(!1),[v,M]=(0,o.useState)(!1),[w,P]=(0,o.useState)(!0),[S,b]=(0,o.useState)(!1),C=(0,o.useRef)(n.clone()),I=(0,o.useRef)(n.clone()),k=(0,o.useRef)(Date.now()),_=(0,o.useRef)(a);(0,o.useEffect)(()=>{_.current=a},[a]);let R=(0,o.useCallback)(e=>{if(_.current<=0)return;let n=Math.max(0,_.current-e);c("enemy-".concat(t),e),0===n&&_.current>0&&(M(!0),y(!0))},[t,c]);return(0,o.useEffect)(()=>{i&&(C.current.copy(i),I.current.copy(i),m.current&&m.current.position.copy(i))},[i]),(0,g.F)((e,n)=>{if(!m.current||_.current<=0||!u){b(!1);return}let r=C.current.distanceTo(u);if(r>2&&_.current>0){x(!1),b(!0);let e=new s.Pq0().subVectors(u,C.current).normalize().multiplyScalar(.15*n*60);I.current.copy(C.current).add(e),C.current.lerp(I.current,.15),m.current.position.copy(C.current);let r=new s.Pq0().copy(u).setY(C.current.y);m.current.lookAt(r);let o=Date.now();o-k.current>=50&&C.current.distanceTo(i)>.1&&(h(t,C.current.clone()),k.current=o)}else b(!1),I.current.copy(C.current);if(r<=2&&_.current>0){let e=Date.now();e-p.current>=2e3&&(x(!0),d(5),p.current=e,setTimeout(()=>{x(!1)},500))}}),(0,o.useEffect)(()=>{0!==_.current||v||(console.log("Enemy ".concat(t," died")),M(!0),y(!0))},[_,t,v]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("group",{ref:m,visible:!w&&_.current>0,position:C.current,onClick:e=>{e.stopPropagation(),_.current>0&&R(10)},children:[(0,r.jsx)(ec,{position:[0,0,0],isAttacking:f,isWalking:S&&_.current>0,onHit:R}),(0,r.jsx)(es.Q,{position:[0,3.5,0],follow:!0,lockX:!1,lockY:!1,lockZ:!1,children:_.current>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("mesh",{position:[0,0,0],children:[(0,r.jsx)("planeGeometry",{args:[2,.25]}),(0,r.jsx)("meshBasicMaterial",{color:"#333333",opacity:.8,transparent:!0})]}),(0,r.jsxs)("mesh",{position:[-1+_.current/l,0,.001],children:[(0,r.jsx)("planeGeometry",{args:[_.current/l*2,.23]}),(0,r.jsx)("meshBasicMaterial",{color:"#ff3333",opacity:.9,transparent:!0})]}),(0,r.jsx)(T.E,{position:[0,0,.002],fontSize:.2,color:"#ffffff",anchorX:"center",anchorY:"middle",fontWeight:"bold",children:"".concat(Math.ceil(_.current),"/").concat(l)})]})})]}),w&&(0,r.jsx)(eu,{position:C.current,onComplete:()=>{P(!1)},isSpawning:!0}),j&&(0,r.jsx)(eu,{position:C.current,onComplete:()=>{y(!1)},isSpawning:!1})]})}let em=()=>(0,r.jsxs)("group",{position:[100,80,-150],scale:[30,30,30],children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[1,32,32]}),(0,r.jsx)("meshStandardMaterial",{color:"#B8E0D2",roughness:.7,metalness:.2,emissive:"#B8E0D2",emissiveIntensity:.5})]}),(0,r.jsxs)("mesh",{scale:[1.2,1.2,1.2],children:[(0,r.jsx)("sphereGeometry",{args:[1,32,32]}),(0,r.jsx)("meshBasicMaterial",{color:"#4dff90",transparent:!0,opacity:.6})]}),(0,r.jsxs)("mesh",{scale:[1.5,1.5,1.5],children:[(0,r.jsx)("sphereGeometry",{args:[1,32,32]}),(0,r.jsx)("meshBasicMaterial",{color:"#4dff90",transparent:!0,opacity:.1,side:s.hsX})]}),(0,r.jsx)("pointLight",{color:"#4dff90",intensity:2,distance:50})]}),ep={uniforms:{topColor:{value:new s.Q1f("#ffb6c1")},middleColor:{value:new s.Q1f("#ffd1dc")},bottomColor:{value:new s.Q1f("#ffe4e1")},offset:{value:33},exponent:{value:.6}},vertexShader:"\n    varying vec3 vWorldPosition;\n    \n    void main() {\n      vec4 worldPosition = modelMatrix * vec4(position, 1.0);\n      vWorldPosition = worldPosition.xyz;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ",fragmentShader:"\n    uniform vec3 topColor;\n    uniform vec3 middleColor;\n    uniform vec3 bottomColor;\n    uniform float offset;\n    uniform float exponent;\n    \n    varying vec3 vWorldPosition;\n    \n    void main() {\n      float h = normalize(vWorldPosition + vec3(0.0, offset, 0.0)).y;\n      float mixStrength = max(pow(max(h, 0.0), exponent), 0.0);\n      vec3 color = mix(middleColor, topColor, mixStrength);\n      color = mix(bottomColor, color, smoothstep(0.0, 1.0, h));\n      gl_FragColor = vec4(color, 1.0);\n    }\n  "},ef=()=>{let e=(0,o.useMemo)(()=>({uniforms:ep.uniforms,vertexShader:ep.vertexShader,fragmentShader:ep.fragmentShader,side:s.hsX}),[]);return(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[500,32,32]}),(0,r.jsx)("shaderMaterial",{attach:"material",args:[e]})]})};var ex=n(7080),eg=n.n(ex);let ej=[{title:"The Darkness Claims Another",subtitle:"Your soul joins the eternal dance..."},{title:"Fallen to Shadow",subtitle:"The necropolis grows stronger..."},{title:"Death's Embrace",subtitle:"The bones welcome their kin..."},{title:"The Last Stand",subtitle:"Your light fades into the abyss..."},{title:"Eternal Rest",subtitle:"The skeleton army claims victory..."},{title:"Denied Ascension",subtitle:"The dragons turn their backs on another unworthy soul..."},{title:"Draconic Disappointment",subtitle:"Your flames were not strong enough to join their ranks..."},{title:"Failed Wyrm",subtitle:"The ancient dragons scoff at your weakness..."},{title:"Wingless One",subtitle:"You'll never know the freedom of dragon flight..."},{title:"Mortal Chains",subtitle:"Forever bound to walk while dragons soar above..."},{title:"Lost Heritage",subtitle:"The dragon blood within you grows cold..."},{title:"Fading Ember",subtitle:"Your draconic spark extinguishes in darkness..."},{title:"Rejected by Fire",subtitle:"The dragon's flame finds you unworthy..."}];function ey(e){let{onReset:t,killCount:n}=e,o=ej[Math.floor(Math.random()*ej.length)];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h1",{className:eg().gameOverTitle,children:o.title}),(0,r.jsx)("p",{className:eg().gameOverSubtitle,children:o.subtitle}),(0,r.jsx)("button",{className:eg().retryButton,onClick:t,children:"RETRY"}),(0,r.jsxs)("div",{className:eg().killCounter,children:["Skeletons Defeated: ",n]})]})}function ev(e){let{playerHealth:t,onReset:n,killCount:s,onEnemiesDefeated:i,maxSkeletons:a=15}=e,[l,c]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{t<=0&&!l&&c(!0)},[t,l]),(0,o.useEffect)(()=>{!l&&s>=a&&(console.log("Level complete! Kill count:",s,"MAX_SKELETONS:",a),i())},[l,s,a,i]),(0,r.jsx)(r.Fragment,{children:t<=0&&(0,r.jsx)("div",{className:eg().gameOverContainer,children:(0,r.jsx)(ey,{onReset:n,killCount:s})})})}let eM=()=>{let e=document.createElement("canvas");e.width=308,e.height=308;let t=e.getContext("2d");if(t){t.clearRect(0,0,308,308);let e=t.createRadialGradient(154,154,0,154,154,154);e.addColorStop(0,"rgba(255, 255, 255, 0.6)"),e.addColorStop(.2,"rgba(255, 255, 255, 0.3)"),e.addColorStop(.5,"rgba(255, 255, 255, 0.1)"),e.addColorStop(.8,"rgba(255, 255, 255, 0.05)"),e.addColorStop(1,"rgba(255, 255, 255, 0)"),t.fillStyle=e,t.beginPath(),t.arc(154,154,154,0,2*Math.PI),t.fill()}let n=new s.gPd(e);return n.needsUpdate=!0,n},ew=e=>{let{count:t=2e3,radius:n=100}=e,i=(0,o.useMemo)(()=>eM(),[]),a=(0,o.useMemo)(()=>{let e=new Float32Array(3*t),r=new Float32Array(3*t),o=new Float32Array(t);for(let i=0;i<t;i++){let t=2*Math.PI*Math.random(),a=Math.acos(2*Math.random()-1),l=n*Math.cbrt(Math.random());e[3*i]=l*Math.sin(a)*Math.cos(t),e[3*i+1]=l*Math.sin(a)*Math.sin(t),e[3*i+2]=l*Math.cos(a);let c=new s.Q1f;c.setHSL(.33+.02*Math.random(),1,.8+.2*Math.random()),r[3*i]=.3*c.r,r[3*i+1]=1.5*c.g,r[3*i+2]=.3*c.b,o[i]=8*Math.random()+4}return{positions:e,colors:r,sizes:o}},[t,n]),l=o.useRef(null);return(0,g.F)(e=>{let{clock:t}=e;l.current&&(l.current.rotation.y=.05*t.getElapsedTime())}),(0,r.jsxs)("points",{ref:l,children:[(0,r.jsxs)("bufferGeometry",{children:[(0,r.jsx)("bufferAttribute",{attach:"attributes-position",count:t,array:a.positions,itemSize:3}),(0,r.jsx)("bufferAttribute",{attach:"attributes-color",count:t,array:a.colors,itemSize:3}),(0,r.jsx)("bufferAttribute",{attach:"attributes-size",count:t,array:a.sizes,itemSize:1,normalized:!0})]}),(0,r.jsx)("pointsMaterial",{size:1,vertexColors:!0,transparent:!0,opacity:.6,sizeAttenuation:!0,blending:s.EZo,depthWrite:!1,map:i})]})};var eP=n(4463);let eS=()=>(0,r.jsx)(eP.A,{radius:500,depth:200,count:5e3,factor:3,saturation:0,fade:!0,speed:.2});function eb(e){let{mountainData:t,treeData:n,mushroomData:i,treePositions:a,interactiveTrunkColor:l,interactiveLeafColor:c,unitProps:h,killCount:u,onLevelComplete:d,spawnInterval:m=5e3,maxSkeletons:f=15,initialSkeletons:x=5}=e,[g,v]=(0,o.useState)(()=>Array.from({length:x},(e,t)=>{let n=p();return{id:"skeleton-".concat(t),position:n.clone(),initialPosition:n.clone(),health:175,maxHealth:175}})),[P,S]=(0,o.useState)(x),[b,C]=(0,o.useState)(h.health),I=(0,o.useRef)(null),[k,_]=(0,o.useState)(new s.Pq0(0,0,0)),R=(0,o.useCallback)((e,t)=>{console.log("Target ".concat(e," takes ").concat(t," damage")),v(n=>n.map(n=>{let r=e.replace("enemy-","");if(n.id===r){let e=Math.max(0,n.health-t);if(console.log("Enemy ".concat(r," health: ").concat(n.health," -> ").concat(e)),0===e&&n.health>0){var o;console.log("Enemy defeated, triggering onEnemyDeath"),null===(o=h.onEnemyDeath)||void 0===o||o.call(h)}return{...n,health:e}}return n}))},[h]),T=(0,o.useCallback)(e=>{var t;null===(t=h.onDamage)||void 0===t||t.call(h,e)},[h]),E=(0,o.useCallback)(e=>{_(e)},[]),G=(0,o.useCallback)((e,t)=>{v(n=>n.map(n=>n.id===e.replace("enemy-","")?{...n,position:t.clone()}:n))},[]),q=(0,o.useCallback)(()=>{C(h.maxHealth),v(Array.from({length:x},(e,t)=>{let n=p();return{id:"skeleton-".concat(t),position:n.clone(),initialPosition:n.clone(),health:175,maxHealth:175}}))},[x,h.maxHealth]),D={onHit:R,controlsRef:h.controlsRef,currentWeapon:h.currentWeapon,onWeaponSelect:h.onWeaponSelect,health:b,maxHealth:h.maxHealth,isPlayer:h.isPlayer,abilities:h.abilities,onAbilityUse:h.onAbilityUse,onPositionUpdate:E,onHealthChange:e=>{if("function"==typeof e)C(t=>{var n;let r=e(t);return null===(n=h.onHealthChange)||void 0===n||n.call(h,r),r});else{var t;C(e),null===(t=h.onHealthChange)||void 0===t||t.call(h,e)}},enemyData:g.map(e=>({id:"enemy-".concat(e.id),position:e.position,initialPosition:e.initialPosition,health:e.health,maxHealth:e.maxHealth})),onDamage:h.onDamage,onEnemyDeath:()=>{console.log("Kill counted in Scene")},onFireballDamage:h.onFireballDamage,fireballManagerRef:h.fireballManagerRef,onSmiteDamage:h.onSmiteDamage};return(0,o.useEffect)(()=>{if(P>=f)return;let e=setInterval(()=>{v(t=>{if(P>=f)return clearInterval(e),t;let n=p(),r={id:"skeleton-".concat(P),position:n.clone(),initialPosition:n.clone(),health:175,maxHealth:175};return S(e=>e+1),[...t,r]})},m);return()=>clearInterval(e)},[P,f,m]),(0,o.useEffect)(()=>{let e=g.every(e=>e.health<=0),t=P>=f;e&&t&&d()},[g,P,f,d]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("group",{children:[(0,r.jsx)(ev,{playerHealth:b,onReset:q,killCount:u,onEnemiesDefeated:d,maxSkeletons:f}),(0,r.jsx)(eS,{}),(0,r.jsx)(ew,{}),(0,r.jsx)(ef,{}),(0,r.jsx)(em,{}),(0,r.jsx)(j,{color:"#4a1c2c",roughness:.5,metalness:.1}),t.map((e,t)=>(0,r.jsx)(y,{position:e.position,scale:e.scale},"mountain-".concat(t))),n.map((e,t)=>(0,r.jsx)(M,{position:e.position,scale:e.scale,trunkColor:e.trunkColor,leafColor:e.leafColor},"tree-".concat(t))),i.map((e,t)=>(0,r.jsx)(w,{position:e.position,scale:e.scale},"mushroom-".concat(t))),(0,r.jsx)(M,{position:a.mainTree,scale:1,trunkColor:l,leafColor:c}),(0,r.jsx)("group",{ref:I,children:(0,r.jsx)(eo,{...D})}),g.map(e=>(0,r.jsx)(ed,{id:e.id,initialPosition:e.initialPosition,position:e.position,health:e.health,maxHealth:e.maxHealth,onTakeDamage:R,onPositionUpdate:G,playerPosition:k,onAttackPlayer:T},e.id))]})})}function eC(e){let{mountainData:t,treeData:n,mushroomData:i,treePositions:a,interactiveTrunkColor:l,interactiveLeafColor:c,unitProps:h,skeletonProps:u,killCount:d,onLevelComplete:m,spawnInterval:f=5e3,maxSkeletons:x=25,initialSkeletons:g=10,spawnCount:v=2}=e,[P,S]=(0,o.useState)(g||5),[b,C]=(0,o.useState)(()=>u.map((e,t)=>({id:"skeleton-".concat(t),position:e.initialPosition.clone(),initialPosition:e.initialPosition.clone(),currentPosition:e.initialPosition.clone(),health:225,maxHealth:225}))),[I,k]=(0,o.useState)(h.health),_=(0,o.useRef)(null),[R,T]=(0,o.useState)(new s.Pq0(0,0,0)),E=(0,o.useCallback)((e,t)=>{console.log("Target ".concat(e," takes ").concat(t," damage")),C(n=>n.map(n=>{let r=e.replace("enemy-","");if(n.id===r){let e=Math.max(0,n.health-t);if(console.log("Enemy ".concat(r," health: ").concat(n.health," -> ").concat(e)),0===e&&n.health>0){var o;console.log("Enemy defeated, triggering onEnemyDeath"),null===(o=h.onEnemyDeath)||void 0===o||o.call(h)}return{...n,health:e}}return n}))},[h]),G=(0,o.useCallback)(e=>{var t;null===(t=h.onDamage)||void 0===t||t.call(h,e)},[h]),q=(0,o.useCallback)(e=>{T(e)},[]),D=(0,o.useCallback)((e,t)=>{C(n=>n.map(n=>n.id===e.replace("enemy-","")?{...n,position:t.clone()}:n))},[]),z=(0,o.useCallback)(()=>{k(h.maxHealth),C(u.map((e,t)=>({id:"skeleton-".concat(t),position:e.initialPosition.clone(),initialPosition:e.initialPosition.clone(),currentPosition:e.initialPosition.clone(),health:225,maxHealth:225})))},[u,h.maxHealth]),B={onHit:E,controlsRef:h.controlsRef,currentWeapon:h.currentWeapon,onWeaponSelect:h.onWeaponSelect,health:I,maxHealth:h.maxHealth,isPlayer:h.isPlayer,abilities:h.abilities,onAbilityUse:h.onAbilityUse,onPositionUpdate:q,onHealthChange:e=>{if("function"==typeof e)k(t=>{var n;let r=e(t);return null===(n=h.onHealthChange)||void 0===n||n.call(h,r),r});else{var t;k(e),null===(t=h.onHealthChange)||void 0===t||t.call(h,e)}},enemyData:b.map(e=>({id:"enemy-".concat(e.id),position:e.position,initialPosition:e.initialPosition,health:e.health,maxHealth:e.maxHealth})),onDamage:h.onDamage,onEnemyDeath:()=>{console.log("Kill counted in Scene")},onFireballDamage:h.onFireballDamage,fireballManagerRef:h.fireballManagerRef,onSmiteDamage:h.onSmiteDamage};(0,o.useEffect)(()=>{b.every(e=>e.health<=0)&&d>=25&&m()},[b,d,m]);let[A,F]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{let e=setTimeout(()=>{F(!0)},1e4);return()=>clearTimeout(e)},[]),(0,o.useEffect)(()=>{if(!A||P>=x)return;let e=setInterval(()=>{C(t=>{if(P>=x)return clearInterval(e),t;let n=Array(v).fill(null).map((e,t)=>{let n=p();return{id:"skeleton-".concat(P+t),position:n.clone(),initialPosition:n.clone(),currentPosition:n.clone(),health:225,maxHealth:225}});return S(e=>e+v),[...t,...n]})},f);return()=>clearInterval(e)},[P,x,f,v,A]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ev,{playerHealth:I,onReset:z,killCount:d,onEnemiesDefeated:m,maxSkeletons:x}),(0,r.jsx)(eS,{}),(0,r.jsx)(ew,{}),(0,r.jsx)(ef,{}),(0,r.jsx)(em,{}),(0,r.jsx)(j,{color:"#4a1c2c",roughness:.9,metalness:.1}),t.map((e,t)=>(0,r.jsx)(y,{position:e.position,scale:e.scale},"mountain-".concat(t))),n.map((e,t)=>(0,r.jsx)(M,{position:e.position,scale:e.scale,trunkColor:e.trunkColor,leafColor:e.leafColor},"tree-".concat(t))),i.map((e,t)=>(0,r.jsx)(w,{position:e.position,scale:e.scale},"mushroom-".concat(t))),(0,r.jsx)(M,{position:a.mainTree,scale:1,trunkColor:l,leafColor:c}),(0,r.jsx)("group",{ref:_,children:(0,r.jsx)(eo,{...B})}),b.map(e=>(0,r.jsx)(ed,{id:e.id,initialPosition:e.initialPosition,position:e.position,health:e.health,maxHealth:e.maxHealth,onTakeDamage:E,onPositionUpdate:D,playerPosition:R,onAttackPlayer:G},e.id))]})}function eI(e){let{sceneProps:t,onLevelTransition:n,currentLevel:s}=e,i=(0,o.useCallback)(()=>{1===s?n(2,!0):2===s&&n(3,!0)},[s,n]);return(0,r.jsx)(r.Fragment,{children:1===s?(0,r.jsx)(eb,{...t,onLevelComplete:i}):(0,r.jsx)(eC,{...t,onLevelComplete:i})})}var ek=n(5019),e_=n.n(ek),eR=n(9965),eT=n.n(eR),eE=n(5831),eG=n.n(eE);function eq(e){let{damage:t,index:n,onComplete:s,timestamp:i}=e,[a,l]=(0,o.useState)(!0);(0,o.useEffect)(()=>{let e=setTimeout(()=>{l(!1),setTimeout(s,300)},1e3),t=setTimeout(()=>{s()},2e3);return()=>{clearTimeout(e),clearTimeout(t)}},[s]);let c=Math.max(0,1-(Date.now()-i)/1e3);return(0,r.jsxs)("div",{className:"".concat(eG().notification," ").concat(a?eG().visible:eG().hidden),style:{transform:"translateY(".concat(-20-25*n,"px)"),opacity:c},children:["-",t]})}let eD=[{title:"The Darkness Claims Another",subtitle:"Your soul joins the eternal dance..."},{title:"Fallen to Shadow",subtitle:"The necropolis grows stronger..."},{title:"Death's Embrace",subtitle:"The bones welcome their kin..."},{title:"The Last Stand",subtitle:"Your light fades into the abyss..."},{title:"Eternal Rest",subtitle:"The skeleton army claims victory..."},{title:"Denied Ascension",subtitle:"The dragons turn their backs on another unworthy soul..."},{title:"Draconic Disappointment",subtitle:"Your flames were not strong enough to join their ranks..."},{title:"Failed Wyrm",subtitle:"The ancient dragons scoff at your weakness..."},{title:"Wingless One",subtitle:"You'll never know the freedom of dragon flight..."},{title:"Mortal Chains",subtitle:"Forever bound to walk while dragons soar above..."},{title:"Lost Heritage",subtitle:"The dragon blood within you grows cold..."},{title:"Fading Ember",subtitle:"Your draconic spark extinguishes in darkness..."},{title:"Rejected by Fire",subtitle:"The dragon's flame finds you unworthy..."}],ez=e=>{let{size:t,strokeWidth:n,percentage:o,borderRadius:s}=e,i=n/2,a=t-n,l=4*a;return(0,r.jsx)("svg",{width:t,height:t,className:e_().roundedSquareProgress,children:(0,r.jsx)("rect",{x:i,y:i,width:a,height:a,rx:s,ry:s,stroke:"#39ff14",strokeWidth:n,fill:"none",strokeDasharray:l,strokeDashoffset:l-l*o/100,className:e_().progressForeground})})};function eB(e){let{currentWeapon:t,playerHealth:n,maxHealth:s,abilities:i,onReset:a,killCount:l}=e,[c,h]=(0,o.useState)([]),u=(0,o.useRef)(0),d=(0,o.useRef)(n),[m,p]=(0,o.useState)(null);(0,o.useEffect)(()=>{if(n<d.current){let e=d.current-n;h(t=>[...t,{id:u.current++,damage:e,timestamp:Date.now()}].slice(-3))}d.current=n},[n]),(0,o.useEffect)(()=>{n<=0?p(eD[Math.floor(Math.random()*eD.length)]):p(null)},[n]);let f=e=>{h(t=>t.filter(t=>t.id!==e))},x=e=>e<15?1:e<40?2:3;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:e_().bottomPanel,children:[(0,r.jsxs)("div",{className:e_().healthBarSection,children:[c.map((e,t)=>(0,r.jsx)(eq,{damage:e.damage,index:t,timestamp:e.timestamp,onComplete:()=>f(e.id)},e.id)),(0,r.jsxs)("div",{className:e_().healthBarContainer,children:[(0,r.jsxs)("div",{className:e_().healthBar,children:[(0,r.jsx)("div",{className:e_().healthBarBackground}),(0,r.jsx)("div",{className:e_().healthBarInner,style:{width:"".concat(n/s*100,"%")}}),(0,r.jsx)("div",{className:e_().healthBarShine}),(0,r.jsx)("div",{className:e_().healthBarPulse})]}),(0,r.jsxs)("span",{className:e_().healthText,children:[(0,r.jsx)("span",{className:e_().healthCurrent,children:n}),(0,r.jsx)("span",{className:e_().healthSeparator,children:"/"}),(0,r.jsx)("span",{className:e_().healthMax,children:s})]})]}),(0,r.jsxs)("div",{className:e_().experienceBarContainer,children:[(0,r.jsx)("div",{className:e_().experienceBarOrnamentLeft,children:(0,r.jsx)("span",{className:e_().levelText,children:x(l)})}),(0,r.jsx)("div",{className:e_().experienceBar,children:(0,r.jsx)("div",{className:e_().xpFill,style:{width:"".concat((e=>{let t=x(e);return 1===t?e/15*100:2===t?(e-15)/25*100:100})(l),"%")}})}),(0,r.jsx)("div",{className:e_().experienceBarOrnamentRight,children:(0,r.jsx)("span",{className:e_().killCountText,children:l})})]})]}),i[t]&&(0,r.jsxs)("div",{className:e_().abilitiesSection,children:[(0,r.jsxs)("div",{className:e_().ability,children:[(0,r.jsx)("div",{className:e_().keyBind,children:"Q"}),(0,r.jsx)(eT(),{src:i[t].q.icon,alt:"Q ability",width:40,height:40,className:e_().abilityIcon}),i[t].q.currentCooldown>0&&(0,r.jsxs)("div",{className:e_().cooldownOverlay,children:[(0,r.jsx)(ez,{size:50,strokeWidth:4,percentage:i[t].q.currentCooldown/i[t].q.cooldown*100,borderRadius:8}),(0,r.jsx)("span",{className:e_().cooldownText,children:Math.ceil(i[t].q.currentCooldown)})]})]}),(0,r.jsxs)("div",{className:e_().ability,children:[(0,r.jsx)("div",{className:e_().keyBind,children:"E"}),(0,r.jsx)(eT(),{src:i[t].e.icon,alt:"E ability",width:40,height:40,className:e_().abilityIcon}),i[t].e.currentCooldown>0&&(0,r.jsxs)("div",{className:e_().cooldownOverlay,children:[(0,r.jsx)(ez,{size:50,strokeWidth:4,percentage:i[t].e.currentCooldown/i[t].e.cooldown*100,borderRadius:8}),(0,r.jsx)("span",{className:e_().cooldownText,children:Math.ceil(i[t].e.currentCooldown)})]})]}),(0,r.jsxs)("div",{className:"".concat(e_().ability," ").concat(i[t].r.isUnlocked?"":e_().locked),children:[(0,r.jsx)("div",{className:e_().keyBind,children:"R"}),(0,r.jsx)(eT(),{src:i[t].r.icon,alt:"R ability",width:40,height:40,className:e_().abilityIcon}),i[t].r.currentCooldown>0&&i[t].r.isUnlocked&&(0,r.jsxs)("div",{className:e_().cooldownOverlay,children:[(0,r.jsx)(ez,{size:50,strokeWidth:4,percentage:i[t].r.currentCooldown/i[t].r.cooldown*100,borderRadius:8}),(0,r.jsx)("span",{className:e_().cooldownText,children:Math.ceil(i[t].r.currentCooldown)})]})]}),(0,r.jsxs)("div",{className:"".concat(e_().ability," ").concat(i[t].passive.isUnlocked?"":e_().locked),children:[(0,r.jsx)("div",{className:e_().keyBind,children:"1"}),(0,r.jsx)(eT(),{src:i[t].passive.icon,alt:"Ability Slot 1",width:40,height:40,className:e_().abilityIcon})]})]})]}),m&&(0,r.jsxs)("div",{className:e_().gameOverOverlay,children:[(0,r.jsx)("h1",{className:e_().gameOverTitle,children:m.title}),(0,r.jsx)("p",{className:e_().gameOverSubtitle,children:m.subtitle}),(0,r.jsx)("button",{className:e_().retryButton,onClick:a,children:"RETRY"})]})]})}var eA=n(6133),eF=n.n(eA);function eN(e){let{onWeaponSelect:t,selectedWeapon:n,onStart:o}=e;return(0,r.jsxs)("div",{className:eF().panel,onContextMenu:e=>e.preventDefault(),children:[(0,r.jsx)("h2",{children:"Eidolon"}),(0,r.jsxs)("div",{className:eF().iconSelection,children:[(0,r.jsx)("div",{className:"".concat(eF().icon," ").concat(n===i.SCYTHE?eF().selected:""),onClick:()=>t(i.SCYTHE),children:(0,r.jsx)("div",{className:eF().iconContent,children:(0,r.jsx)("img",{src:"/Eidolon/icons/1.svg",alt:"Scythe"})})}),(0,r.jsx)("div",{className:"".concat(eF().icon," ").concat(n===i.SWORD?eF().selected:""),onClick:()=>t(i.SWORD),children:(0,r.jsx)("div",{className:eF().iconContent,children:(0,r.jsx)("img",{src:"/Eidolon/icons/2.svg",alt:"Sword"})})}),(0,r.jsx)("div",{className:"".concat(eF().icon," ").concat(n===i.SABRES?eF().selected:""),onClick:()=>t(i.SABRES),children:(0,r.jsx)("div",{className:eF().iconContent,children:(0,r.jsx)("img",{src:"/Eidolon/icons/3.svg",alt:"Sabres"})})})]}),(0,r.jsx)("button",{className:eF().startButton,onClick:o,disabled:!n,children:"Enter"})]})}var eL=n(5151),eH=n.n(eL);function eO(e){let{onContinue:t,onSelectIcon:n,selectedIcon:o,currentWeapon:s,onAbilityUnlock:a}=e,l=(()=>{switch(s){case i.SCYTHE:return{r:"/Eidolon/icons/r1.svg",p:"/Eidolon/icons/p1.svg"};case i.SWORD:return{r:"/Eidolon/icons/r2.svg",p:"/Eidolon/icons/p2.svg"};case i.SABRES:return{r:"/Eidolon/icons/r3.svg",p:"/Eidolon/icons/p3.svg"};case i.SABRES2:return{r:"/Eidolon/icons/r4.svg",p:"/Eidolon/icons/p4.svg"}}})(),c=e=>{n(e),a(1===e?"r":"passive")};return(0,r.jsxs)("div",{className:eH().panel,style:{pointerEvents:"auto"},children:[(0,r.jsx)("h2",{children:"Level Complete!"}),(0,r.jsx)("p",{children:"Choose an ability to unlock:"}),(0,r.jsxs)("div",{className:eH().iconSelection,children:[(0,r.jsx)("div",{className:"".concat(eH().icon," ").concat(1===o?eH().selected:""),onClick:()=>c(1),children:(0,r.jsxs)("div",{className:eH().iconContent,children:[(0,r.jsx)("img",{src:null==l?void 0:l.r,alt:"R Ability",style:{width:"50px",height:"50px"}}),(0,r.jsx)("p",{children:"(R) Ability"})]})}),(0,r.jsx)("div",{className:"".concat(eH().icon," ").concat(2===o?eH().selected:""),onClick:()=>c(2),children:(0,r.jsxs)("div",{className:eH().iconContent,children:[(0,r.jsx)("img",{src:null==l?void 0:l.p,alt:"Passive Ability",style:{width:"50px",height:"50px"}}),(0,r.jsx)("p",{children:" (1) Restore "})]})})]}),(0,r.jsx)("button",{className:eH().continueButton,onClick:t,disabled:null===o,children:"Confirm"})]})}function eW(e){let{sceneProps:t,currentWeapon:n,onWeaponSelect:i,playerHealth:a,maxHealth:l,abilities:c,onReset:h,killCount:u,onAbilityUnlock:d}=e,[m,p]=(0,o.useState)(!1),[g,j]=(0,o.useState)(!1),[y,v]=(0,o.useState)(null),[M,w]=(0,o.useState)(1),P=(0,o.useCallback)((e,t)=>{w(e),j(t&&2===e)},[]),S=(0,o.useCallback)(()=>{null!==y&&(1===y?d("r"):2===y&&d("passive"),w(e=>e+1),j(!1),v(null))},[y,d]),b=(0,o.useCallback)(()=>{p(!1),h()},[h]);return(0,o.useEffect)(()=>{let e=e=>{"Space"===e.code&&e.preventDefault()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,touchAction:"none"},children:(0,r.jsxs)(f.Hl,{shadows:!0,camera:{position:[0,10,20],fov:60},children:[(0,r.jsx)("ambientLight",{intensity:.2}),m&&(0,r.jsx)(eI,{sceneProps:{...t,onReset:b},onAbilityUnlock:d,onLevelTransition:P,currentLevel:M}),(0,r.jsx)(x.N,{ref:t.unitProps.controlsRef,enablePan:!1,maxPolarAngle:Math.PI/2.2,maxDistance:75,mouseButtons:{LEFT:s.kBv.ROTATE,MIDDLE:void 0,RIGHT:s.kBv.ROTATE},minDistance:5,rotateSpeed:.5,enableDamping:!0,dampingFactor:.05})]})}),(0,r.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:!m||g?"auto":"none",zIndex:1e3},children:m?g?(0,r.jsx)(eO,{onContinue:S,onSelectIcon:v,selectedIcon:y,currentWeapon:n,onAbilityUnlock:d}):(0,r.jsx)(eB,{currentWeapon:n,onWeaponSelect:()=>{},playerHealth:a,maxHealth:l,abilities:c,onReset:h,killCount:u}):(0,r.jsx)(eN,{onWeaponSelect:i,selectedWeapon:n,onStart:()=>{console.log("handleStart called, currentWeapon:",n),n&&p(!0)}})})]})}let eU=()=>{let e=Math.random()*Math.PI*2,t=32.5*Math.sqrt(Math.random());return new s.Pq0(Math.cos(e)*t,0,Math.sin(e)*t)};function eQ(){let[e,t]=(0,o.useState)(null),n=(0,o.useRef)(null),[a,p]=(0,o.useState)(200),[f,x]=(0,o.useState)(0),[g,j]=(0,o.useState)(()=>l),[y,v]=(0,o.useState)({r:!1,passive:!1}),M=(0,o.useMemo)(()=>({mainTree:new s.Pq0(0,2,-5)}),[]),w=(0,o.useMemo)(()=>u(),[]),P=(0,o.useMemo)(()=>d(),[]),S=(0,o.useMemo)(()=>m(),[]),[b,C]=(0,o.useState)(),[I,k]=(0,o.useState)();(0,o.useEffect)(()=>{C(new s.Q1f(c[Math.floor(Math.random()*c.length)])),k(new s.Q1f(h[Math.floor(Math.random()*h.length)]))},[]);let _=e=>{t(e)},R=(0,o.useCallback)((e,t)=>{let n=Date.now();if(n-f>100){if(e.startsWith("skeleton-")){let n=parseInt(e.split("-")[1]);G(e=>{let r=[...e];return r[n]=Math.max(0,e[n]-t),r})}x(n)}},[f]),T=(e,t)=>{j(n=>{let r={...n};return r[e][t].currentCooldown=r[e][t].cooldown,r})};(0,o.useEffect)(()=>{let e=setInterval(()=>{j(e=>{let t={...e};return Object.keys(t).forEach(e=>{["q","e","r"].forEach(n=>{t[e][n].currentCooldown>0&&(t[e][n].currentCooldown-=.15)})}),t})},150);return()=>clearInterval(e)},[]);let[E]=(0,o.useState)(new s.Pq0(0,0,0)),[,G]=(0,o.useState)(()=>[,,,,,].fill(175)),[q,D]=(0,o.useState)(()=>Array.from({length:5},(e,t)=>{let n=eU();return{id:"skeleton-".concat(t),initialPosition:n,position:n.clone(),health:175,maxHealth:175,onTakeDamage:(e,t)=>{D(n=>n.map(n=>n.id===e?{...n,health:Math.max(0,n.health-t)}:n))}}})),[z,B]=(0,o.useState)(0),A=(0,o.useCallback)(()=>{console.log("Enemy death registered in HomePage"),B(e=>{let t=e+1;return console.log("Kill count updated:",t),t})},[]),F=(0,o.useCallback)((e,t,n)=>{D(n=>n.map(n=>n.id===e?{...n,health:Math.max(0,n.health-t)}:n)),n&&console.log("Critical hit on ".concat(e," for ").concat(t," damage!"))},[]),N=(0,o.useCallback)((e,t,n,r)=>{console.log("Smite hit ".concat(e," for ").concat(t," damage (Critical: ").concat(n,") at position:"),r),R(e,t)},[R]),L=(0,o.useRef)(null),H=()=>{p(200),G([,,,,,].fill(200)),j(e=>{let t={...e};return Object.keys(t).forEach(e=>{["q","e"].forEach(n=>{t[e][n].currentCooldown=0})}),t}),x(0),B(0)},O={mountainData:w,treeData:P,mushroomData:S,treePositions:M,interactiveTrunkColor:b,interactiveLeafColor:I,onReset:H,unitProps:{onFireballDamage:F,onSmiteDamage:N,onHit:R,controlsRef:n,currentWeapon:e||i.SCYTHE,onWeaponSelect:_,health:a,maxHealth:200,isPlayer:!0,abilities:{...g,...e?{[e]:{...g[e],r:{...g[e].r,isUnlocked:y.r},passive:{...g[e].passive,isUnlocked:y.passive}}}:{}},onAbilityUse:(t,n)=>{e&&T(t,n)},onPositionUpdate:e=>{E.copy(e)},enemyData:q.map(e=>({id:e.id,position:e.position,initialPosition:e.initialPosition,currentPosition:e.position.clone(),health:e.health,maxHealth:e.maxHealth})),onDamage:e=>{p(t=>Math.max(0,t-e))},onEnemyDeath:A,fireballManagerRef:L,onHealthChange:e=>{p(e)}},skeletonProps:q,killCount:z,onFireballDamage:F,onWeaponSelect:_};return(0,o.useEffect)(()=>{let e=e=>{"Space"===e.code&&e.preventDefault()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]),(0,r.jsx)("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0},children:(0,r.jsx)(eW,{sceneProps:O,currentWeapon:e,onWeaponSelect:_,playerHealth:a,maxHealth:200,abilities:g,onReset:H,killCount:z,onAbilityUnlock:t=>{console.log("Unlocking ".concat(t," ability")),v(e=>({...e,[t]:!0})),j(n=>{let r={...n};return e&&(r[e][t].isUnlocked=!0),r})}})})}},5831:e=>{e.exports={notification:"DamageNotification_notification__f3Yeu",floatUp:"DamageNotification_floatUp__Myim4",visible:"DamageNotification_visible__jYt6g",hidden:"DamageNotification_hidden__l4PWe"}},5151:e=>{e.exports={panel:"LevelCompletionPanel_panel__dcef3",iconSelection:"LevelCompletionPanel_iconSelection__jS9NE",icon:"LevelCompletionPanel_icon__lRABe",selected:"LevelCompletionPanel_selected__PqyOR",continueButton:"LevelCompletionPanel_continueButton__xlmot",iconContent:"LevelCompletionPanel_iconContent__DqvWS"}},5019:e=>{e.exports={bottomPanel:"Panel_bottomPanel__E_GFV",healthBarSection:"Panel_healthBarSection__Lc4_u",healthBarContainer:"Panel_healthBarContainer___xHn5",healthBarDecoration:"Panel_healthBarDecoration__ok97A",healthBarOrnamentLeft:"Panel_healthBarOrnamentLeft__l_eLO",healthBarOrnamentRight:"Panel_healthBarOrnamentRight__DlmuW",healthBar:"Panel_healthBar__Md85Z",healthBarBackground:"Panel_healthBarBackground__jdRKY",healthBarInner:"Panel_healthBarInner__B2SSK",healthBarShine:"Panel_healthBarShine__88Hkf",shine:"Panel_shine__uI8op",healthBarPulse:"Panel_healthBarPulse__CZkcb",pulse:"Panel_pulse__tyA5r",healthText:"Panel_healthText__1fCQl",healthCurrent:"Panel_healthCurrent__7n6qI",healthSeparator:"Panel_healthSeparator__aVnh_",healthMax:"Panel_healthMax__tYk8m",abilityContainer:"Panel_abilityContainer__sN6a4",ability:"Panel_ability__vWpFg",abilityIcon:"Panel_abilityIcon__3DloH",weaponIcons:"Panel_weaponIcons__FW360",weaponSlot:"Panel_weaponSlot__dVwz7",keyBind:"Panel_keyBind__D5m1t",activeWeapon:"Panel_activeWeapon__uZq6r",weaponIcon:"Panel_weaponIcon__iLPYg",cooldownOverlay:"Panel_cooldownOverlay__GJ3zY",cooldownText:"Panel_cooldownText__kVTtb",roundedSquareProgress:"Panel_roundedSquareProgress__1eZW_",progressForeground:"Panel_progressForeground__Acr3c",gameOverOverlay:"Panel_gameOverOverlay__Bud_o",gameOverTitle:"Panel_gameOverTitle__zo4Jg",gameOverSubtitle:"Panel_gameOverSubtitle__qVO8v",retryButton:"Panel_retryButton__GOTn9",killCounter:"Panel_killCounter__iC_Sg",killCountText:"Panel_killCountText__hQyjQ",abilitiesSection:"Panel_abilitiesSection__LVE1_",xpFill:"Panel_xpFill__RXvNL",levelText:"Panel_levelText__SgUXR",experienceBarContainer:"Panel_experienceBarContainer__9mese",experienceBar:"Panel_experienceBar__G5pO5",experienceBarOrnamentLeft:"Panel_experienceBarOrnamentLeft__JvEOr",experienceBarOrnamentRight:"Panel_experienceBarOrnamentRight__can19",locked:"Panel_locked__Anu5g",glowPulse:"Panel_glowPulse__Ye37n"}},6133:e=>{e.exports={panel:"WeaponSelectionPanel_panel__XVTME",iconContent:"WeaponSelectionPanel_iconContent__0raLR",icon:"WeaponSelectionPanel_icon__s7G0N",startButton:"WeaponSelectionPanel_startButton__zI16Y",iconSelection:"WeaponSelectionPanel_iconSelection__b3lef",selected:"WeaponSelectionPanel_selected__yqwcS",spinHex:"WeaponSelectionPanel_spinHex__23BFC",pulseGlow:"WeaponSelectionPanel_pulseGlow__6GI0P"}},7080:e=>{e.exports={gameOverContainer:"Behavior_gameOverContainer__I_AsD",gameOverTitle:"Behavior_gameOverTitle___qQx3",gameOverSubtitle:"Behavior_gameOverSubtitle__r_Ork",retryButton:"Behavior_retryButton__PS_b9",killCounter:"Behavior_killCounter__49SHF"}}},e=>{var t=t=>e(e.s=t);e.O(0,[624,438,84,197,636,593,792],()=>t(2022)),_N_E=e.O()}]);